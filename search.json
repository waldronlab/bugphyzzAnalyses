[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Waldron lab SPH CUNY Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/chi_square.html","id":"import-data","dir":"Articles","previous_headings":"","what":"Import data","title":"Analysis of the NYCHANES signatures","text":"Study 727 corresponds NYCHANES public study. Signature 1 decreased abundance smokers. Signature 2 increased abundance smokers. Remove taxa marked groups Contingency table Chi-square. Test independence. H0: relationship smoking aerophilicity DA microbes. H1: relationship smoking aerophilicity DA microbes.","code":"bp <- importBugphyzz(version = 'devel', force_download = TRUE) #> Registered S3 method overwritten by 'httr': #>   method           from   #>   print.cache_info hoardr #> Downloading, full_dump_categorical.csv.bz2. #> Using data downloaded on 2023-05-18 20:47:37. bsdb <- importBugSigDB(version = 'devel') tms <- importTidyTMS() study_727 <- bsdb |>      filter(`BSDB ID` %in% c('bsdb:727/1/1', 'bsdb:727/1/2')) sigs727 <- bugsigdbr::getSignatures(   df = study_727, tax.id.type = 'ncbi', tax.level = 'mixed' ) decreased <- sigs727$`bsdb:727/1/1_Tobacco-smoke-exposure-measurement:Current-cigarette-smokers_vs_Never-smokers_DOWN` increased <- sigs727$`bsdb:727/1/2_Tobacco-smoke-exposure-measurement:Current-cigarette-smokers_vs_Never-smokers_UP` df <- data.frame(   NCBI_ID = c(increased, decreased),   Abundance = c(rep('increased', length(increased)), rep('decreased', length(decreased))) ) head(df) #>   NCBI_ID Abundance #> 1   32207 increased #> 2     838 increased #> 3 1283313 increased #> 4     906 increased #> 5    1578 increased #> 6   29465 increased aer <- filter(bp, Attribute_group == 'aerophilicity') |>    select(NCBI_ID, Attribute) |>    mutate(Attribute = sub('^.*:', '', Attribute)) |>    mutate(     Attribute = case_when(       Attribute == 'obligately_anaerobic' ~ 'anaerobic',       Attribute == 'microaerophilic' ~ 'aerobic',       Attribute == 'obligately_aerobic' ~ 'aerobic',       TRUE ~ Attribute     )   ) |>    distinct() head(aer) #> # A tibble: 6 × 2 #>   NCBI_ID Attribute #>   <chr>   <chr>     #> 1 10      aerobic   #> 2 1000999 aerobic   #> 3 100132  anaerobic #> 4 100175  anaerobic #> 5 1004300 aerobic   #> 6 1007    aerobic tbl <- left_join(df, aer, by = 'NCBI_ID') dups <- tbl$NCBI_ID[which(duplicated(tbl$NCBI_ID))] taxizedb::taxid2name(dups) #> Registered S3 methods overwritten by 'readr': #>   method                    from  #>   as.data.frame.spec_tbl_df vroom #>   as_tibble.spec_tbl_df     vroom #>   format.col_spec           vroom #>   print.col_spec            vroom #>   print.collector           vroom #>   print.date_names          vroom #>   print.locale              vroom #>   str.col_spec              vroom #> [1] \"Lactobacillus\" \"Haemophilus\" tbl[tbl$NCBI_ID %in% dups,] #>    NCBI_ID Abundance               Attribute #> 5     1578 increased                 aerobic #> 6     1578 increased facultatively_anaerobic #> 25     724 decreased                 aerobic #> 26     724 decreased facultatively_anaerobic tbl <- tbl[!tbl$NCBI_ID %in% dups, ] any(duplicated(tbl$NCBI_ID)) #> [1] FALSE cont <- epitools::epitable(tbl$Attribute, tbl$Abundance) cont #>                          Outcome #> Predictor                 decreased increased #>   aerobic                         3         4 #>   anaerobic                       3         7 #>   facultatively_anaerobic         5         0 chi_res <- chisq.test(   x = tbl$Attribute, y = tbl$Abundance, simulate.p.value = TRUE ) chi_res #>  #>  Pearson's Chi-squared test with simulated p-value (based on 2000 #>  replicates) #>  #> data:  tbl$Attribute and tbl$Abundance #> X-squared = 6.7429, df = NA, p-value = 0.03348 tbl2 <- filter(tbl, Attribute %in% c('aerobic', 'anaerobic')) cont2 <- epitools::epitable(tbl2$Attribute, tbl2$Abundance) cont2 #>            Outcome #> Predictor   decreased increased #>   aerobic           3         4 #>   anaerobic         3         7 chi_res2 <- chisq.test(   x = tbl2$Attribute, y = tbl2$Abundance, simulate.p.value = TRUE ) chi_res2 #>  #>  Pearson's Chi-squared test with simulated p-value (based on 2000 #>  replicates) #>  #> data:  tbl2$Attribute and tbl2$Abundance #> X-squared = 0.29805, df = NA, p-value = 0.6532 mouth <- tms |>    filter(body_site == 'oralcavity', rank == 'genus') increased_bkg <- unique(c(increased, mouth$taxid)) decreased_bkg <- unique(c(decreased, mouth$taxid)) aer2 <- bp |>    filter(grepl('aerophilicity', Attribute)) bp_sigs <- getBugphyzzSignatures(   df = aer2, tax.id.type = 'NCBI_ID', tax.level = 'genus' ) en2 <- runEnrichment(   bsdb = bsdb,   bsdb_sets = list(`bsdb:727/1/1` = decreased, `bsdb:727/1/2` = increased),   background_sets = list(`bsdb:727/1/1` = decreased_bkg, `bsdb:727/1/2` = increased_bkg),   bp_sigs = bp_sigs ) data.table::data.table(en2) #>          BSDB ID bugsigdb_sig                                bp_sig n_sig #>  1: bsdb:727/1/1 bsdb:727/1/1                 aerophilicity:aerobic     4 #>  2: bsdb:727/1/1 bsdb:727/1/1               aerophilicity:anaerobic     2 #>  3: bsdb:727/1/1 bsdb:727/1/1 aerophilicity:facultatively_anaerobic     6 #>  4: bsdb:727/1/1 bsdb:727/1/1         aerophilicity:microaerophilic     0 #>  5: bsdb:727/1/1 bsdb:727/1/1      aerophilicity:obligately_aerobic     0 #>  6: bsdb:727/1/1 bsdb:727/1/1    aerophilicity:obligately_anaerobic     1 #>  7: bsdb:727/1/2 bsdb:727/1/2                 aerophilicity:aerobic     4 #>  8: bsdb:727/1/2 bsdb:727/1/2               aerophilicity:anaerobic     6 #>  9: bsdb:727/1/2 bsdb:727/1/2 aerophilicity:facultatively_anaerobic     1 #> 10: bsdb:727/1/2 bsdb:727/1/2         aerophilicity:microaerophilic     1 #> 11: bsdb:727/1/2 bsdb:727/1/2      aerophilicity:obligately_aerobic     0 #> 12: bsdb:727/1/2 bsdb:727/1/2    aerophilicity:obligately_anaerobic     1 #>     n_background    p_value        fdr odds_ratio   upper_ci   lower_ci #>  1:           33 0.30800892 0.92402676  1.7676969   5.678769 0.55025175 #>  2:           54 0.98073550 1.00000000  0.3424036   1.286813 0.09110901 #>  3:           24 0.00656207 0.03937242  5.9189189  18.792384 1.86424468 #>  4:            3 1.00000000 1.00000000  1.4228571  13.697712 0.14780005 #>  5:            0 1.00000000 1.00000000 10.2000000 172.838210 0.60195023 #>  6:           30 0.95297262 1.00000000  0.4355195   2.055440 0.09228060 #>  7:           33 0.31340178 0.62680356  1.7497507   5.622070 0.54457305 #>  8:           54 0.30504971 0.62680356  1.6185567   4.894753 0.53521100 #>  9:           23 0.89871232 1.00000000  0.6057971   2.893001 0.12685449 #> 10:            3 0.24043721 0.62680356  6.4956522  42.771030 0.98649709 #> 11:            0 1.00000000 1.00000000 10.1200000 171.489776 0.59720412 #> 12:           30 0.95419561 1.00000000  0.4310980   2.034833 0.09133208 #>         Study Study design     PMID #>  1: Study 727 case-control 31076212 #>  2: Study 727 case-control 31076212 #>  3: Study 727 case-control 31076212 #>  4: Study 727 case-control 31076212 #>  5: Study 727 case-control 31076212 #>  6: Study 727 case-control 31076212 #>  7: Study 727 case-control 31076212 #>  8: Study 727 case-control 31076212 #>  9: Study 727 case-control 31076212 #> 10: Study 727 case-control 31076212 #> 11: Study 727 case-control 31076212 #> 12: Study 727 case-control 31076212 #>                                                 DOI #>  1: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  2: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  3: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  4: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  5: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  6: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  7: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  8: https://doi.org/10.1016/j.annepidem.2019.03.005 #>  9: https://doi.org/10.1016/j.annepidem.2019.03.005 #> 10: https://doi.org/10.1016/j.annepidem.2019.03.005 #> 11: https://doi.org/10.1016/j.annepidem.2019.03.005 #> 12: https://doi.org/10.1016/j.annepidem.2019.03.005 #>                                           URL #>  1: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  2: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  3: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  4: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  5: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  6: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  7: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  8: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>  9: https://pubmed.ncbi.nlm.nih.gov/31076212/ #> 10: https://pubmed.ncbi.nlm.nih.gov/31076212/ #> 11: https://pubmed.ncbi.nlm.nih.gov/31076212/ #> 12: https://pubmed.ncbi.nlm.nih.gov/31076212/ #>                                                                                                                   Authors list #>  1: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  2: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  3: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  4: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  5: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  6: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  7: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  8: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>  9: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #> 10: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #> 11: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #> 12: Beghini F, Renson A, Zolnik CP, Geistlinger L, Usyk M, Moody TU, Thorpe L, Dowd JB, Burk R, Segata N, Jones HE , Waldron L #>                                                                                                                               Title #>  1: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  2: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  3: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  4: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  5: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  6: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  7: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  8: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>  9: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #> 10: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #> 11: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #> 12: Tobacco exposure associated with oral microbiota oxygen utilization in the New York City Health and Nutrition Examination Study #>                    Journal Year   Experiment     Location of subjects #>  1: Annals of epidemiology 2019 Experiment 1 United States of America #>  2: Annals of epidemiology 2019 Experiment 1 United States of America #>  3: Annals of epidemiology 2019 Experiment 1 United States of America #>  4: Annals of epidemiology 2019 Experiment 1 United States of America #>  5: Annals of epidemiology 2019 Experiment 1 United States of America #>  6: Annals of epidemiology 2019 Experiment 1 United States of America #>  7: Annals of epidemiology 2019 Experiment 1 United States of America #>  8: Annals of epidemiology 2019 Experiment 1 United States of America #>  9: Annals of epidemiology 2019 Experiment 1 United States of America #> 10: Annals of epidemiology 2019 Experiment 1 United States of America #> 11: Annals of epidemiology 2019 Experiment 1 United States of America #> 12: Annals of epidemiology 2019 Experiment 1 United States of America #>     Host species Body site      UBERON ID                          Condition #>  1: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  2: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  3: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  4: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  5: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  6: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  7: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  8: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>  9: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #> 10: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #> 11: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #> 12: Homo sapiens    Saliva UBERON:0001836 Tobacco smoke exposure measurement #>          EFO ID  Group 0 name              Group 1 name #>  1: EFO:0009115 Never smokers Current cigarette smokers #>  2: EFO:0009115 Never smokers Current cigarette smokers #>  3: EFO:0009115 Never smokers Current cigarette smokers #>  4: EFO:0009115 Never smokers Current cigarette smokers #>  5: EFO:0009115 Never smokers Current cigarette smokers #>  6: EFO:0009115 Never smokers Current cigarette smokers #>  7: EFO:0009115 Never smokers Current cigarette smokers #>  8: EFO:0009115 Never smokers Current cigarette smokers #>  9: EFO:0009115 Never smokers Current cigarette smokers #> 10: EFO:0009115 Never smokers Current cigarette smokers #> 11: EFO:0009115 Never smokers Current cigarette smokers #> 12: EFO:0009115 Never smokers Current cigarette smokers #>                                                                                                                                                                                                                                     Group 1 definition #>  1: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  2: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  3: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  4: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  5: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  6: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  7: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  8: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>  9: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #> 10: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #> 11: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #> 12: Participants who reported smoking more than 100 cigarettes in their lifetime, smoking a cigarette in the last 5 days, and not using any alternative tobacco product in the last 5 days (the 90 with highest measured serum cotinine were selected) #>     Group 0 sample size Group 1 sample size Antibiotics exclusion #>  1:                  43                  86                  <NA> #>  2:                  43                  86                  <NA> #>  3:                  43                  86                  <NA> #>  4:                  43                  86                  <NA> #>  5:                  43                  86                  <NA> #>  6:                  43                  86                  <NA> #>  7:                  43                  86                  <NA> #>  8:                  43                  86                  <NA> #>  9:                  43                  86                  <NA> #> 10:                  43                  86                  <NA> #> 11:                  43                  86                  <NA> #> 12:                  43                  86                  <NA> #>     Sequencing type 16S variable region Sequencing platform Statistical test #>  1:             16S                   4            Illumina            edgeR #>  2:             16S                   4            Illumina            edgeR #>  3:             16S                   4            Illumina            edgeR #>  4:             16S                   4            Illumina            edgeR #>  5:             16S                   4            Illumina            edgeR #>  6:             16S                   4            Illumina            edgeR #>  7:             16S                   4            Illumina            edgeR #>  8:             16S                   4            Illumina            edgeR #>  9:             16S                   4            Illumina            edgeR #> 10:             16S                   4            Illumina            edgeR #> 11:             16S                   4            Illumina            edgeR #> 12:             16S                   4            Illumina            edgeR #>     Significance threshold MHT correction LDA Score above Matched on #>  1:                   0.05           TRUE              NA       <NA> #>  2:                   0.05           TRUE              NA       <NA> #>  3:                   0.05           TRUE              NA       <NA> #>  4:                   0.05           TRUE              NA       <NA> #>  5:                   0.05           TRUE              NA       <NA> #>  6:                   0.05           TRUE              NA       <NA> #>  7:                   0.05           TRUE              NA       <NA> #>  8:                   0.05           TRUE              NA       <NA> #>  9:                   0.05           TRUE              NA       <NA> #> 10:                   0.05           TRUE              NA       <NA> #> 11:                   0.05           TRUE              NA       <NA> #> 12:                   0.05           TRUE              NA       <NA> #>                                           Confounders controlled for Pielou #>  1: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  2: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  3: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  4: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  5: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  6: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  7: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  8: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>  9: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #> 10: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #> 11: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #> 12: age,diabetes mellitus,education level,physical activity,race,sex   <NA> #>       Shannon     Chao1 Simpson Inverse Simpson Richness Signature page name #>  1: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  2: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  3: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  4: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  5: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  6: unchanged unchanged    <NA>            <NA>     <NA>         Signature 1 #>  7: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #>  8: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #>  9: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #> 10: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #> 11: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #> 12: unchanged unchanged    <NA>            <NA>     <NA>         Signature 2 #>                   Source  Curated date  Curator Revision editor #>  1: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  2: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  3: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  4: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  5: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  6: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  7: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  8: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>  9: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #> 10: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #> 11: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #> 12: Supplementary Fig. 4 28 March 2023 Atrayees        Atrayees #>                                                                                                                                     Description #>  1: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  2: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  3: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  4: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  5: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  6: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  7: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  8: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>  9: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #> 10: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #> 11: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #> 12: Differentially abundant OTUs, taxonomically assigned to 28 different genera identified between current cigarette smokers and never smokers. #>     Abundance in Group 1 #>  1:            decreased #>  2:            decreased #>  3:            decreased #>  4:            decreased #>  5:            decreased #>  6:            decreased #>  7:            increased #>  8:            increased #>  9:            increased #> 10:            increased #> 11:            increased #> 12:            increased #>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      MetaPhlAn taxon names #>  1: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  2: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  3: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  4: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  5: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  6: k__Bacteria|p__Pseudomonadota|c__Gammaproteobacteria|o__Pasteurellales|f__Pasteurellaceae|g__Actinobacillus,k__Bacteria|p__Bacteroidota|c__Flavobacteriia|o__Flavobacteriales|f__Weeksellaceae|g__Bergeyella,k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium,k__Bacteria|p__Bacillota|c__Bacilli|o__Bacillales|g__Gemella,k__Bacteria|p__Bacillota|c__Clostridia|o__Eubacteriales|f__Lachnospiraceae|g__Lachnoanaerobaculum,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Lactococcus,... #>  7:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #>  8:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #>  9:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #> 10:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #> 11:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #> 12:    k__Bacteria|p__Actinomycetota|c__Actinomycetes|o__Micrococcales|f__Micrococcaceae|g__Rothia,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Prevotella,k__Bacteria|p__Bacteroidota|c__Bacteroidia|o__Bacteroidales|f__Prevotellaceae|g__Alloprevotella,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Megasphaera,k__Bacteria|p__Bacillota|c__Bacilli|o__Lactobacillales|f__Lactobacillaceae|g__Lactobacillus,k__Bacteria|p__Bacillota|c__Negativicutes|o__Veillonellales|f__Veillonellaceae|g__Veillonella,... #>                                                                                                                                                                                         NCBI Taxonomy IDs #>  1:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  2:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  3:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  4:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  5:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  6:              2|1224|1236|135625|712|713,2|976|117743|200644|2762318|59735,2|201174|1760|85004|31953|1678,2|1239|91061|1385|1378,2|1239|186801|186802|186803|1164882,2|1239|91061|186826|1300|1357,... #>  7: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #>  8: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #>  9: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #> 10: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #> 11: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #> 12: 2|201174|1760|85006|1268|32207,2|976|200643|171549|171552|838,2|976|200643|171549|171552|1283313,2|1239|909932|1843489|31977|906,2|1239|91061|186826|33958|1578,2|1239|909932|1843489|31977|29465,... #>        State Reviewer #>  1: Complete     <NA> #>  2: Complete     <NA> #>  3: Complete     <NA> #>  4: Complete     <NA> #>  5: Complete     <NA> #>  6: Complete     <NA> #>  7: Complete     <NA> #>  8: Complete     <NA> #>  9: Complete     <NA> #> 10: Complete     <NA> #> 11: Complete     <NA> #> 12: Complete     <NA>"},{"path":"/articles/chi_square.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Analysis of the NYCHANES signatures","text":"","code":"sessioninfo::session_info() #> ─ Session info ─────────────────────────────────────────────────────────────── #>  setting  value #>  version  R version 4.3.0 (2023-04-21) #>  os       Ubuntu 22.04.2 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  en_US.UTF-8 #>  ctype    en_US.UTF-8 #>  tz       Etc/UTC #>  date     2023-05-18 #>  pandoc   2.19.2 @ /usr/local/bin/ (via rmarkdown) #>  #> ─ Packages ─────────────────────────────────────────────────────────────────── #>  package          * version  date (UTC) lib source #>  BiocFileCache      2.8.0    2023-04-25 [1] Bioconductor #>  bit                4.0.5    2022-11-15 [1] RSPM (R 4.3.0) #>  bit64              4.0.5    2020-08-30 [1] RSPM (R 4.3.0) #>  blob               1.2.4    2023-03-17 [1] RSPM (R 4.3.0) #>  bold               1.3.0    2023-05-02 [1] RSPM (R 4.3.0) #>  bslib              0.4.2    2022-12-16 [1] RSPM (R 4.3.0) #>  bugphyzz         * 0.0.1.3  2023-05-18 [1] Github (waldronlab/bugphyzz@9c7db81) #>  bugphyzzAnalyses * 0.1.0    2023-05-18 [1] local #>  bugsigdbr        * 1.6.1    2023-04-27 [1] Bioconductor #>  cachem             1.0.8    2023-05-01 [1] RSPM (R 4.3.0) #>  cli                3.6.1    2023-03-23 [1] RSPM (R 4.3.0) #>  conditionz         0.1.0    2019-04-24 [1] RSPM (R 4.3.0) #>  crayon             1.5.2    2022-09-29 [1] RSPM (R 4.3.0) #>  crul               1.4.0    2023-05-17 [1] RSPM (R 4.3.0) #>  curl               5.0.0    2023-01-12 [1] RSPM (R 4.3.0) #>  data.table         1.14.8   2023-02-17 [1] RSPM (R 4.3.0) #>  DBI                1.1.3    2022-06-18 [1] RSPM (R 4.3.0) #>  dbplyr             2.3.2    2023-03-21 [1] RSPM (R 4.3.0) #>  desc               1.4.2    2022-09-08 [1] RSPM (R 4.3.0) #>  digest             0.6.31   2022-12-11 [1] RSPM (R 4.3.0) #>  dplyr            * 1.1.2    2023-04-20 [1] RSPM (R 4.3.0) #>  epitools           0.5-10.1 2020-03-22 [1] RSPM (R 4.3.0) #>  evaluate           0.21     2023-05-05 [1] RSPM (R 4.3.0) #>  fansi              1.0.4    2023-01-22 [1] RSPM (R 4.3.0) #>  fastmap            1.1.1    2023-02-24 [1] RSPM (R 4.3.0) #>  filelock           1.0.2    2018-10-05 [1] RSPM (R 4.3.0) #>  fs                 1.6.2    2023-04-25 [1] RSPM (R 4.3.0) #>  generics           0.1.3    2022-07-05 [1] RSPM (R 4.3.0) #>  glue               1.6.2    2022-02-24 [1] RSPM (R 4.3.0) #>  hms                1.1.3    2023-03-21 [1] RSPM (R 4.3.0) #>  hoardr             0.5.3    2023-01-26 [1] RSPM (R 4.3.0) #>  htmltools          0.5.5    2023-03-23 [1] RSPM (R 4.3.0) #>  httpcode           0.3.0    2020-04-10 [1] RSPM (R 4.3.0) #>  httr               1.4.6    2023-05-08 [1] RSPM (R 4.3.0) #>  jquerylib          0.1.4    2021-04-26 [1] RSPM (R 4.3.0) #>  jsonlite           1.8.4    2022-12-06 [1] RSPM (R 4.3.0) #>  knitr              1.42     2023-01-25 [1] RSPM (R 4.3.0) #>  lifecycle          1.0.3    2022-10-07 [1] RSPM (R 4.3.0) #>  magrittr           2.0.3    2022-03-30 [1] RSPM (R 4.3.0) #>  memoise            2.0.1    2021-11-26 [1] RSPM (R 4.3.0) #>  mgsub              1.7.3    2021-07-28 [1] RSPM (R 4.3.0) #>  pillar             1.9.0    2023-03-22 [1] RSPM (R 4.3.0) #>  pkgconfig          2.0.3    2019-09-22 [1] RSPM (R 4.3.0) #>  pkgdown            2.0.7    2022-12-14 [1] RSPM (R 4.3.0) #>  purrr            * 1.0.1    2023-01-10 [1] RSPM (R 4.3.0) #>  R6                 2.5.1    2021-08-19 [1] RSPM (R 4.3.0) #>  ragg               1.2.5    2023-01-12 [1] RSPM (R 4.3.0) #>  rappdirs           0.3.3    2021-01-31 [1] RSPM (R 4.3.0) #>  readr              2.1.4    2023-02-10 [1] RSPM (R 4.3.0) #>  rlang              1.1.1    2023-04-28 [1] RSPM (R 4.3.0) #>  rmarkdown          2.21     2023-03-26 [1] RSPM (R 4.3.0) #>  rprojroot          2.0.3    2022-04-02 [1] RSPM (R 4.3.0) #>  RSQLite            2.3.1    2023-04-03 [1] RSPM (R 4.3.0) #>  sass               0.4.6    2023-05-03 [1] RSPM (R 4.3.0) #>  sessioninfo        1.2.2    2021-12-06 [1] RSPM (R 4.3.0) #>  stringi            1.7.12   2023-01-11 [1] RSPM (R 4.3.0) #>  stringr            1.5.0    2022-12-02 [1] RSPM (R 4.3.0) #>  systemfonts        1.0.4    2022-02-11 [1] RSPM (R 4.3.0) #>  taxa               0.4.2    2022-04-12 [1] RSPM (R 4.3.0) #>  taxize             1.0      2023-05-18 [1] Github (ropensci/taxize@bcff2a6) #>  taxizedb           0.3.1    2023-04-03 [1] RSPM (R 4.3.0) #>  textshaping        0.3.6    2021-10-13 [1] RSPM (R 4.3.0) #>  tibble             3.2.1    2023-03-20 [1] RSPM (R 4.3.0) #>  tidyr              1.3.0    2023-01-24 [1] RSPM (R 4.3.0) #>  tidyselect         1.2.0    2022-10-10 [1] RSPM (R 4.3.0) #>  tzdb               0.4.0    2023-05-12 [1] RSPM (R 4.3.0) #>  utf8               1.2.3    2023-01-31 [1] RSPM (R 4.3.0) #>  uuid               1.1-0    2022-04-19 [1] RSPM (R 4.3.0) #>  vctrs              0.6.2    2023-04-19 [1] RSPM (R 4.3.0) #>  vroom              1.6.3    2023-04-28 [1] RSPM (R 4.3.0) #>  withr              2.5.0    2022-03-03 [1] RSPM (R 4.3.0) #>  xfun               0.39     2023-04-20 [1] RSPM (R 4.3.0) #>  xml2               1.3.4    2023-04-27 [1] RSPM (R 4.3.0) #>  yaml               2.3.7    2023-01-23 [1] RSPM (R 4.3.0) #>  #>  [1] /usr/local/lib/R/site-library #>  [2] /usr/local/lib/R/library #>  #> ──────────────────────────────────────────────────────────────────────────────"},{"path":"/articles/data_integration_and_stats.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Data integration and bugphyzz stats","text":"","code":"bp <- importBugphyzz(version = 'devel', force_download = TRUE)"},{"path":[]},{"path":"/articles/data_integration_and_stats.html","id":"number-of-original-sources","dir":"Articles","previous_headings":"Source data","what":"Number of original sources","title":"Data integration and bugphyzz stats","text":"","code":"bp_source <- bp[!is.na(bp$Attribute_source),] unique_sources <- bp_source |>      filter(Evidence  %in% c('exp', 'igc', 'tas', 'nas')) |>      pull(Attribute_source) |>      unique() |>      strsplit(';') |>      unlist() |>      unique() |>      sort() n_sources <- length(unique_sources) n_sources #> [1] 7"},{"path":"/articles/data_integration_and_stats.html","id":"number-of-annotaions-per-source","dir":"Articles","previous_headings":"Source data","what":"Number of annotaions per source","title":"Data integration and bugphyzz stats","text":", inheritance asr treated two separate new sources. Note majority annotations actually come propagation step.  Note: total numbers. interesting see physiology type percentage?","code":"summary_source <- bp |>    mutate(         Attribute_source = ifelse(is.na(Attribute_source), Evidence, Attribute_source)   ) |>    mutate(     Attribute_source = case_when(       Attribute_source == 'inh' ~ 'Propagation (inheritance)',       Attribute_source == 'asr' ~ 'Propagation (ASR)',       TRUE ~ Attribute_source     )   ) |>    filter(!grepl(';', Attribute_source)) |>    count(Attribute_source) |>    arrange(-n) |>    head(10)    # summary_source summary_source_p <- summary_source |>    ggplot(aes(reorder(Attribute_source, -n), n)) +   geom_col(fill = 'dodgerblue4', alpha = 0.8) +   labs(     x = 'Top 10 source', y = '# Annotations'   ) +   theme_bw() +   theme(     axis.text.x = element_text(angle = 45, hjust = 1),     panel.grid.major.x = element_blank(),     panel.grid.major.y = element_line(color = 'black', linewidth = 0.2)   ) summary_source_p"},{"path":"/articles/data_integration_and_stats.html","id":"completeness","dir":"Articles","previous_headings":"","what":"Completeness","title":"Data integration and bugphyzz stats","text":"Import data taxa used create taxonomic tree: NCBI IDs data structure Create heatmaps  Add confidence annotations figure. Discuss meaning inference. Hold validation. Choose random annotations (10% ~30-100x). Cross-validation. Hold positives negatives. One rank physiology time. Look citation method implemented validation. Check Mathews Correlation coefficient balanced/unbalanced prediction. Matthews correlation coefficient Try different tissues.","code":"base_taxa <- get_ncbi_taxids('bti') |>    rename(domain =  kingdom) |>    mutate(Rank = ifelse(Rank == 'superkingdom', 'domain', Rank)) |>    filter(Rank %in% valid_ranks) |>    select(-Taxon_name, -Parent_NCBI_ID) #> Registered S3 methods overwritten by 'readr': #>   method                    from  #>   as.data.frame.spec_tbl_df vroom #>   as_tibble.spec_tbl_df     vroom #>   format.col_spec           vroom #>   print.col_spec            vroom #>   print.collector           vroom #>   print.date_names          vroom #>   print.locale              vroom #>   str.col_spec              vroom #> Downloading NCBI taxdump. This might take a while. #> Extracting files... #> Importing ranked lineage... #> Importing nodes... #> Combining ranked lineages and nodes... base_taxa_summary <- base_taxa |>    count(Rank, name = \"n_inbase\") ## 90% of the taxa in the original taxa can be found in the tree. bp_original_source <- filter(bp, !is.na(Attribute_source)) mean(bp_original_source$NCBI_ID %in% base_taxa$NCBI_ID) #> [1] 0.905039 ## Create sets for calculating completeness ## inset are all ids found in the tree structure ## inset_sources are all ids found in the tree structure and come from  ## original sources only` inset <- bp |>    filter(NCBI_ID %in% base_taxa$NCBI_ID) inset_summary <- inset |>    count(Attribute_group, Rank, name = 'n_inset') inset_sources <- inset |>    filter(!is.na(Attribute_source)) inset_sources_summary <- inset_sources |>    count(Attribute_group, Rank, name = 'n_sources')  ## Calculate completeness completeness <- base_taxa_summary |>    left_join(inset_summary, by = c('Rank') ) |>    left_join(inset_sources_summary, by = c('Attribute_group', 'Rank')) |>   mutate(     completeness_before = n_sources / n_inbase,     completeness_after = n_inset / n_inbase ) |>    relocate(     Attribute_group, Rank, completeness_before, completeness_after,     n_inbase, n_inset   ) completeness <- base_taxa_summary |>    left_join(inset_summary, by = c('Rank') ) |>    left_join(inset_sources_summary, by = c('Attribute_group', 'Rank')) |>   mutate(     completeness_before = n_sources / n_inbase,     completeness_after = n_inset / n_inbase ) |>    relocate(     Attribute_group, Rank, completeness_before, completeness_after,     n_inbase, n_inset   ) comp_mat_bef <- completeness |>    select(Attribute_group, Rank, completeness_before) |>    filter(!is.na(completeness_before)) |>    pivot_wider(     names_from = 'Rank', values_from = 'completeness_before',     values_fill = 0   ) |>    tibble::column_to_rownames(var = 'Attribute_group') |>    select(all_of(valid_ranks[1:3])) |>    as.matrix() |>    round(digits = 2)   comp_mat_aft <- completeness |>    select(Attribute_group, Rank, completeness_after) |>    pivot_wider(     names_from = 'Rank', values_from = 'completeness_after',     values_fill = 0   ) |>    tibble::column_to_rownames(var = 'Attribute_group') |>    select(all_of(valid_ranks)) |>    as.matrix() |>    round(digits = 2) comp_mat_bef <- comp_mat_bef[rownames(comp_mat_aft),] color_fun <- circlize::colorRamp2(   breaks = c(0, 1), colors = c('white', 'dodgerblue4') ) lgd <- Legend(col_fun = color_fun, title = \"completeness\") ht_b <- Heatmap(   matrix = comp_mat_bef,   cluster_rows = FALSE, cluster_columns = FALSE,   row_names_side = 'left',   show_heatmap_legend = FALSE,   col = color_fun,   cell_fun = function(j, i, x, y, width, height, fill) {         grid.rect(x = x, y = y, width = width, height = height,              gp = gpar(col = \"black\", fill = NA))   } ) ht_a <- Heatmap(   matrix = comp_mat_aft,   cluster_rows = FALSE, cluster_columns = FALSE,   row_names_side = 'left',   name = 'completeness',   heatmap_legend_param = list(     at = c(0, 0.5, 1)   ),   col = color_fun,   cell_fun = function(j, i, x, y, width, height, fill) {         grid.rect(x = x, y = y, width = width, height = height,              gp = gpar(col = \"black\", fill = NA))   } ) ht_list <- ht_b + ht_a ht <- draw(   ht_list,    ht_gap = unit(0.4, \"cm\") )"},{"path":"/articles/data_integration_and_stats.html","id":"dispersion-of-sources","dir":"Articles","previous_headings":"","what":"Dispersion of sources","title":"Data integration and bugphyzz stats","text":"Import bugphyzz data propagation resolving conflicts, agreements, double annotations.","code":"phys <- physiologies(remove_false = TRUE, full_source = FALSE) #> Importing physiology data. This might take a while... #> Finished acetate producing. #> Finished aerophilicity. #> Finished animal pathogen. #> Finished antimicrobial resistance. #> Finished antimicrobial sensitivity. #> Finished arrangement. #> Finished biofilm forming. #> Finished biosafety level. #> Finished butyrate producing. #> Finished coding genes. #> Finished COGEM pathogenicity rating. #> Finished country. #> Finished disease association. #> Finished extreme environment. #> Finished genome size. #> Finished geographic location. #> Finished gram stain. #> Finished growth medium. #> Finished growth temperature. #> Finished habitat. #> Finished halophily. #> Finished health associated. #> Finished hemolysis. #> Finished hydrogen gas producing. #> Finished isolation site. #> Finished lactate producing. #> Finished length. #> Finished metabolite production. #> Finished metabolite utilization. #> Finished motility. #> Finished mutation rate per site per generation. #> Finished mutation rates per site per year. #> Finished optimal ph. #> Finished pathogenicity human. #> Finished plant pathogenicity. #> Finished shape. #> Finished sphingolipid producing. #> Finished spore formation. #> Finished spore shape. #> Finished width. #> Warning: Missing columns in biosafety level. Missing columns are: Accession_ID #> Warning: Missing columns in country. Missing columns are: Accession_ID #> Warning: Missing columns in geographic location. Missing columns are: #> Accession_ID #> Warning: Missing columns in halophily. Missing columns are: Accession_ID #> Warning: Missing columns in hemolysis. Missing columns are: Accession_ID #> Warning: Missing columns in metabolite utilization. Missing columns are: #> Accession_ID  #> Warning: Missing columns in metabolite utilization. Missing columns are: #> Accession_ID #> Warning: Missing columns in motility. Missing columns are: Accession_ID #> Warning: Missing columns in pathogenicity human. Missing columns are: #> Accession_ID #> Warning: Missing columns in spore formation. Missing columns are: Accession_ID phys_ <- map(phys, ~ prepareDatForPropagation(.x, resolve = FALSE)) attr_grps <- whichAttrGrp(bp) data <- phys_ |>    map(~ count(.x, Attribute_source, Rank)) |>    bind_rows(.id = 'Attribute_group') |>    drop_na() |>    filter(Attribute_source != '') |>    filter(Attribute_group %in% attr_grps) |>    filter(!grepl('BacDive;', Attribute_source)) |>    mutate(new_column = paste0(Attribute_group, '|', Rank)) |>   select(new_column, Attribute_source, n) |>    pivot_wider(     names_from = 'Attribute_source', values_from = 'n', values_fill = 0   ) |>    arrange(new_column) |>    tibble::column_to_rownames(var = 'new_column') |>    as.matrix() # data <- bp_source |>  #   count(Attribute_source, Attribute_group, Rank) |>  #   filter(!grepl('BacDive;', Attribute_source)) |>  #   mutate(new_column = paste0(Attribute_group, '|', Rank)) |> #   select(new_column, Attribute_source, n) |>  #   pivot_wider( #     names_from = 'Attribute_source', values_from = 'n', values_fill = 0 #   ) |>  #   arrange(new_column) |>  #   tibble::column_to_rownames(var = 'new_column') |>  #   as.matrix() # bar_vct <- sub('^.*\\\\|', '', rownames(data)) split_vct <- sub('\\\\|.*$', '', rownames(data)) bar_color <- viridis::viridis(n = 3, option = 'C') names(bar_color) <- c('genus', 'species', 'strain') row_ha <- rowAnnotation(   'Rank' = bar_vct, col = list(Rank = bar_color),    show_annotation_name = FALSE ) log2_data <- log2(data + 1) ht_sources <- Heatmap(   matrix = log2_data,   cluster_rows = FALSE, cluster_columns = FALSE,   show_row_names = FALSE,   row_names_side = 'left',   name = 'log2(# annotations + 1)',   show_heatmap_legend = TRUE,   col = color_fun(c(min(log2_data), max(log2_data))),   left_annotation = row_ha,    row_split = split_vct,   column_names_rot = 45,   row_title_rot = 0, gap = unit(0.1, 'inches'),   cell_fun = function(j, i, x, y, width, height, fill) {         grid.rect(x = x, y = y, width = width, height = height,              gp = gpar(col = \"black\", fill = NA))   } ) ht_sources"},{"path":[]},{"path":"/articles/data_integration_and_stats.html","id":"top-10-species-by-number-of-annotations","dir":"Articles","previous_headings":"Number of taxa","what":"Top 10 species by number of annotations","title":"Data integration and bugphyzz stats","text":"really top ten species since lot overlaps (ties) number annotations. first 10 arranging number annotations per species alphabetically.","code":"top10_sp <- bp |>    filter(Rank == 'species') |>   count(NCBI_ID, Taxon_name) |>    arrange(-n, Taxon_name) |>    head(10) top10_sp_p <- top10_sp |>    ggplot(aes(reorder(Taxon_name, -n), n)) +   geom_col(fill = 'dodgerblue4', alpha = 0.8) +   labs(x = 'Top 10 species', y = '# annotations') +   scale_y_continuous(breaks = scales::pretty_breaks()) +   theme_bw() +   theme(     axis.text.x = element_text(angle = 90, hjust = 1),      panel.grid.major.y = element_line(color = 'black', linewidth = 0.2),     panel.grid.major.x = element_blank()   ) top10_sp_p"},{"path":"/articles/data_integration_and_stats.html","id":"frequency-of-number-of-annotations-per-taxon","dir":"Articles","previous_headings":"Number of taxa","what":"Frequency of number of annotations per taxon","title":"Data integration and bugphyzz stats","text":"","code":"freq_annot_rank <- bp |>    count(Rank, NCBI_ID, name = 'n_annot') |>    count(Rank, n_annot) freq_rank_p <- freq_annot_rank |>    mutate(     Rank = factor(Rank, levels = c(       'strain', 'species', 'genus', 'family', 'order', 'class', 'phylum',       'domain'       ))   ) |>    ggplot(aes(n_annot, n)) +   geom_col(fill = 'dodgerblue4', alpha = 0.8) +   scale_y_continuous(breaks = scales::pretty_breaks()) +   scale_x_continuous(     limits = c(0, 11),     breaks = scales::pretty_breaks()   ) +   labs(x = 'Number of annotaions per taxon', y = 'Frequency') +   facet_wrap(~Rank, scales = 'free_y') +   theme_bw() +   theme(     panel.grid.major.x = element_blank(),     panel.grid.minor.x = element_blank(),     panel.grid.major.y = element_line(color = 'black', linewidth = 0.1)   ) freq_rank_p #> Warning: Removed 1 rows containing missing values (`position_stack()`). #> Warning: Removed 1 rows containing missing values (`geom_col()`)."},{"path":[]},{"path":"/articles/data_integration_and_stats.html","id":"annotations-per-physiology","dir":"Articles","previous_headings":"Numbers per physiology","what":"Annotations per physiology","title":"Data integration and bugphyzz stats","text":"","code":"phys_summary <- bp |>    count(Attribute_group) |>    arrange(-n) phys_summary_plot <- phys_summary |>    ggplot(aes(Attribute_group, n)) +   geom_col(fill = 'dodgerblue4', alpha = 0.8) +   labs(y = '# annotations', x = 'Top 10 physiologies') +   theme_bw() +   theme(     axis.text.x = element_text(angle = 45, hjust = 1),     panel.grid.major.x = element_blank(),     panel.grid.major.y = element_line(color = 'black', linewidth = 0.2)   ) phys_summary_plot"},{"path":"/articles/data_integration_and_stats.html","id":"figure-3","dir":"Articles","previous_headings":"","what":"Figure 3?","title":"Data integration and bugphyzz stats","text":"","code":"fig3 <- ggarrange(   top10_sp_p,   phys_summary_plot, labels = c('A)', 'B)'), hjust = 0 ) fig3"},{"path":"/articles/data_integration_and_stats.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Data integration and bugphyzz stats","text":"","code":"sessioninfo::session_info() #> ─ Session info ─────────────────────────────────────────────────────────────── #>  setting  value #>  version  R version 4.3.0 (2023-04-21) #>  os       Ubuntu 22.04.2 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  en_US.UTF-8 #>  ctype    en_US.UTF-8 #>  tz       Etc/UTC #>  date     2023-05-18 #>  pandoc   2.19.2 @ /usr/local/bin/ (via rmarkdown) #>  #> ─ Packages ─────────────────────────────────────────────────────────────────── #>  package          * version date (UTC) lib source #>  abind              1.4-5   2016-07-21 [1] RSPM (R 4.3.0) #>  backports          1.4.1   2021-12-13 [1] RSPM (R 4.3.0) #>  BiocFileCache      2.8.0   2023-04-25 [1] Bioconductor #>  BiocGenerics       0.46.0  2023-04-25 [1] Bioconductor #>  bit                4.0.5   2022-11-15 [1] RSPM (R 4.3.0) #>  bit64              4.0.5   2020-08-30 [1] RSPM (R 4.3.0) #>  blob               1.2.4   2023-03-17 [1] RSPM (R 4.3.0) #>  bold               1.3.0   2023-05-02 [1] RSPM (R 4.3.0) #>  broom              1.0.4   2023-03-11 [1] RSPM (R 4.3.0) #>  bslib              0.4.2   2022-12-16 [1] RSPM (R 4.3.0) #>  bugphyzz         * 0.0.1.3 2023-05-18 [1] Github (waldronlab/bugphyzz@9c7db81) #>  bugphyzzAnalyses * 0.1.0   2023-05-18 [1] local #>  cachem             1.0.8   2023-05-01 [1] RSPM (R 4.3.0) #>  Cairo              1.6-0   2022-07-05 [1] RSPM (R 4.3.0) #>  car                3.1-2   2023-03-30 [1] RSPM (R 4.3.0) #>  carData            3.0-5   2022-01-06 [1] RSPM (R 4.3.0) #>  circlize           0.4.15  2022-05-10 [1] RSPM (R 4.3.0) #>  cli                3.6.1   2023-03-23 [1] RSPM (R 4.3.0) #>  clue               0.3-64  2023-01-31 [1] RSPM (R 4.3.0) #>  cluster            2.1.4   2022-08-22 [2] CRAN (R 4.3.0) #>  codetools          0.2-19  2023-02-01 [2] CRAN (R 4.3.0) #>  colorspace         2.1-0   2023-01-23 [1] RSPM (R 4.3.0) #>  ComplexHeatmap   * 2.16.0  2023-04-25 [1] Bioconductor #>  conditionz         0.1.0   2019-04-24 [1] RSPM (R 4.3.0) #>  cowplot            1.1.1   2020-12-30 [1] RSPM (R 4.3.0) #>  crayon             1.5.2   2022-09-29 [1] RSPM (R 4.3.0) #>  crul               1.4.0   2023-05-17 [1] RSPM (R 4.3.0) #>  curl               5.0.0   2023-01-12 [1] RSPM (R 4.3.0) #>  data.table         1.14.8  2023-02-17 [1] RSPM (R 4.3.0) #>  DBI                1.1.3   2022-06-18 [1] RSPM (R 4.3.0) #>  dbplyr             2.3.2   2023-03-21 [1] RSPM (R 4.3.0) #>  desc               1.4.2   2022-09-08 [1] RSPM (R 4.3.0) #>  digest             0.6.31  2022-12-11 [1] RSPM (R 4.3.0) #>  doParallel         1.0.17  2022-02-07 [1] RSPM (R 4.3.0) #>  dplyr            * 1.1.2   2023-04-20 [1] RSPM (R 4.3.0) #>  evaluate           0.21    2023-05-05 [1] RSPM (R 4.3.0) #>  fansi              1.0.4   2023-01-22 [1] RSPM (R 4.3.0) #>  farver             2.1.1   2022-07-06 [1] RSPM (R 4.3.0) #>  fastmap            1.1.1   2023-02-24 [1] RSPM (R 4.3.0) #>  filelock           1.0.2   2018-10-05 [1] RSPM (R 4.3.0) #>  forcats          * 1.0.0   2023-01-29 [1] RSPM (R 4.3.0) #>  foreach            1.5.2   2022-02-02 [1] RSPM (R 4.3.0) #>  fs                 1.6.2   2023-04-25 [1] RSPM (R 4.3.0) #>  generics           0.1.3   2022-07-05 [1] RSPM (R 4.3.0) #>  GetoptLong         1.0.5   2020-12-15 [1] RSPM (R 4.3.0) #>  ggplot2          * 3.4.2   2023-04-03 [1] RSPM (R 4.3.0) #>  ggpubr           * 0.6.0   2023-02-10 [1] RSPM (R 4.3.0) #>  ggsignif           0.6.4   2022-10-13 [1] RSPM (R 4.3.0) #>  GlobalOptions      0.1.2   2020-06-10 [1] RSPM (R 4.3.0) #>  glue               1.6.2   2022-02-24 [1] RSPM (R 4.3.0) #>  gridExtra          2.3     2017-09-09 [1] RSPM (R 4.3.0) #>  gtable             0.3.3   2023-03-21 [1] RSPM (R 4.3.0) #>  highr              0.10    2022-12-22 [1] RSPM (R 4.3.0) #>  hms                1.1.3   2023-03-21 [1] RSPM (R 4.3.0) #>  hoardr             0.5.3   2023-01-26 [1] RSPM (R 4.3.0) #>  htmltools          0.5.5   2023-03-23 [1] RSPM (R 4.3.0) #>  httpcode           0.3.0   2020-04-10 [1] RSPM (R 4.3.0) #>  httr               1.4.6   2023-05-08 [1] RSPM (R 4.3.0) #>  IRanges            2.34.0  2023-04-25 [1] Bioconductor #>  iterators          1.0.14  2022-02-05 [1] RSPM (R 4.3.0) #>  jquerylib          0.1.4   2021-04-26 [1] RSPM (R 4.3.0) #>  jsonlite           1.8.4   2022-12-06 [1] RSPM (R 4.3.0) #>  knitr              1.42    2023-01-25 [1] RSPM (R 4.3.0) #>  labeling           0.4.2   2020-10-20 [1] RSPM (R 4.3.0) #>  lifecycle          1.0.3   2022-10-07 [1] RSPM (R 4.3.0) #>  magrittr           2.0.3   2022-03-30 [1] RSPM (R 4.3.0) #>  matrixStats        0.63.0  2022-11-18 [1] RSPM (R 4.3.0) #>  memoise            2.0.1   2021-11-26 [1] RSPM (R 4.3.0) #>  mgsub              1.7.3   2021-07-28 [1] RSPM (R 4.3.0) #>  munsell            0.5.0   2018-06-12 [1] RSPM (R 4.3.0) #>  pillar             1.9.0   2023-03-22 [1] RSPM (R 4.3.0) #>  pkgconfig          2.0.3   2019-09-22 [1] RSPM (R 4.3.0) #>  pkgdown            2.0.7   2022-12-14 [1] RSPM (R 4.3.0) #>  png                0.1-8   2022-11-29 [1] RSPM (R 4.3.0) #>  purrr            * 1.0.1   2023-01-10 [1] RSPM (R 4.3.0) #>  R6                 2.5.1   2021-08-19 [1] RSPM (R 4.3.0) #>  ragg               1.2.5   2023-01-12 [1] RSPM (R 4.3.0) #>  rappdirs           0.3.3   2021-01-31 [1] RSPM (R 4.3.0) #>  RColorBrewer       1.1-3   2022-04-03 [1] RSPM (R 4.3.0) #>  readr              2.1.4   2023-02-10 [1] RSPM (R 4.3.0) #>  rjson              0.2.21  2022-01-09 [1] RSPM (R 4.3.0) #>  rlang              1.1.1   2023-04-28 [1] RSPM (R 4.3.0) #>  rmarkdown          2.21    2023-03-26 [1] RSPM (R 4.3.0) #>  rprojroot          2.0.3   2022-04-02 [1] RSPM (R 4.3.0) #>  RSQLite            2.3.1   2023-04-03 [1] RSPM (R 4.3.0) #>  rstatix            0.7.2   2023-02-01 [1] RSPM (R 4.3.0) #>  S4Vectors          0.38.1  2023-05-02 [1] Bioconductor #>  sass               0.4.6   2023-05-03 [1] RSPM (R 4.3.0) #>  scales             1.2.1   2022-08-20 [1] RSPM (R 4.3.0) #>  sessioninfo        1.2.2   2021-12-06 [1] RSPM (R 4.3.0) #>  shape              1.4.6   2021-05-19 [1] RSPM (R 4.3.0) #>  stringi            1.7.12  2023-01-11 [1] RSPM (R 4.3.0) #>  stringr            1.5.0   2022-12-02 [1] RSPM (R 4.3.0) #>  systemfonts        1.0.4   2022-02-11 [1] RSPM (R 4.3.0) #>  taxa               0.4.2   2022-04-12 [1] RSPM (R 4.3.0) #>  taxize             1.0     2023-05-18 [1] Github (ropensci/taxize@bcff2a6) #>  taxizedb           0.3.1   2023-04-03 [1] RSPM (R 4.3.0) #>  taxPPro          * 0.1.0   2023-05-18 [1] Github (sdgamboa/taxPPro@1711030) #>  textshaping        0.3.6   2021-10-13 [1] RSPM (R 4.3.0) #>  tibble             3.2.1   2023-03-20 [1] RSPM (R 4.3.0) #>  tidyr            * 1.3.0   2023-01-24 [1] RSPM (R 4.3.0) #>  tidyselect         1.2.0   2022-10-10 [1] RSPM (R 4.3.0) #>  tzdb               0.4.0   2023-05-12 [1] RSPM (R 4.3.0) #>  utf8               1.2.3   2023-01-31 [1] RSPM (R 4.3.0) #>  uuid               1.1-0   2022-04-19 [1] RSPM (R 4.3.0) #>  vctrs              0.6.2   2023-04-19 [1] RSPM (R 4.3.0) #>  viridis            0.6.3   2023-05-03 [1] RSPM (R 4.3.0) #>  viridisLite        0.4.2   2023-05-02 [1] RSPM (R 4.3.0) #>  vroom              1.6.3   2023-04-28 [1] RSPM (R 4.3.0) #>  withr              2.5.0   2022-03-03 [1] RSPM (R 4.3.0) #>  xfun               0.39    2023-04-20 [1] RSPM (R 4.3.0) #>  xml2               1.3.4   2023-04-27 [1] RSPM (R 4.3.0) #>  yaml               2.3.7   2023-01-23 [1] RSPM (R 4.3.0) #>  #>  [1] /usr/local/lib/R/site-library #>  [2] /usr/local/lib/R/library #>  #> ──────────────────────────────────────────────────────────────────────────────"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"some-considerations","dir":"Articles","previous_headings":"","what":"Some considerations","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"Use signatures differential abundance results BugSigDB (‘Abundance group 1’ columns). terms BugSigDB referring body site merged. ’ll use TypicalMicrobiomeSignatures create background sets. analysis, ORA (Fishers’ exact test) used.","code":""},{"path":[]},{"path":"/articles/high_throughput_msea_bsdb.html","id":"typicalmicrobiomesignatures-sets","dir":"Articles","previous_headings":"Data","what":"TypicalMicrobiomeSignatures sets","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"Use TypicalMicrobiomeSignatures create background sets. Use cutoff 0.01 prevalence filtering. Create sets tms genus species ranks body sites (skin, vagina, oralcavity, nasalcavity, stool):","code":"tms <- importTidyTMS(prevalence_threshold = 0.01) |>    mutate(     body_site = case_when(       body_site == 'feces' ~ 'stool',       body_site == 'nasalcavity' ~ 'nasal_cavity',       body_site == 'oralcavity' ~ 'oral_cavity',       TRUE ~ body_site     )   ) glimpse(tms, width = 70) #> Rows: 3,938 #> Columns: 6 #> $ taxid      <int> 1279, 1279, 1279, 1279, 1279, 1912216, 1912216, 1… #> $ taxon_name <chr> \"Staphylococcus\", \"Staphylococcus\", \"Staphylococc… #> $ body_site  <chr> \"skin\", \"vagina\", \"oral_cavity\", \"nasal_cavity\", … #> $ rank       <chr> \"genus\", \"genus\", \"genus\", \"genus\", \"genus\", \"gen… #> $ prevalence <dbl> 0.99, 0.06, 0.04, 0.87, 0.02, 0.96, 0.06, 0.30, 0… #> $ age_range  <chr> \"adult\", \"adult\", \"adult\", \"adult\", \"adult\", \"adu… body_sites <- c('skin', 'vagina', 'oral_cavity', 'nasal_cavity', 'stool') ranks <- c('genus', 'species') l <- length(body_sites) * length(ranks) tms_sets <- vector('list', l) n <- 1 for (i in seq_along(body_sites)) {   for (j in seq_along(ranks)) {     names(tms_sets)[n] <- paste0(body_sites[i], '__', ranks[j])     tms_sets[[n]] <- tms |>        filter(body_site == body_sites[i], rank == ranks[j]) |>        pull(taxid) |>        unique()     n <- n + 1   } } map(tms_sets, head) #> $skin__genus #> [1]    1279 1912216   55193    1716    1301    1269 #>  #> $skin__species #> [1]  1747  1282 76775 29388 33011 76773 #>  #> $vagina__genus #> [1]    1279 1912216   55193    1716    1301  150022 #>  #> $vagina__species #> [1]  1747  1282 76775 29388 33011  1290 #>  #> $oral_cavity__genus #> [1]    1279 1912216   55193    1716    1301    1269 #>  #> $oral_cavity__species #> [1]  1747  1282 76775 28037  1270 34062 #>  #> $nasal_cavity__genus #> [1]    1279 1912216   55193    1716    1301    1269 #>  #> $nasal_cavity__species #> [1]  1747  1282 76775 29388 33011 76773 #>  #> $stool__genus #> [1]    1279 1912216    1716    1301  150022   32207 #>  #> $stool__species #> [1]  1747  1282 28037  1260  1303 43675"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"bugsigdb-sets","dir":"Articles","previous_headings":"Data","what":"BugSigDB sets","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"Just consider signatures ‘decreased’ ‘increased’ values ‘Abundance Group 1’ column, .e., signatures experiments differential abundance results. need five body sites, skin, vagina, oral cavity, stool, nasal cavity, match TypicalMicrobiomeSignatures create background dataset.","code":"oral_terms <- c(   \"buccal mucosa\", \"buccal mucosa,lower lip\", \"dental plaque\",   \"dental plaque,internal cheek pouch,saliva\", \"gingiva\",    \"internal cheek pouch\", \"mouth\",    \"mouth,skin of cheek,tongue,gingiva,oropharynx\", \"oral cavity\",   \"oral opening\", \"saliva\", \"skin of cheek\", \"subgingival dental plaque\",   \"superior surface of tongue\", \"supragingival dental plaque\", \"tongue\" ) stool_terms <- c(   'feces', 'feces,mucosa of small intestine',    'feces,stomach,caecum,small intestine,colon' ) bsdb <- importBugSigDB() |>    as_tibble() |>    filter(`Abundance in Group 1` %in% c('increased', 'decreased')) |>    filter(`Host species` == 'Homo sapiens') |>    mutate(`Body site` = tolower(`Body site`)) |>    mutate(`Body site` = case_when(     grepl('vagina', `Body site`) ~ 'vagina',     `Body site` %in% oral_terms ~ 'oral_cavity',     grepl('^skin', `Body site`) ~ 'skin',     `Body site` %in% stool_terms ~ 'stool',     `Body site` == 'nasal cavity' ~ 'nasal_cavity',     TRUE ~ `Body site`     )   ) |>    filter(     `Body site` %in% c('vagina', 'oral_cavity', 'skin', 'stool', 'nasal_cavity')   ) # glimpse(bsdb, width = 70) dim(bsdb) #> [1] 1609   48 bsdb_sets <- vector('list', l) n <- 1 for (i in seq_along(body_sites)) {   for (j in seq_along(ranks)) {   sub_bsdb <- bsdb |>        filter(`Body site` == body_sites[i])   names(bsdb_sets)[n] <- paste0(body_sites[i], '__', ranks[j])   sig <- bugsigdbr::getSignatures(       df = sub_bsdb, tax.id.type = 'ncbi', tax.level = ranks[j], min.size = 5   )   if (length(sig) > 0) {     bsdb_sets[[n]] <- sig   }   n <- n + 1   } } bsdb_sets <- discard(bsdb_sets, is.null)"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"background-sets","dir":"Articles","previous_headings":"Data","what":"Background sets","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"","code":"tms_sets <- tms_sets[names(bsdb_sets)] background_sets <- vector('list', length(bsdb_sets)) for (i in seq_along(background_sets)) {   names(background_sets)[i] <- names(bsdb_sets)[i]   background_sets[[i]] <- map(     bsdb_sets[[names(bsdb_sets)[i]]], ~ {       unique(c(.x, tms_sets[[ names(bsdb_sets)[i] ]]))       }     ) } map(background_sets, length) #> $skin__genus #> [1] 8 #>  #> $skin__species #> [1] 2 #>  #> $vagina__genus #> [1] 31 #>  #> $vagina__species #> [1] 15 #>  #> $oral_cavity__genus #> [1] 55 #>  #> $oral_cavity__species #> [1] 44 #>  #> $nasal_cavity__genus #> [1] 4 #>  #> $stool__genus #> [1] 247 #>  #> $stool__species #> [1] 124"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"bugphyzz-sets","dir":"Articles","previous_headings":"Data","what":"bugphyzz sets","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"Genus signatures Species signatures","code":"bp <- as_tibble(importBugphyzz(version = 'devel')) glimpse(bp, width = 70) #> Rows: 376,603 #> Columns: 12 #> $ NCBI_ID                <chr> \"10\", \"1000999\", \"100132\", \"100175\", … #> $ Taxon_name             <chr> \"Cellvibrio\", \"Acidipila\", \"Sporobact… #> $ Rank                   <chr> \"genus\", \"genus\", \"genus\", \"genus\", \"… #> $ Attribute              <chr> \"aerophilicity:aerobic\", \"aerophilici… #> $ Attribute_source       <chr> \"Bergey's Manual\", \"Bergey's Manual\",… #> $ Evidence               <chr> \"exp\", \"exp\", \"exp\", \"exp\", \"exp\", \"e… #> $ Frequency              <chr> \"always\", \"always\", \"always\", \"always… #> $ Attribute_type         <chr> \"logical\", \"logical\", \"logical\", \"log… #> $ Attribute_group        <chr> \"aerophilicity\", \"aerophilicity\", \"ae… #> $ Confidence_in_curation <chr> \"high\", \"high\", \"high\", \"high\", \"high… #> $ Score                  <dbl> 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.… #> $ Attribute_value        <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T… bp_sigs_gn <- getBugphyzzSignatures(   df = bp, tax.id.type = 'NCBI_ID', tax.level = 'genus', min.size = 10 ) head(map(bp_sigs_gn, head)) #> $`aerophilicity:aerobic` #> [1] \"10\"      \"1000999\" \"1004300\" \"1007\"    \"1007082\" \"1008195\" #>  #> $`aerophilicity:anaerobic` #> [1] \"100132\" \"100175\" \"102106\" \"104175\" \"109166\" \"109168\" #>  #> $`aerophilicity:facultatively_anaerobic` #> [1] \"1016\"    \"1036132\" \"1069494\" \"1078829\" \"111142\"  \"111500\"  #>  #> $`aerophilicity:microaerophilic` #> [1] \"106146\"  \"12960\"   \"13134\"   \"1410680\" \"191\"     \"206375\"  #>  #> $`aerophilicity:obligately_aerobic` #> [1] \"110934\"  \"1123967\" \"123\"     \"135575\"  \"1450140\" \"146918\"  #>  #> $`aerophilicity:obligately_anaerobic` #> [1] \"100883\"  \"101191\"  \"1080709\" \"118747\"  \"1200657\" \"1257\" bp_sigs_sp <- getBugphyzzSignatures(   df = bp, tax.id.type = 'NCBI_ID', tax.level = 'species', min.size = 10 ) head(map(bp_sigs_sp, head)) #> $`aerophilicity:aerobic` #> [1] \"1001240\" \"1002\"    \"1002227\" \"100225\"  \"1002672\" \"1003091\" #>  #> $`aerophilicity:anaerobic` #> [1] \"100133\"  \"100174\"  \"1002795\" \"1004583\" \"1005740\" \"1006155\" #>  #> $`aerophilicity:facultatively_anaerobic` #> [1] \"1017095\" \"102684\"  \"1028752\" \"1031538\" \"1034471\" \"1036133\" #>  #> $`aerophilicity:microaerophilic` #> [1] \"1000562\" \"100177\"  \"1017\"    \"1031542\" \"104608\"  \"1050107\" #>  #> $`aerophilicity:obligately_aerobic` #> [1] \"1002689\" \"1002691\" \"1003110\" \"100379\"  \"1007087\" \"1007089\" #>  #> $`aerophilicity:obligately_anaerobic` #> [1] \"1000568\" \"1000569\" \"1008305\" \"1008460\" \"101192\"  \"102134\""},{"path":"/articles/high_throughput_msea_bsdb.html","id":"enrichment-analysis","dir":"Articles","previous_headings":"","what":"Enrichment analysis","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"","code":"if (!'BSDB ID' %in% colnames(bsdb)) {   bsdb <- bsdb |>      mutate(       `BSDB ID`  = paste0(         'bsdb:',         sub('^.* ', '', Study), '/',          sub('^.* ', '', Experiment), '/',          sub('^.* ', '', `Signature page name`)       )     ) |>      relocate(`BSDB ID`) }  enrichment_res <- vector('list', length(bsdb_sets)) for (i in seq_along(bsdb_sets)) {   message('Running enrichment for bsdb ', names(bsdb_sets)[i], '.')   names(enrichment_res)[i] <- names(bsdb_sets)[i]   if (grepl('genus', names(bsdb_sets)[i])) {     res <- runEnrichment(       bsdb_sets = bsdb_sets[[i]],       background_sets = background_sets[[i]],       bp_sigs = bp_sigs_gn,       bsdb = bsdb,        fdr_ths = 0.1     )   } else if (grepl('species', names(bsdb_sets)[i])) {     res <- runEnrichment(       bsdb_sets = bsdb_sets[[i]],       background_sets = background_sets[[i]],       bp_sigs = bp_sigs_sp,       bsdb = bsdb,        fdr_ths = 0.1     )   }   enrichment_res[[i]] <- res } enrichment_res <- discard(enrichment_res, ~ !nrow(.x)) map(enrichment_res, nrow) #> $skin__genus #> [1] 2 #>  #> $vagina__genus #> [1] 12 #>  #> $vagina__species #> [1] 1 #>  #> $oral_cavity__genus #> [1] 10 #>  #> $oral_cavity__species #> [1] 27 #>  #> $stool__genus #> [1] 39 #>  #> $stool__species #> [1] 77 ## top hits by odds ratio plots <- vector('list', length(enrichment_res)) for (i in seq_along(plots)) {   b <- sub('^(.*)__.*$', '\\\\1', names(enrichment_res)[i])   r <- sub('^.*__(.*)$', '\\\\1', names(enrichment_res)[i])   names(plots)[i] <- names(enrichment_res)[i]   plots[[i]] <- plotEnrichmentRes(enrichment_res[[i]], b, r) }"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"a-single-case-step-by-step","dir":"Articles","previous_headings":"","what":"A single case (step by step)","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"Get bsdb signatures Create background sets Create contingency tables Enrichment","code":"bsdb_sets_ <- bsdb |>      filter(`Body site` == 'stool', `Host species` == 'Homo sapiens') |>      bugsigdbr::getSignatures(       tax.id.type = 'ncbi', tax.level = 'genus', min.size = 5     )  length(bsdb_sets_) #> [1] 247 lapply(bsdb_sets_[1:3], head) #> $`bsdb:1/1/1_adenoma:conventional-adenoma-cases_vs_controls_UP` #> [1] \"1654\"   \"1716\"   \"1301\"   \"162289\" \"189330\" \"33024\"  #>  #> $`bsdb:1/4/1_adenoma:Proximal-conventional-adenoma-cases_vs_controls_UP` #> [1] \"1654\"   \"1716\"   \"1485\"   \"836\"    \"162289\" \"1301\"   #>  #> $`bsdb:1/6/1_adenoma:Non-advanced-conventional-adenoma-cases_vs_controls_UP` #> [1] \"1654\"   \"283168\" \"1301\"   \"189330\" \"40544\"  \"33024\" typical_set_ <- tms |>      filter(body_site == 'stool', rank == 'genus') |>      pull(taxid) |>      unique() length(typical_set_)  #> [1] 197 head(typical_set_) #> [1]    1279 1912216    1716    1301  150022   32207 background_sets_ <- lapply(bsdb_sets_, function(x) unique(c(x, typical_set_))) length(background_sets_) #> [1] 247 taxa_name_ <- 'bsdb:237/1/1_chronic-hepatitis-C-virus-infection:cirrhosis-patients_vs_healthy-controls_UP' ct <- bugphyzzAnalyses:::.contingencyTable(     set = bsdb_sets_[[taxa_name_]],     reference = background_sets_[[taxa_name_]],     sig = bp_sigs_gn$`aerophilicity:aerobic` ) ct #>           sig #> set        inSig notInSig #>   inSet        4        6 #>   notInSet    16      173 p_value_ <- stats::fisher.test(ct, alternative = 'g')$p.value p_value_ #> [1] 0.01066648"},{"path":"/articles/high_throughput_msea_bsdb.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"High-througput MSEA of BugSigDB and bugphyzz sets","text":"","code":"sessioninfo::session_info() #> ─ Session info ─────────────────────────────────────────────────────────────── #>  setting  value #>  version  R version 4.3.0 (2023-04-21) #>  os       Ubuntu 22.04.2 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  en_US.UTF-8 #>  ctype    en_US.UTF-8 #>  tz       Etc/UTC #>  date     2023-05-18 #>  pandoc   2.19.2 @ /usr/local/bin/ (via rmarkdown) #>  #> ─ Packages ─────────────────────────────────────────────────────────────────── #>  package          * version  date (UTC) lib source #>  BiocFileCache      2.8.0    2023-04-25 [1] Bioconductor #>  bit                4.0.5    2022-11-15 [1] RSPM (R 4.3.0) #>  bit64              4.0.5    2020-08-30 [1] RSPM (R 4.3.0) #>  blob               1.2.4    2023-03-17 [1] RSPM (R 4.3.0) #>  bold               1.3.0    2023-05-02 [1] RSPM (R 4.3.0) #>  bslib              0.4.2    2022-12-16 [1] RSPM (R 4.3.0) #>  bugphyzz         * 0.0.1.3  2023-05-18 [1] Github (waldronlab/bugphyzz@9c7db81) #>  bugphyzzAnalyses * 0.1.0    2023-05-18 [1] local #>  bugsigdbr        * 1.6.1    2023-04-27 [1] Bioconductor #>  cachem             1.0.8    2023-05-01 [1] RSPM (R 4.3.0) #>  cli                3.6.1    2023-03-23 [1] RSPM (R 4.3.0) #>  colorspace         2.1-0    2023-01-23 [1] RSPM (R 4.3.0) #>  conditionz         0.1.0    2019-04-24 [1] RSPM (R 4.3.0) #>  crayon             1.5.2    2022-09-29 [1] RSPM (R 4.3.0) #>  crul               1.4.0    2023-05-17 [1] RSPM (R 4.3.0) #>  curl               5.0.0    2023-01-12 [1] RSPM (R 4.3.0) #>  data.table         1.14.8   2023-02-17 [1] RSPM (R 4.3.0) #>  DBI                1.1.3    2022-06-18 [1] RSPM (R 4.3.0) #>  dbplyr             2.3.2    2023-03-21 [1] RSPM (R 4.3.0) #>  desc               1.4.2    2022-09-08 [1] RSPM (R 4.3.0) #>  digest             0.6.31   2022-12-11 [1] RSPM (R 4.3.0) #>  dplyr            * 1.1.2    2023-04-20 [1] RSPM (R 4.3.0) #>  epitools           0.5-10.1 2020-03-22 [1] RSPM (R 4.3.0) #>  evaluate           0.21     2023-05-05 [1] RSPM (R 4.3.0) #>  fansi              1.0.4    2023-01-22 [1] RSPM (R 4.3.0) #>  farver             2.1.1    2022-07-06 [1] RSPM (R 4.3.0) #>  fastmap            1.1.1    2023-02-24 [1] RSPM (R 4.3.0) #>  filelock           1.0.2    2018-10-05 [1] RSPM (R 4.3.0) #>  forcats            1.0.0    2023-01-29 [1] RSPM (R 4.3.0) #>  fs                 1.6.2    2023-04-25 [1] RSPM (R 4.3.0) #>  generics           0.1.3    2022-07-05 [1] RSPM (R 4.3.0) #>  ggplot2          * 3.4.2    2023-04-03 [1] RSPM (R 4.3.0) #>  glue               1.6.2    2022-02-24 [1] RSPM (R 4.3.0) #>  gtable             0.3.3    2023-03-21 [1] RSPM (R 4.3.0) #>  hoardr             0.5.3    2023-01-26 [1] RSPM (R 4.3.0) #>  htmltools          0.5.5    2023-03-23 [1] RSPM (R 4.3.0) #>  httpcode           0.3.0    2020-04-10 [1] RSPM (R 4.3.0) #>  httr               1.4.6    2023-05-08 [1] RSPM (R 4.3.0) #>  jquerylib          0.1.4    2021-04-26 [1] RSPM (R 4.3.0) #>  jsonlite           1.8.4    2022-12-06 [1] RSPM (R 4.3.0) #>  knitr              1.42     2023-01-25 [1] RSPM (R 4.3.0) #>  lifecycle          1.0.3    2022-10-07 [1] RSPM (R 4.3.0) #>  magrittr           2.0.3    2022-03-30 [1] RSPM (R 4.3.0) #>  memoise            2.0.1    2021-11-26 [1] RSPM (R 4.3.0) #>  mgsub              1.7.3    2021-07-28 [1] RSPM (R 4.3.0) #>  munsell            0.5.0    2018-06-12 [1] RSPM (R 4.3.0) #>  pillar             1.9.0    2023-03-22 [1] RSPM (R 4.3.0) #>  pkgconfig          2.0.3    2019-09-22 [1] RSPM (R 4.3.0) #>  pkgdown            2.0.7    2022-12-14 [1] RSPM (R 4.3.0) #>  purrr            * 1.0.1    2023-01-10 [1] RSPM (R 4.3.0) #>  R6                 2.5.1    2021-08-19 [1] RSPM (R 4.3.0) #>  ragg               1.2.5    2023-01-12 [1] RSPM (R 4.3.0) #>  rappdirs           0.3.3    2021-01-31 [1] RSPM (R 4.3.0) #>  rlang              1.1.1    2023-04-28 [1] RSPM (R 4.3.0) #>  rmarkdown          2.21     2023-03-26 [1] RSPM (R 4.3.0) #>  rprojroot          2.0.3    2022-04-02 [1] RSPM (R 4.3.0) #>  RSQLite            2.3.1    2023-04-03 [1] RSPM (R 4.3.0) #>  sass               0.4.6    2023-05-03 [1] RSPM (R 4.3.0) #>  scales             1.2.1    2022-08-20 [1] RSPM (R 4.3.0) #>  sessioninfo        1.2.2    2021-12-06 [1] RSPM (R 4.3.0) #>  stringi            1.7.12   2023-01-11 [1] RSPM (R 4.3.0) #>  stringr            1.5.0    2022-12-02 [1] RSPM (R 4.3.0) #>  systemfonts        1.0.4    2022-02-11 [1] RSPM (R 4.3.0) #>  taxa               0.4.2    2022-04-12 [1] RSPM (R 4.3.0) #>  taxize             1.0      2023-05-18 [1] Github (ropensci/taxize@bcff2a6) #>  taxizedb           0.3.1    2023-04-03 [1] RSPM (R 4.3.0) #>  taxPPro          * 0.1.0    2023-05-18 [1] Github (sdgamboa/taxPPro@1711030) #>  textshaping        0.3.6    2021-10-13 [1] RSPM (R 4.3.0) #>  tibble             3.2.1    2023-03-20 [1] RSPM (R 4.3.0) #>  tidyr            * 1.3.0    2023-01-24 [1] RSPM (R 4.3.0) #>  tidyselect         1.2.0    2022-10-10 [1] RSPM (R 4.3.0) #>  tzdb               0.4.0    2023-05-12 [1] RSPM (R 4.3.0) #>  utf8               1.2.3    2023-01-31 [1] RSPM (R 4.3.0) #>  uuid               1.1-0    2022-04-19 [1] RSPM (R 4.3.0) #>  vctrs              0.6.2    2023-04-19 [1] RSPM (R 4.3.0) #>  viridisLite        0.4.2    2023-05-02 [1] RSPM (R 4.3.0) #>  vroom              1.6.3    2023-04-28 [1] RSPM (R 4.3.0) #>  withr              2.5.0    2022-03-03 [1] RSPM (R 4.3.0) #>  xfun               0.39     2023-04-20 [1] RSPM (R 4.3.0) #>  xml2               1.3.4    2023-04-27 [1] RSPM (R 4.3.0) #>  yaml               2.3.7    2023-01-23 [1] RSPM (R 4.3.0) #>  #>  [1] /usr/local/lib/R/site-library #>  [2] /usr/local/lib/R/library #>  #> ──────────────────────────────────────────────────────────────────────────────"},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"expected-result","dir":"Articles","previous_headings":"","what":"Expected result","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"Enrichment anaerobic bacteria healthy samples (gut). Enrichment facultative anaerobic bacteria IBD samples (gut).","code":""},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"Use HMP_2019_bidmdb study cMD:","code":"dataset_name <- \"HallAB_2017.relative_abundance\" tse <- curatedMetagenomicData(     pattern = dataset_name,      dryrun = FALSE, rownames = 'NCBI',     counts = TRUE )[[1]] colData(tse)$GROUP <- ifelse(colData(tse)$study_condition == 'control', 0, 1) tse  #> class: TreeSummarizedExperiment  #> dim: 503 259  #> metadata(1): agglomerated_by_rank #> assays(1): relative_abundance #> rownames(503): 853 820 ... 172901 1262744 #> rowData names(7): superkingdom phylum ... genus species #> colnames(259): p8582_mo1 p8582_mo10 ... SKST041_2_G103027 #>   SKST041_3_G103028 #> colData names(25): study_name subject_id ... SCCAI GROUP #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): #> rowLinks: a LinkDataFrame (503 rows) #> rowTree: 1 phylo tree(s) (10430 leaves) #> colLinks: NULL #> colTree: NULL"},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"bugphyzz-data","dir":"Articles","previous_headings":"","what":"bugphyzz data","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"","code":"bp <- importBugphyzz() bp <- bp |>    filter(Attribute_group == 'aerophilicity') sp_sigs <- getBugphyzzSignatures(   df = bp, tax.id.type = 'NCBI_ID', tax.level = 'species' )"},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"deseq2-ora-and-gsea","dir":"Articles","previous_headings":"","what":"DESEQ2 + ORA and GSEA","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"DA: ORA: GSEA:","code":"assay(tse, 'relab_plus_1') <- assay(tse, 'relative_abundance') + 1 deseq <- deAna(     expr = tse, de.method = 'DESeq2', padj.method = 'BH',      assay = 'relab_plus_1' ) dim(deseq) #> [1] 126 259 deseq_ora <- sbea(     method = 'ora', se = deseq, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'relab_plus_1' ) gsRanking(res = deseq_ora, signif.only = FALSE) #> DataFrame with 3 rows and 5 columns #>                 GENE.SET  NR.GENES NR.SIG.GENES      PVAL  ADJ.PVAL #>              <character> <numeric>    <numeric> <numeric> <numeric> #> 1 aerophilicity:facult..         6            6     0.104     0.312 #> 2 aerophilicity:anaero..        68           48     0.430     0.645 #> 3 aerophilicity:obliga..        72           48     0.833     0.833 deseq_gsea <- sbea(     method = 'gsea', se = deseq, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'relab_plus_1' ) gsRanking(res = deseq_gsea, signif.only = FALSE) #> DataFrame with 3 rows and 3 columns #>                 GENE.SET      PVAL  ADJ.PVAL #>              <character> <numeric> <numeric> #> 1 aerophilicity:facult..   0.00103   0.00309 #> 2 aerophilicity:obliga..   0.01050   0.01160 #> 3 aerophilicity:anaero..   0.01160   0.01160"},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"edger","dir":"Articles","previous_headings":"","what":"edgeR","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"ORA: GSEA:","code":"edger <- deAna(     expr = tse, de.method = 'edgeR', padj.method = 'BH',      assay = 'relab_plus_1' ) edger_ora <- sbea(     method = 'ora', se = edger, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'relab_plus_1' ) gsRanking(edger_ora, signif.only = FALSE) #> DataFrame with 3 rows and 5 columns #>                 GENE.SET  NR.GENES NR.SIG.GENES      PVAL  ADJ.PVAL #>              <character> <numeric>    <numeric> <numeric> <numeric> #> 1 aerophilicity:obliga..        72           50     0.198     0.328 #> 2 aerophilicity:anaero..        68           47     0.245     0.328 #> 3 aerophilicity:facult..         6            5     0.328     0.328 edger_gsea <- sbea(     method = 'gsea', se = edger, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'relab_plus_1' ) gsRanking(edger_gsea, signif.only = FALSE) #> DataFrame with 3 rows and 3 columns #>                 GENE.SET      PVAL  ADJ.PVAL #>              <character> <numeric> <numeric> #> 1 aerophilicity:facult..   0.00103   0.00309 #> 2 aerophilicity:obliga..   0.01050   0.01160 #> 3 aerophilicity:anaero..   0.01160   0.01160"},{"path":"/articles/ibd-aerophilicity-enrichment.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"MSEA control vs IBD in cMD for aerophilicity attributes","text":"","code":"sessionInfo() #> R version 4.3.0 (2023-04-21) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               #>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     #>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    #>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  #>  [9] LC_ADDRESS=C               LC_TELEPHONE=C             #> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        #>  #> time zone: Etc/UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] npGSEA_1.36.0                  GSEABase_1.62.0                #>  [3] annotate_1.78.0                XML_3.99-0.14                  #>  [5] AnnotationDbi_1.62.1           DESeq2_1.40.1                  #>  [7] EnrichmentBrowser_2.30.1       graph_1.78.0                   #>  [9] dplyr_1.1.2                    curatedMetagenomicData_3.8.0   #> [11] TreeSummarizedExperiment_2.8.0 Biostrings_2.68.1              #> [13] XVector_0.40.0                 SingleCellExperiment_1.22.0    #> [15] SummarizedExperiment_1.30.1    Biobase_2.60.0                 #> [17] GenomicRanges_1.52.0           GenomeInfoDb_1.36.0            #> [19] IRanges_2.34.0                 S4Vectors_0.38.1               #> [21] BiocGenerics_0.46.0            MatrixGenerics_1.12.0          #> [23] matrixStats_0.63.0             bugphyzz_0.0.1.3               #>  #> loaded via a namespace (and not attached): #>   [1] splines_4.3.0                 later_1.3.1                   #>   [3] bitops_1.0-7                  filelock_1.0.2                #>   [5] tibble_3.2.1                  taxizedb_0.3.1                #>   [7] DirichletMultinomial_1.42.0   lifecycle_1.0.3               #>   [9] edgeR_3.42.2                  bold_1.3.0                    #>  [11] rprojroot_2.0.3               vroom_1.6.3                   #>  [13] lattice_0.21-8                MASS_7.3-59                   #>  [15] MultiAssayExperiment_1.26.0   magrittr_2.0.3                #>  [17] limma_3.56.1                  sass_0.4.6                    #>  [19] rmarkdown_2.21                jquerylib_0.1.4               #>  [21] yaml_2.3.7                    httpuv_1.6.11                 #>  [23] DBI_1.1.3                     zlibbioc_1.46.0               #>  [25] purrr_1.0.1                   RCurl_1.98-1.12               #>  [27] yulab.utils_0.0.6             rappdirs_0.3.3                #>  [29] GenomeInfoDbData_1.2.10       ggrepel_0.9.3                 #>  [31] irlba_2.3.5.1                 tidytree_0.4.2                #>  [33] crul_1.4.0                    vegan_2.6-4                   #>  [35] conditionz_0.1.0              pkgdown_2.0.7                 #>  [37] permute_0.9-7                 DelayedMatrixStats_1.22.0     #>  [39] codetools_0.2-19              DelayedArray_0.26.2           #>  [41] scuttle_1.10.1                xml2_1.3.4                    #>  [43] tidyselect_1.2.0              httpcode_0.3.0                #>  [45] ScaledMatrix_1.8.1            viridis_0.6.3                 #>  [47] BiocFileCache_2.8.0           jsonlite_1.8.4                #>  [49] BiocNeighbors_1.18.0          decontam_1.20.0               #>  [51] ellipsis_0.3.2                mia_1.8.0                     #>  [53] scater_1.28.0                 systemfonts_1.0.4             #>  [55] tools_4.3.0                   treeio_1.24.0                 #>  [57] ragg_1.2.5                    Rcpp_1.0.10                   #>  [59] glue_1.6.2                    gridExtra_2.3                 #>  [61] xfun_0.39                     mgcv_1.8-42                   #>  [63] withr_2.5.0                   BiocManager_1.30.20           #>  [65] fastmap_1.1.1                 fansi_1.0.4                   #>  [67] SparseM_1.81                  digest_0.6.31                 #>  [69] rsvd_1.0.5                    R6_2.5.1                      #>  [71] mime_0.12                     textshaping_0.3.6             #>  [73] colorspace_2.1-0              RSQLite_2.3.1                 #>  [75] utf8_1.2.3                    tidyr_1.3.0                   #>  [77] generics_0.1.3                data.table_1.14.8             #>  [79] DECIPHER_2.28.0               httr_1.4.6                    #>  [81] S4Arrays_1.0.4                pkgconfig_2.0.3               #>  [83] gtable_0.3.3                  blob_1.2.4                    #>  [85] mgsub_1.7.3                   htmltools_0.5.5               #>  [87] scales_1.2.1                  png_0.1-8                     #>  [89] knitr_1.42                    tzdb_0.4.0                    #>  [91] reshape2_1.4.4                uuid_1.1-0                    #>  [93] nlme_3.1-162                  curl_5.0.0                    #>  [95] cachem_1.0.8                  safe_3.40.0                   #>  [97] stringr_1.5.0                 BiocVersion_3.17.1            #>  [99] parallel_4.3.0                vipor_0.4.5                   #> [101] desc_1.4.2                    pillar_1.9.0                  #> [103] grid_4.3.0                    vctrs_0.6.2                   #> [105] promises_1.2.0.1              BiocSingular_1.16.0           #> [107] dbplyr_2.3.2                  beachmat_2.16.0               #> [109] xtable_1.8-4                  cluster_2.1.4                 #> [111] beeswarm_0.4.0                Rgraphviz_2.44.0              #> [113] evaluate_0.21                 KEGGgraph_1.60.0              #> [115] locfit_1.5-9.7                cli_3.6.1                     #> [117] taxize_1.0                    compiler_4.3.0                #> [119] rlang_1.1.1                   crayon_1.5.2                  #> [121] plyr_1.8.8                    fs_1.6.2                      #> [123] ggbeeswarm_0.7.2              stringi_1.7.12                #> [125] viridisLite_0.4.2             BiocParallel_1.34.1           #> [127] munsell_0.5.0                 lazyeval_0.2.2                #> [129] Matrix_1.5-4                  ExperimentHub_2.8.0           #> [131] hoardr_0.5.3                  sparseMatrixStats_1.12.0      #> [133] bit64_4.0.5                   taxa_0.4.2                    #> [135] ggplot2_3.4.2                 statmod_1.5.0                 #> [137] KEGGREST_1.40.0               shiny_1.7.4                   #> [139] interactiveDisplayBase_1.38.0 AnnotationHub_3.8.0           #> [141] memoise_2.0.1                 bslib_0.4.2                   #> [143] bit_4.0.5                     ape_5.7-1"},{"path":"/articles/subgingival_plaque.html","id":"bugphyzz-data","dir":"Articles","previous_headings":"","what":"bugphyzz data","title":"MSEA gingival plaque - MicrobiomeBenchmarkData - WMS","text":"","code":"bp <- importBugphyzz() #> Using data downloaded on 2023-05-18 20:50:58. bp <- bp |>    filter(Attribute_group == 'aerophilicity') sp_sigs <- getBugphyzzSignatures(   df = bp, tax.id.type = 'NCBI_ID', tax.level = 'species' )"},{"path":"/articles/subgingival_plaque.html","id":"deseq2-ora-and-gsea","dir":"Articles","previous_headings":"","what":"DESEQ2 + ORA and GSEA","title":"MSEA gingival plaque - MicrobiomeBenchmarkData - WMS","text":"DA: ORA: GSEA:","code":"assay(tse_subset, 'counts_plus_1') <- assay(tse_subset, 'counts') + 1 deseq <- deAna(     expr = tse_subset, de.method = 'DESeq2', padj.method = 'BH',      assay = 'counts_plus_1' ) #> Excluding 54 genes not satisfying min.cpm threshold dim(deseq) #> [1] 135  16 deseq_ora <- sbea(     method = 'ora', se = deseq, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'counts_plus_1' ) gsRanking(res = deseq_ora, signif.only = FALSE) #> DataFrame with 5 rows and 5 columns #>                 GENE.SET  NR.GENES NR.SIG.GENES      PVAL  ADJ.PVAL #>              <character> <numeric>    <numeric> <numeric> <numeric> #> 1  aerophilicity:aerobic        15           13    0.0125   0.06250 #> 2 aerophilicity:obliga..        35           23    0.1730   0.31125 #> 3 aerophilicity:facult..        14           10    0.2090   0.31125 #> 4 aerophilicity:microa..        16           11    0.2490   0.31125 #> 5 aerophilicity:anaero..        49           20    1.0000   1.00000 deseq_gsea <- sbea(     method = 'gsea', se = deseq, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'counts_plus_1' ) #>  #> Attaching package: 'AnnotationDbi' #> The following object is masked from 'package:dplyr': #>  #>     select #>  #> Attaching package: 'XML' #> The following object is masked from 'package:graph': #>  #>     addNode #> No methods found in package 'BiocGenerics' for request: 'unlist' when loading 'npGSEA' gsRanking(res = deseq_gsea, signif.only = FALSE) #> DataFrame with 5 rows and 3 columns #>                 GENE.SET      PVAL  ADJ.PVAL #>              <character> <numeric> <numeric> #> 1  aerophilicity:aerobic   0.00282 0.0141000 #> 2 aerophilicity:facult..   0.00758 0.0189500 #> 3 aerophilicity:microa..   0.02050 0.0341667 #> 4 aerophilicity:anaero..   0.15000 0.1640000 #> 5 aerophilicity:obliga..   0.16400 0.1640000"},{"path":"/articles/subgingival_plaque.html","id":"edger-ora-and-gsea","dir":"Articles","previous_headings":"","what":"edgeR + ORA and GSEA","title":"MSEA gingival plaque - MicrobiomeBenchmarkData - WMS","text":"DA: ORA: GSEA:","code":"edger <- deAna(     expr = tse_subset, de.method = 'edgeR', padj.method = 'BH',      assay = 'counts_plus_1' ) #> Excluding 54 genes not satisfying min.cpm threshold dim(edger) #> [1] 135  16 edger_ora <- sbea(     method = 'ora', se = edger, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'counts_plus_1' ) gsRanking(res = edger_ora, signif.only = FALSE) #> DataFrame with 5 rows and 5 columns #>                 GENE.SET  NR.GENES NR.SIG.GENES      PVAL  ADJ.PVAL #>              <character> <numeric>    <numeric> <numeric> <numeric> #> 1 aerophilicity:anaero..        49            0         1         1 #> 2 aerophilicity:obliga..        35            0         1         1 #> 3 aerophilicity:microa..        16            0         1         1 #> 4  aerophilicity:aerobic        15            0         1         1 #> 5 aerophilicity:facult..        14            0         1         1 edger_gsea <- sbea(     method = 'gsea', se = edger, gs = sp_sigs, alpha = 0.1, perm = 0,     padj.method = 'BH', assay = 'counts_plus_1' ) gsRanking(res = edger_gsea, signif.only = FALSE) #> DataFrame with 5 rows and 3 columns #>                 GENE.SET      PVAL  ADJ.PVAL #>              <character> <numeric> <numeric> #> 1  aerophilicity:aerobic   0.00282 0.0141000 #> 2 aerophilicity:facult..   0.00758 0.0189500 #> 3 aerophilicity:microa..   0.02050 0.0341667 #> 4 aerophilicity:anaero..   0.15000 0.1640000 #> 5 aerophilicity:obliga..   0.16400 0.1640000"},{"path":"/articles/subgingival_plaque.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"MSEA gingival plaque - MicrobiomeBenchmarkData - WMS","text":"","code":"sessioninfo::session_info() #> ─ Session info ─────────────────────────────────────────────────────────────── #>  setting  value #>  version  R version 4.3.0 (2023-04-21) #>  os       Ubuntu 22.04.2 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  en_US.UTF-8 #>  ctype    en_US.UTF-8 #>  tz       Etc/UTC #>  date     2023-05-18 #>  pandoc   2.19.2 @ /usr/local/bin/ (via rmarkdown) #>  #> ─ Packages ─────────────────────────────────────────────────────────────────── #>  package                  * version   date (UTC) lib source #>  annotate                 * 1.78.0    2023-04-25 [1] Bioconductor #>  AnnotationDbi            * 1.62.1    2023-05-02 [1] Bioconductor #>  ape                        5.7-1     2023-03-13 [1] RSPM (R 4.3.0) #>  Biobase                  * 2.60.0    2023-04-25 [1] Bioconductor #>  BiocFileCache              2.8.0     2023-04-25 [1] Bioconductor #>  BiocGenerics             * 0.46.0    2023-04-25 [1] Bioconductor #>  BiocParallel               1.34.1    2023-05-05 [1] Bioconductor #>  Biostrings               * 2.68.1    2023-05-16 [1] Bioconductor #>  bit                        4.0.5     2022-11-15 [1] RSPM (R 4.3.0) #>  bit64                      4.0.5     2020-08-30 [1] RSPM (R 4.3.0) #>  bitops                     1.0-7     2021-04-24 [1] RSPM (R 4.3.0) #>  blob                       1.2.4     2023-03-17 [1] RSPM (R 4.3.0) #>  bold                       1.3.0     2023-05-02 [1] RSPM (R 4.3.0) #>  bslib                      0.4.2     2022-12-16 [1] RSPM (R 4.3.0) #>  bugphyzz                 * 0.0.1.3   2023-05-18 [1] Github (waldronlab/bugphyzz@9c7db81) #>  bugphyzzAnalyses         * 0.1.0     2023-05-18 [1] local #>  cachem                     1.0.8     2023-05-01 [1] RSPM (R 4.3.0) #>  cli                        3.6.1     2023-03-23 [1] RSPM (R 4.3.0) #>  codetools                  0.2-19    2023-02-01 [2] CRAN (R 4.3.0) #>  colorspace                 2.1-0     2023-01-23 [1] RSPM (R 4.3.0) #>  conditionz                 0.1.0     2019-04-24 [1] RSPM (R 4.3.0) #>  crayon                     1.5.2     2022-09-29 [1] RSPM (R 4.3.0) #>  crul                       1.4.0     2023-05-17 [1] RSPM (R 4.3.0) #>  curl                       5.0.0     2023-01-12 [1] RSPM (R 4.3.0) #>  data.table                 1.14.8    2023-02-17 [1] RSPM (R 4.3.0) #>  DBI                        1.1.3     2022-06-18 [1] RSPM (R 4.3.0) #>  dbplyr                     2.3.2     2023-03-21 [1] RSPM (R 4.3.0) #>  DelayedArray               0.26.2    2023-05-05 [1] Bioconductor #>  desc                       1.4.2     2022-09-08 [1] RSPM (R 4.3.0) #>  DESeq2                   * 1.40.1    2023-05-02 [1] Bioconductor #>  digest                     0.6.31    2022-12-11 [1] RSPM (R 4.3.0) #>  dplyr                    * 1.1.2     2023-04-20 [1] RSPM (R 4.3.0) #>  edgeR                      3.42.2    2023-05-02 [1] Bioconductor #>  EnrichmentBrowser        * 2.30.1    2023-05-14 [1] Bioconductor #>  evaluate                   0.21      2023-05-05 [1] RSPM (R 4.3.0) #>  fansi                      1.0.4     2023-01-22 [1] RSPM (R 4.3.0) #>  fastmap                    1.1.1     2023-02-24 [1] RSPM (R 4.3.0) #>  filelock                   1.0.2     2018-10-05 [1] RSPM (R 4.3.0) #>  fs                         1.6.2     2023-04-25 [1] RSPM (R 4.3.0) #>  generics                   0.1.3     2022-07-05 [1] RSPM (R 4.3.0) #>  GenomeInfoDb             * 1.36.0    2023-04-25 [1] Bioconductor #>  GenomeInfoDbData           1.2.10    2023-05-16 [1] Bioconductor #>  GenomicRanges            * 1.52.0    2023-04-25 [1] Bioconductor #>  ggplot2                    3.4.2     2023-04-03 [1] RSPM (R 4.3.0) #>  glue                       1.6.2     2022-02-24 [1] RSPM (R 4.3.0) #>  graph                    * 1.78.0    2023-04-25 [1] Bioconductor #>  GSEABase                 * 1.62.0    2023-04-25 [1] Bioconductor #>  gtable                     0.3.3     2023-03-21 [1] RSPM (R 4.3.0) #>  hoardr                     0.5.3     2023-01-26 [1] RSPM (R 4.3.0) #>  htmltools                  0.5.5     2023-03-23 [1] RSPM (R 4.3.0) #>  httpcode                   0.3.0     2020-04-10 [1] RSPM (R 4.3.0) #>  httr                       1.4.6     2023-05-08 [1] RSPM (R 4.3.0) #>  IRanges                  * 2.34.0    2023-04-25 [1] Bioconductor #>  jquerylib                  0.1.4     2021-04-26 [1] RSPM (R 4.3.0) #>  jsonlite                   1.8.4     2022-12-06 [1] RSPM (R 4.3.0) #>  KEGGgraph                  1.60.0    2023-04-25 [1] Bioconductor #>  KEGGREST                   1.40.0    2023-04-25 [1] Bioconductor #>  knitr                      1.42      2023-01-25 [1] RSPM (R 4.3.0) #>  lattice                    0.21-8    2023-04-05 [2] CRAN (R 4.3.0) #>  lazyeval                   0.2.2     2019-03-15 [1] RSPM (R 4.3.0) #>  lifecycle                  1.0.3     2022-10-07 [1] RSPM (R 4.3.0) #>  limma                      3.56.1    2023-05-07 [1] Bioconductor #>  locfit                     1.5-9.7   2023-01-02 [1] RSPM (R 4.3.0) #>  magrittr                   2.0.3     2022-03-30 [1] RSPM (R 4.3.0) #>  Matrix                     1.5-4     2023-04-04 [2] CRAN (R 4.3.0) #>  MatrixGenerics           * 1.12.0    2023-04-25 [1] Bioconductor #>  matrixStats              * 0.63.0    2022-11-18 [1] RSPM (R 4.3.0) #>  memoise                    2.0.1     2021-11-26 [1] RSPM (R 4.3.0) #>  mgsub                      1.7.3     2021-07-28 [1] RSPM (R 4.3.0) #>  MicrobiomeBenchmarkData  * 1.3.0     2023-05-18 [1] Github (waldronlab/MicrobiomeBenchmarkData@a131a61) #>  munsell                    0.5.0     2018-06-12 [1] RSPM (R 4.3.0) #>  nlme                       3.1-162   2023-01-31 [2] CRAN (R 4.3.0) #>  npGSEA                   * 1.36.0    2023-04-25 [1] Bioconductor #>  pillar                     1.9.0     2023-03-22 [1] RSPM (R 4.3.0) #>  pkgconfig                  2.0.3     2019-09-22 [1] RSPM (R 4.3.0) #>  pkgdown                    2.0.7     2022-12-14 [1] RSPM (R 4.3.0) #>  png                        0.1-8     2022-11-29 [1] RSPM (R 4.3.0) #>  purrr                      1.0.1     2023-01-10 [1] RSPM (R 4.3.0) #>  R6                         2.5.1     2021-08-19 [1] RSPM (R 4.3.0) #>  ragg                       1.2.5     2023-01-12 [1] RSPM (R 4.3.0) #>  rappdirs                   0.3.3     2021-01-31 [1] RSPM (R 4.3.0) #>  Rcpp                       1.0.10    2023-01-22 [1] RSPM (R 4.3.0) #>  RCurl                      1.98-1.12 2023-03-27 [1] RSPM (R 4.3.0) #>  Rgraphviz                  2.44.0    2023-04-25 [1] Bioconductor #>  rlang                      1.1.1     2023-04-28 [1] RSPM (R 4.3.0) #>  rmarkdown                  2.21      2023-03-26 [1] RSPM (R 4.3.0) #>  rprojroot                  2.0.3     2022-04-02 [1] RSPM (R 4.3.0) #>  RSQLite                    2.3.1     2023-04-03 [1] RSPM (R 4.3.0) #>  S4Arrays                   1.0.4     2023-05-14 [1] Bioconductor #>  S4Vectors                * 0.38.1    2023-05-02 [1] Bioconductor #>  safe                       3.40.0    2023-04-25 [1] Bioconductor #>  sass                       0.4.6     2023-05-03 [1] RSPM (R 4.3.0) #>  scales                     1.2.1     2022-08-20 [1] RSPM (R 4.3.0) #>  sessioninfo                1.2.2     2021-12-06 [1] RSPM (R 4.3.0) #>  SingleCellExperiment     * 1.22.0    2023-04-25 [1] Bioconductor #>  SparseM                    1.81      2021-02-18 [1] RSPM (R 4.3.0) #>  statmod                    1.5.0     2023-01-06 [1] RSPM (R 4.3.0) #>  stringi                    1.7.12    2023-01-11 [1] RSPM (R 4.3.0) #>  stringr                    1.5.0     2022-12-02 [1] RSPM (R 4.3.0) #>  SummarizedExperiment     * 1.30.1    2023-05-01 [1] Bioconductor #>  systemfonts                1.0.4     2022-02-11 [1] RSPM (R 4.3.0) #>  taxa                       0.4.2     2022-04-12 [1] RSPM (R 4.3.0) #>  taxize                     1.0       2023-05-18 [1] Github (ropensci/taxize@bcff2a6) #>  taxizedb                   0.3.1     2023-04-03 [1] RSPM (R 4.3.0) #>  textshaping                0.3.6     2021-10-13 [1] RSPM (R 4.3.0) #>  tibble                     3.2.1     2023-03-20 [1] RSPM (R 4.3.0) #>  tidyr                      1.3.0     2023-01-24 [1] RSPM (R 4.3.0) #>  tidyselect                 1.2.0     2022-10-10 [1] RSPM (R 4.3.0) #>  tidytree                   0.4.2     2022-12-18 [1] RSPM (R 4.3.0) #>  treeio                     1.24.0    2023-04-25 [1] Bioconductor #>  TreeSummarizedExperiment * 2.8.0     2023-04-25 [1] Bioconductor #>  tzdb                       0.4.0     2023-05-12 [1] RSPM (R 4.3.0) #>  utf8                       1.2.3     2023-01-31 [1] RSPM (R 4.3.0) #>  uuid                       1.1-0     2022-04-19 [1] RSPM (R 4.3.0) #>  vctrs                      0.6.2     2023-04-19 [1] RSPM (R 4.3.0) #>  vroom                      1.6.3     2023-04-28 [1] RSPM (R 4.3.0) #>  withr                      2.5.0     2022-03-03 [1] RSPM (R 4.3.0) #>  xfun                       0.39      2023-04-20 [1] RSPM (R 4.3.0) #>  XML                      * 3.99-0.14 2023-03-19 [1] RSPM (R 4.3.0) #>  xml2                       1.3.4     2023-04-27 [1] RSPM (R 4.3.0) #>  xtable                     1.8-4     2019-04-21 [1] RSPM (R 4.3.0) #>  XVector                  * 0.40.0    2023-04-25 [1] Bioconductor #>  yaml                       2.3.7     2023-01-23 [1] RSPM (R 4.3.0) #>  yulab.utils                0.0.6     2022-12-20 [1] RSPM (R 4.3.0) #>  zlibbioc                   1.46.0    2023-04-25 [1] Bioconductor #>  #>  [1] /usr/local/lib/R/site-library #>  [2] /usr/local/lib/R/library #>  #> ──────────────────────────────────────────────────────────────────────────────"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Samuel Gamboa. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gamboa S (2023). bugphyzzAnalyses: Analyses performed bugphyzz package. R package version 0.1.0, https://github.com/waldronlab/bugphyzzAnalyses.","code":"@Manual{,   title = {bugphyzzAnalyses: Analyses performed with the bugphyzz package},   author = {Samuel Gamboa},   year = {2023},   note = {R package version 0.1.0},   url = {https://github.com/waldronlab/bugphyzzAnalyses}, }"},{"path":"/index.html","id":"analyses-with-the-bugphyzz-package","dir":"","previous_headings":"","what":"Analyses with the bugphyzz package","title":"Analyses performed with the bugphyzz package","text":"repository contains analyses stats bugphyzz package. package can installed :","code":"if (!'BiocManager' %in% installed.packages()[,'Package'])     install.packages('BiocManager')  BiocManager::install('waldronlab/bugphyzzAnalyses')"},{"path":"/reference/classif2Table.html","id":null,"dir":"Reference","previous_headings":"","what":"Taxize classification to data frame — classif2Table","title":"Taxize classification to data frame — classif2Table","text":"classif2Table converts classification format (`taxize` packatge) data frame.","code":""},{"path":"/reference/classif2Table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Taxize classification to data frame — classif2Table","text":"","code":"classif2Table(x, ranks)"},{"path":"/reference/classif2Table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Taxize classification to data frame — classif2Table","text":"x Output `taxize::classification` function. ranks Ranks selected. Default given `validRanks()`.","code":""},{"path":"/reference/classif2Table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Taxize classification to data frame — classif2Table","text":"data frame.","code":""},{"path":"/reference/createDT.html","id":null,"dir":"Reference","previous_headings":"","what":"Create DataTable — createDT","title":"Create DataTable — createDT","text":"craeteDT creates data table.","code":""},{"path":"/reference/createDT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create DataTable — createDT","text":"","code":"createDT(x)"},{"path":"/reference/createDT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create DataTable — createDT","text":"x data frame.","code":""},{"path":"/reference/createDT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create DataTable — createDT","text":"DataTable output.","code":""},{"path":"/reference/createDT.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create DataTable — createDT","text":"Reference code: https://www.r-bloggers.com/2019/12/vignette-downloadable-tables--rmarkdown---dt-package/ link valid Dec 2, 2022.","code":""},{"path":"/reference/dot-getTaxonClassification.html","id":null,"dir":"Reference","previous_headings":"","what":"Get taxonomy classification — .getTaxonClassification","title":"Get taxonomy classification — .getTaxonClassification","text":".getTaxonClassification Gets taxonomy clasification using `taxize:classification` function first non-NA element input vector taxids.","code":""},{"path":"/reference/dot-getTaxonClassification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get taxonomy classification — .getTaxonClassification","text":"","code":".getTaxonClassification(x)"},{"path":"/reference/dot-getTaxonClassification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get taxonomy classification — .getTaxonClassification","text":"x vector taxonomy names taxids.","code":""},{"path":"/reference/dot-getTaxonClassification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get taxonomy classification — .getTaxonClassification","text":"data frame taxonomic classification (taxize format).","code":""},{"path":"/reference/filterTaxa.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter taxa based on abundance values per sample — filterTaxa","title":"Filter taxa based on abundance values per sample — filterTaxa","text":"filterTaxa filters number taxa per sample based minimum value abundance. functions works phyloseq TreeSummarizedExperiment objects.","code":""},{"path":"/reference/filterTaxa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter taxa based on abundance values per sample — filterTaxa","text":"","code":"filterTaxa(x, min_ab = 1, min_per = 0.2)"},{"path":"/reference/filterTaxa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter taxa based on abundance values per sample — filterTaxa","text":"x phyloseq TreeSummarizedExperiment object otu_table/assay sample_data/colData min_ab minimum value abundance taxon considered present sample. Default 1. default value 1 good counts. Relative abundance data transformations might require another threshold value. min_per minimum percentage samples taxon must present order kept data. Default 0.2. Taxon presence dtermined `min_ab` argument (see ).","code":""},{"path":"/reference/filterTaxa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter taxa based on abundance values per sample — filterTaxa","text":"filtered phyloseq/TreeSummarized object","code":""},{"path":"/reference/getSets.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Sets — getSets","title":"Get Sets — getSets","text":"getSets gets sets signatures.","code":""},{"path":"/reference/getSets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Sets — getSets","text":"","code":"getSets(bsdb, bsdb_body_site, tms, tms_body_site, tax_level)"},{"path":"/reference/getSets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Sets — getSets","text":"bsdb Data imported bsdb. bsdb_body_site Body site bsdb. tms Tidy TypicalMicrobiomeSignatures imported importTypicalTMS tms_body_site Body site tms. tax_level Taxonomic rank","code":""},{"path":"/reference/getSets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Sets — getSets","text":"list bsdb sets background sets (bsdb + tms).","code":""},{"path":"/reference/importTidyTMS.html","id":null,"dir":"Reference","previous_headings":"","what":"Import tidy Typical Microbiome Signatures — importTidyTMS","title":"Import tidy Typical Microbiome Signatures — importTidyTMS","text":"importTidyTMS imports prevalence data TypicalMicrobiomeSignatures project.","code":""},{"path":"/reference/importTidyTMS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Import tidy Typical Microbiome Signatures — importTidyTMS","text":"","code":"importTidyTMS(prevalence_threshold = 0.01)"},{"path":"/reference/importTidyTMS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Import tidy Typical Microbiome Signatures — importTidyTMS","text":"prevalence_threshold numeric value: 0.01.","code":""},{"path":"/reference/importTidyTMS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Import tidy Typical Microbiome Signatures — importTidyTMS","text":"data.frame.","code":""},{"path":"/reference/import_taxids.html","id":null,"dir":"Reference","previous_headings":"","what":"Import taxids — import_taxids","title":"Import taxids — import_taxids","text":"Import taxids","code":""},{"path":"/reference/import_taxids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Import taxids — import_taxids","text":"","code":"import_taxids(x)"},{"path":"/reference/import_taxids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Import taxids — import_taxids","text":"x Name dataset Microbiome BenchmarkData","code":""},{"path":"/reference/import_taxids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Import taxids — import_taxids","text":"data frame.","code":""},{"path":"/reference/microbeSetEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Microbe Set Enrichment — microbeSetEnrichment","title":"Microbe Set Enrichment — microbeSetEnrichment","text":"microbeSetEnrichment runs ORA (Fisher's exact test) comparing set microbes (character vector), reference (character vector), list signatures (list vectors). Furthermore, microbeSetEnrichment adjusts p values (FDR), calculate odd ratios.","code":""},{"path":"/reference/microbeSetEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Microbe Set Enrichment — microbeSetEnrichment","text":"","code":"microbeSetEnrichment(set, reference, sigs)"},{"path":"/reference/microbeSetEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Microbe Set Enrichment — microbeSetEnrichment","text":"set character vector. reference character vector. sigs list character vectors.","code":""},{"path":"/reference/microbeSetEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Microbe Set Enrichment — microbeSetEnrichment","text":"data.frame.","code":""},{"path":"/reference/plotEnrichmentRes.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Enrichment Results — plotEnrichmentRes","title":"Plot Enrichment Results — plotEnrichmentRes","text":"plotEnrichmentRes plots enrichment results.","code":""},{"path":"/reference/plotEnrichmentRes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Enrichment Results — plotEnrichmentRes","text":"","code":"plotEnrichmentRes(res, body_site, tax_level)"},{"path":"/reference/plotEnrichmentRes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Enrichment Results — plotEnrichmentRes","text":"res Output runEnrichment body_site character string title. tax_level character string title.","code":""},{"path":"/reference/plotEnrichmentRes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Enrichment Results — plotEnrichmentRes","text":"ggplot2 object.","code":""},{"path":"/reference/runEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Run enrichment — runEnrichment","title":"Run enrichment — runEnrichment","text":"runEnrichment runs enrichment","code":""},{"path":"/reference/runEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run enrichment — runEnrichment","text":"","code":"runEnrichment(bsdb_sets, background_sets, bp_sigs, bsdb, fdr_ths = NULL)"},{"path":"/reference/runEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run enrichment — runEnrichment","text":"bsdb_sets Vector bsdb sets (named list). background_sets Vector background sets (named list). bp_sigs bugphyzz signatures (named list). bsdb BSDB data.frame. fdr_ths Threshold filtering.","code":""},{"path":"/reference/runEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run enrichment — runEnrichment","text":"data.frame.","code":""},{"path":"/reference/taxTable2taxid.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert taxonomic names to NCBI taxids — taxTable2taxid","title":"Convert taxonomic names to NCBI taxids — taxTable2taxid","text":"taxTable2Taxid converts table taxonomic names table taxids. format must curatedMetagenomicData (rowData) phyloseq (taxa_data).","code":""},{"path":"/reference/taxTable2taxid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert taxonomic names to NCBI taxids — taxTable2taxid","text":"","code":"taxTable2taxid(df, names_from)"},{"path":"/reference/taxTable2taxid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert taxonomic names to NCBI taxids — taxTable2taxid","text":"df data frame. names_from Name column names used rownames.","code":""},{"path":"/reference/taxTable2taxid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert taxonomic names to NCBI taxids — taxTable2taxid","text":"data frame taxIDs instead names.","code":""},{"path":"/reference/taxTable2taxid.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert taxonomic names to NCBI taxids — taxTable2taxid","text":"function always run interactive session ask clarification two taxonomic names belong two different taxids.","code":""},{"path":"/reference/validRanks.html","id":null,"dir":"Reference","previous_headings":"","what":"Valid ranks — validRanks","title":"Valid ranks — validRanks","text":"validRanks get valid ranks.","code":""},{"path":"/reference/validRanks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Valid ranks — validRanks","text":"","code":"validRanks()"},{"path":"/reference/validRanks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Valid ranks — validRanks","text":"character vector.","code":""}]
