<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-throughput ORA with BSDB signatures â€¢ bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="High-throughput ORA with BSDB signatures">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures.html">High-throughput ORA with BSDB meta-signatures</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures_nointersect.html">High-throughput ORA with BSDB meta-signatures (no intersect)</a>
    </li>
    <li>
      <a href="../articles/bsdb_signatures.html">High-throughput ORA with BSDB signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_signatures.html">Odds Ratio - Up vs Down - signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_metasignatures_nointersect.html">Odds Ratio - Up vs Down - metasignatures</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bsdb_signatures_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="bsdb_signatures_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="bsdb_signatures_files/datatables-binding-0.31/datatables.js"></script><link href="bsdb_signatures_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="bsdb_signatures_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="bsdb_signatures_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="bsdb_signatures_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="bsdb_signatures_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="bsdb_signatures_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="bsdb_signatures_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="bsdb_signatures_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="bsdb_signatures_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="bsdb_signatures_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="bsdb_signatures_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="bsdb_signatures_files/selectize-0.12.0/selectize.min.js"></script><link href="bsdb_signatures_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="bsdb_signatures_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>High-throughput ORA with BSDB signatures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/bsdb_signatures.Rmd" class="external-link"><code>vignettes/articles/bsdb_signatures.Rmd</code></a></small>
      <div class="hidden name"><code>bsdb_signatures.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://zenodo.org/records/7622129/files/waldronlab/TypicalMicrobiomeSignaturesExports-v1.0.1.zip?download=1"</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"tms.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url</span>, destfile <span class="op">=</span> <span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">temp_file</span>, exdir <span class="op">=</span> <span class="va">temp_dir</span>, junkpaths <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_dir</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">csv_files</span>,  <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>            names_to <span class="op">=</span> <span class="st">"Body site"</span>, values_to <span class="op">=</span> <span class="st">"Prevalence"</span>,</span>
<span>            cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>            `Body site` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_(species|genus)_prevalence$"</span>, <span class="st">""</span>, <span class="va">`Body site`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*matrix_(.*).csv$"</span>, <span class="st">"\\1"</span>, <span class="va">csv_files</span><span class="op">)</span></span>
<span><span class="va">tms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">l</span>, .id <span class="op">=</span> <span class="st">"rank_agegroup"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"rank_agegroup"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rank"</span>, <span class="st">"Age group"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span></span>
<span>        <span class="va">`Age group`</span>, <span class="va">`Rank`</span>, `NCBI ID` <span class="op">=</span> <span class="va">NCBI</span>, `Taxon name` <span class="op">=</span> <span class="va">name</span>,</span>
<span>        <span class="va">`Body site`</span>, <span class="va">Prevalence</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Age group`</span> <span class="op">==</span> <span class="st">"adult"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `Body site` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"stool"</span> <span class="op">~</span> <span class="st">"feces"</span>,</span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"oralcavity"</span> <span class="op">~</span> <span class="st">"mouth"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Body site`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Prevalence</span> <span class="op">&gt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tms</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 6</span></span></span>
<span><span class="co">#&gt;   `Age group` Rank  `NCBI ID` `Taxon name`    `Body site` Prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium   skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium   vagina          0.063<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium   mouth           0.302 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus  skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus  vagina          0.063<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> adult       genus      <span style="text-decoration: underline;">1</span>716 Corynebacterium skin            0.835</span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## "10.5281/zenodo.10407666" v1.2.0</span></span>
<span><span class="co">## "10.5281/zenodo.6468009" v1.1.0</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"10.5281/zenodo.10407666"</span>, cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(grepl("(healthy|control)", `Group 0 name`, ignore.case = TRUE)) |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Study design`</span> <span class="op">==</span> <span class="st">"case-control"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1416   50</span></span></code></pre></div>
<p>BugSigDB subsets by body site:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uberon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getOntology.html" class="external-link">getOntology</a></span><span class="op">(</span>onto <span class="op">=</span> <span class="st">"uberon"</span><span class="op">)</span></span>
<span><span class="va">body_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tms</span><span class="op">$</span><span class="va">`Body site`</span><span class="op">)</span></span>
<span><span class="va">bsdb_subsets_by_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">body_sites</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"skin"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">`Body site`</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/subsetByOntology.html" class="external-link">subsetByOntology</a></span><span class="op">(</span></span>
<span>            <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Body site"</span>, term <span class="op">=</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ontology <span class="op">=</span> <span class="va">uberon</span> </span>
<span>        <span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bugphyzz:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="signatures">Signatures<a class="anchor" aria-label="anchor" href="#signatures"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genus"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="va">tms_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">tms_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tms</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Body site`</span> <span class="op">==</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">Rank</span> <span class="op">==</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`NCBI ID`</span><span class="op">)</span></span>
<span>        <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>BugSigDB signatures:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"increased"</span>, <span class="st">"decreased"</span><span class="op">)</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span></span>
<span>    mode <span class="op">=</span> <span class="st">"list"</span>, </span>
<span>    length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">myDF</span> <span class="op">&lt;-</span> <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span> <span class="op">==</span> <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getSignatures.html" class="external-link">getSignatures</a></span><span class="op">(</span></span>
<span>                df <span class="op">=</span> <span class="va">myDF</span>,</span>
<span>                tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>, tax.level <span class="op">=</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span>, min.size <span class="op">=</span> <span class="fl">5</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span>            </span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>                <span class="kw">next</span></span>
<span>            <span class="op">}</span></span>
<span>            <span class="va">bsdb_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span></span>
<span>                pattern <span class="op">=</span> <span class="st">"^(bsdb:[0-9]+/[0-9]+/[0-9]+)_.*$"</span>,</span>
<span>                replacement <span class="op">=</span> <span class="st">"\\1"</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">myDF</span><span class="op">$</span><span class="va">`BSDB ID`</span>, <span class="va">bsdb_id</span><span class="op">)</span></span>
<span>            <span class="va">pos</span> <span class="op">&lt;-</span> <span class="va">pos</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span><span class="op">]</span></span>
<span>            <span class="va">new_sigs_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>                <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"---"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"---"</span>, <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, <span class="st">"---"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">$</span><span class="va">Condition</span><span class="op">[</span><span class="va">pos</span><span class="op">]</span><span class="op">)</span>, <span class="st">"---"</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">new_sigs_names</span></span>
<span>            <span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sigs</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">bsdb_sigs</span>, <span class="va">is.null</span><span class="op">)</span></span></code></pre></div>
<p>Reference signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">background_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sig_name</span></span>
<span>    <span class="va">bodysite_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)---(species|genus)---.*$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">rank_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)---(species|genus)---.*$"</span>, <span class="st">"\\2"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">tms_sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">bodysite_name</span>, <span class="st">"_"</span>, <span class="va">rank_name</span><span class="op">)</span></span>
<span>    <span class="va">background_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">[[</span><span class="va">tms_sig_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>bugphyzz signatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span>, <span class="st">"|genus"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span>, <span class="st">"|species"</span><span class="op">)</span></span>
<span><span class="va">bp_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span>, <span class="va">bp_sigs_sp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enrichment">Enrichment<a class="anchor" aria-label="anchor" href="#enrichment"></a>
</h2>
<p>genus:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"---genus---"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span>, <span class="va">background_sigs_gn</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="va">en_gn_df</span> <span class="op">&lt;-</span> <span class="va">en_gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span>, <span class="st">"bsdb_sig"</span></span>
<span>        <span class="op">)</span>, sep <span class="op">=</span> <span class="st">"---"</span>, remove <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># myDataTable(en_gn_df, nrow(en_gn_df))</span></span></code></pre></div>
<p>species:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"---species---"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span>, <span class="va">background_sigs_sp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">en_sp_df</span> <span class="op">&lt;-</span> <span class="va">en_sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co">## Let's re calculate FRR (not just the output of microheSEtEnrichment)</span></span>
<span>    <span class="co"># mutate(fdr = p.adjust(p_value, method = "fdr")) |&gt;</span></span>
<span>    <span class="co"># filter(fdr &lt; 0.1) |&gt; </span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span>, <span class="st">"bsdb_sig"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"---"</span>,</span>
<span>        remove <span class="op">=</span>  <span class="cn">TRUE</span> </span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># myDataTable(en_sp_df, page_len = nrow(en_sp_df))</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># en_df &lt;- bind_rows(en_gn_df, en_sp_df) |&gt;</span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         fdr = p.adjust(p_value, method = "fdr")</span></span>
<span><span class="co">#     )</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">en_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">en_sp_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># group_by(rank) |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`BSDB ID` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(bsdb:[0-9]+/[0-9]+/[0-9]+)_.*"</span>, <span class="st">"\\1"</span>, <span class="va">bsdb_sig</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        fdr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p_value</span>, method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># ungroup() |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">bsdb</span>, <span class="va">`BSDB ID`</span>, control <span class="op">=</span> <span class="va">`Group 0 name`</span>, treatment <span class="op">=</span> <span class="va">`Group 1 name`</span><span class="op">)</span>,</span>
<span>        by <span class="op">=</span> <span class="st">"BSDB ID"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span>,</span>
<span>        Category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span>, <span class="st">"other"</span>, <span class="va">Category</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">`BSDB ID`</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">control</span>, .after <span class="op">=</span> <span class="st">"condition"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">treatment</span>, .after <span class="op">=</span> <span class="st">"control"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">bsdb_sig</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">en_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"increased"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">en_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"decreased"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="table-up">Table up<a class="anchor" aria-label="anchor" href="#table-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_up</span><span class="op">$</span><span class="va">bsdb_sig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 31</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_up</span><span class="op">$</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 35</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">en_up</span>, <span class="va">Category</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Category  n</span></span>
<span><span class="co">#&gt; 1 anatomical system disease  9</span></span>
<span><span class="co">#&gt; 2                    cancer 57</span></span>
<span><span class="co">#&gt; 3            mental disease 24</span></span>
<span><span class="co">#&gt; 4         metabolic disease  7</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_up</span>, page_len <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-966ef407f8a7d99e9db4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-966ef407f8a7d99e9db4">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"121\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"197\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"139\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"50\" data-max=\"256\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.36\" data-max=\"378.31\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.51\" data-max=\"22.86\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.55\" data-max=\"9119.34\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["bsdb:749/2/1","bsdb:41/1/1","bsdb:87/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:215/1/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:384/2/1","bsdb:384/3/1","bsdb:481/3/1","bsdb:492/2/2","bsdb:518/1/1","bsdb:588/1/1","bsdb:604/1/1","bsdb:604/2/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:244/5/1","bsdb:244/5/1","bsdb:244/5/1","bsdb:284/2/1","bsdb:530/1/1","bsdb:530/1/1","bsdb:530/2/1","bsdb:530/2/1","bsdb:530/2/1","bsdb:530/2/1","bsdb:530/3/1","bsdb:530/3/1","bsdb:749/1/1","bsdb:749/2/1","bsdb:749/2/1","bsdb:41/1/1","bsdb:41/1/1","bsdb:41/1/1","bsdb:99/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:151/1/1","bsdb:245/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/1/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:296/2/1","bsdb:428/2/1","bsdb:428/3/1","bsdb:481/3/1","bsdb:481/3/1","bsdb:481/3/1","bsdb:541/2/1","bsdb:541/2/1","bsdb:630/1/1","bsdb:630/2/1","bsdb:746/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:768/1/1","bsdb:834/1/1"],["mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","skin","skin","skin","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased","increased"],["chronic obstructive pulmonary disease","head and neck squamous cell carcinoma","chronic obstructive pulmonary disease","cervical glandular intraepithelial neoplasia","cervical glandular intraepithelial neoplasia","cervical glandular intraepithelial neoplasia","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","obesity","obesity","extrahepatic cholestasis","behcet's syndrome","obesity","obesity","colorectal cancer","colorectal cancer","autism","autism","autism","autism","autism","autism","autism","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","head and neck squamous cell carcinoma","colorectal cancer","colorectal cancer","hyperplastic polyp","hyperplastic polyp","hyperplastic polyp","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","head and neck squamous cell carcinoma","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","chronic obstructive pulmonary disease","autism","type ii diabetes mellitus","type ii diabetes mellitus","type ii diabetes mellitus","breast carcinoma","breast carcinoma","alzheimer's disease","chronic fatigue syndrome","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","unipolar depression","chronic fatigue syndrome"],["Controls children with mixed dentition (PD)","Controls","maturity-onset diabetes of the young 2 (MODY2) and healthy Controls","controls","controls","controls","healthy control infants","healthy controls","healthy controls","healthy controls","FSCZ","Mild COVID-19 patients","Healthy controls","Healthy controls","healthy subjects","Healthy controls free of neurological disease","Healthy control free of neurological disease.","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","non-lesional skin in young children","non-lesional skin in young children","non-lesional skin in young children","healthy controls","Never-Smokers","Never-Smokers","Never-Smokers","Never-Smokers","Never-Smokers","Never-Smokers","Former-Smokers","Former-Smokers","Controls children with primary dentition (PD)","Controls children with mixed dentition (PD)","Controls children with mixed dentition (PD)","Controls","Controls","Controls","controls","controls","controls","controls","controls","controls","controls","controls","controls","controls","controls","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy control","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","Healthy controls","Healthy controls","Mild COVID-19 patients","Mild COVID-19 patients","Mild COVID-19 patients","Healthy controls","Healthy controls","healthy control (normal and a few polyps)","healthy control (normal and a few polyps)","Healthy controls.","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","proficient DNA mismatch repair (pMMR) CRC","Healthy controls"],["Down Syndrome children with mixed dentition (PD)","FIrst episode Psychosis","Type I Diabetics","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","infants with eczema","multiple myeloma patients","multiple myeloma patients","TSCZ","TSCZ","Severe COVID-19 patients","Individuals diagnosed with Type 2 Diabetes and clinically manifest Diabetic Retinopathy (DR)","Stage 3/4 endometriosis patients","colorectal cancer patients","Participants with Parkinson's Disease","Participants with Parkinson's Disease","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","lesional skin in young children","lesional skin in young children","lesional skin in young children","Chronic kidney disease","Current-Smokers","Current-Smokers","Former-Smokers","Former-Smokers","Former-Smokers","Former-Smokers","Current-Smokers","Current-Smokers","Down Syndrome children with primary dentition (PD)","Down Syndrome children with mixed dentition (PD)","Down Syndrome children with mixed dentition (PD)","FIrst episode Psychosis","FIrst episode Psychosis","FIrst episode Psychosis","obese","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","Postmenopausal breast cancer patients","kidney stone group","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","multiple myeloma patients","Recovered COVID-19 cases","Recovered COVID-19 cases","Severe COVID-19 patients","Severe COVID-19 patients","Severe COVID-19 patients","Schizophrenic patients (ARSCZ, FESCZ)","Schizophrenic patients (ARSCZ, FESCZ)","stage I/II (SI/II)","stage III/IV (SIII/IV)","Parkinson's Disease subjects.","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","deficient DNA mismatch repair (dMMR) CRC","Non-segmental Vitiligo patients"],["aerophilicity|aerobic","aerophilicity|aerobic","habitat|waste and sludge water","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","motility|TRUE","gram stain|gram stain negative","aerophilicity|facultatively anaerobic","plant pathogenicity|TRUE","aerophilicity|facultatively anaerobic","aerophilicity|facultatively anaerobic","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","habitat|human urine","aerophilicity|aerobic","habitat|human urine","habitat|human urine","aerophilicity|aerobic","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain negative","animal pathogen|FALSE","host-associated|FALSE","motility|TRUE","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","aerophilicity|facultatively anaerobic","arrangement|paired cells","shape|coccus","arrangement|cell chain","cogem pathogenicity rating|cogem pathogenicity rating 1","antimicrobial sensitivity|FALSE","aerophilicity|facultatively anaerobic","arrangement|cell chain","cogem pathogenicity rating|cogem pathogenicity rating 1","antimicrobial sensitivity|FALSE","cogem pathogenicity rating|cogem pathogenicity rating 1","antimicrobial sensitivity|FALSE","aerophilicity|aerobic","aerophilicity|aerobic","hemolysis|beta","aerophilicity|aerobic","habitat|free-living","extreme environment|TRUE","biofilm formation|FALSE","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","shape|bacillus","biofilm formation|TRUE","motility|TRUE","spore formation|FALSE","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","mutation rate per site per generation|slow| &gt; 0.78 &amp; &lt;= 2.92","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|cell chain","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","habitat|oral","hemolysis|beta","shape|coccus","host-associated|TRUE","plant pathogenicity|TRUE","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","hemolysis|beta","shape|coccus","plant pathogenicity|TRUE","habitat|feces","habitat|feces","aerophilicity|aerobic","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","aerophilicity|facultatively anaerobic","arrangement|cell chain","cogem pathogenicity rating|cogem pathogenicity rating 2","plant pathogenicity|FALSE","arrangement|cell chain","aerophilicity|aerobic","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain negative","habitat|free-living","habitat|plant matter","habitat|sediment","animal pathogen|FALSE","antimicrobial sensitivity|FALSE","host-associated|FALSE","motility|TRUE","coding genes|very large| &gt; 6000 &amp; &lt;= 14018","genome size|very large| &gt; 6997434 &amp; &lt;= 16040666","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","habitat|waste and sludge water"],[7,12,6,10,17,12,18,4,3,5,5,7,10,4,6,3,3,81,71,108,82,99,73,35,7,7,8,7,5,7,6,7,5,7,5,7,5,11,7,7,6,7,5,12,15,18,21,23,21,10,10,19,10,2,12,14,9,15,14,20,6,9,8,24,4,9,11,11,10,10,5,5,3,10,7,12,11,14,9,9,10,15,14,93,68,121,47,12,12,82,38,82,65,19,15,26,9],[2,4,1,10,3,8,7,1,2,1,2,6,1,10,5,2,3,55,65,28,54,37,63,101,2,2,1,2,11,9,6,5,7,5,11,9,0,3,7,12,13,12,6,14,11,8,5,3,5,16,16,7,16,3,13,11,16,10,11,5,19,16,17,1,21,2,0,0,1,1,6,6,8,1,0,5,6,3,21,21,0,1,41,116,141,88,162,197,197,127,171,127,144,190,194,183,19],[5,5,17,7,35,17,29,7,0,6,6,5,35,0,5,1,1,6,19,35,33,23,19,0,25,27,50,19,7,14,21,22,7,14,7,14,43,38,18,13,2,11,7,12,19,41,96,71,105,17,15,85,26,0,8,13,13,18,33,88,6,9,11,139,0,9,14,20,35,93,11,13,0,71,73,11,39,96,16,14,96,128,15,12,23,72,2,0,0,54,19,15,16,0,1,2,14],[50,100,87,93,65,83,61,99,106,98,97,95,66,97,101,104,103,88,75,59,61,71,75,94,192,190,167,222,233,226,222,221,236,229,234,227,198,195,215,243,254,245,242,243,236,214,159,184,150,238,240,170,229,256,237,232,232,227,212,157,239,236,234,106,245,243,238,232,217,159,241,239,252,178,178,244,216,159,222,224,160,126,214,239,228,179,249,251,251,197,232,236,235,251,250,249,221],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[35,60,30.71,13.29,10.52,7.32,5.41,56.57,298.2,81.67,40.42,22.17,18.86,83.56999999999999,24.24,156,103,21.6,4.31,6.5,2.81,8.26,4.57,66.09999999999999,26.88,24.63,26.72,40.89,15.13,12.56,10.57,14.06,24.08,22.9,15.19,12.61,50.2,18.82,11.94,10.9,58.62,12.99,28.81,17.36,16.94,11.74,6.96,19.87,6,8.75,10,5.43,5.5,366.43,27.35,22.71,10.04,18.92,8.18,7.14,12.58,14.75,10.01,18.3,102.77,121.5,378.31,260.85,62,17.1,18.26,15.32,207.94,25.07,36.43,53.24,10.15,7.73,5.95,6.86,34.93,14.77,4.87,15.97,4.78,3.42,36.12,31.84,31.84,2.36,2.71,10.16,6.63,51.49,19.33,17.69,7.48],[5.67,14.15,3.47,4.14,2.88,2.6,2.03,5.55,11.94,8.19,6.45,5.39,2.32,4.2,5.47,10.9,8.140000000000001,8.83,2.35,3.61,1.63,4.52,2.5,4,5.29,4.86,3.26,7.93,4.13,4.07,3.13,4.12,6.11,6.44,4.15,4.09,2.72,5.01,3.77,3.68,10.77,4.28,7.07,6.62,6.83,4.79,2.54,5.78,2.19,3.45,3.88,2.2,2.26,14.72,9.529999999999999,8.630000000000001,3.73,7.44,3.42,2.59,3.7,5.14,3.56,2.44,5.35,22.86,21.22,14.83,7.7,2.15,4.82,4.13,9.94,3.15,2.05,15.95,3.55,2.17,2.34,2.65,2.02,1.92,2.19,8.41,2.85,2.32,8.65,1.87,1.87,1.56,1.51,5.62,3.69,3.09,2.53,4.15,2.86],[216.15,254.44,271.6,42.61,38.4,20.63,14.39,576.52,7445.7,814.42,253.33,91.09999999999999,153.39,1662.36,107.37,2231.9,1302.96,52.87,7.9,11.72,4.84,15.1,8.380000000000001,1092.81,136.62,124.75,218.8,210.78,55.36,38.7,35.69,48.04,94.95,81.39,55.6,38.87,924.74,70.65000000000001,37.83,32.31,319.12,39.45,117.38,45.54,41.98,28.81,19.05,68.23999999999999,16.42,22.19,25.77,13.42,13.38,9119.34,78.5,59.75,27,48.09,19.53,19.67,42.79,42.3,28.19,137.46,1972.93,645.6799999999999,6743.53,4587.84,499.46,135.69,69.16,56.87,4351.37,199.47,646.08,177.74,29.06,27.59,15.09,17.72,602.76,113.46,10.86,30.31,8.02,5.04,150.76,541,541,3.55,4.87,18.35,11.9,858.15,147.61,75.47,19.52],["","","","","","","","","*","","","","","*","","","","","","","","","","*","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","*","","","","","","","","","","","*","","*","*","","","","","*","","*","","","","","","*","","","","","","","*","*","","","","","*","","",""],["anatomical system disease","cancer","anatomical system disease","cancer","cancer","cancer","anatomical system disease","anatomical system disease","anatomical system disease","metabolic disease","metabolic disease","anatomical system disease","mental disease","metabolic disease","metabolic disease","cancer","cancer","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","anatomical system disease","mental disease","metabolic disease","metabolic disease","metabolic disease","cancer","cancer","mental disease","anatomical system disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","anatomical system disease"],["bsdb:749/2/1_Down-syndrome:Down-Syndrome-children-with-mixed-dentition-(PD)_vs_Controls-children-with-mixed-dentition-(PD)_UP","bsdb:41/1/1_psychosis:FIrst-episode-Psychosis_vs_Controls_UP","bsdb:87/1/1_type-I-diabetes-mellitus:Type-I-Diabetics_vs_maturity-onset-diabetes-of-the-young-2-(MODY2)-and-healthy-Controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:215/1/1_Eczema:infants-with-eczema_vs_healthy-control-infants_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:384/2/1_schizophrenia:TSCZ_vs_healthy-controls_UP","bsdb:384/3/1_schizophrenia:TSCZ_vs_FSCZ_UP","bsdb:481/3/1_COVID-19:Severe-COVID-19-patients_vs_Mild-COVID-19-patients_UP","bsdb:492/2/2_diabetic-retinopathy:Individuals-diagnosed-with-Type-2-Diabetes-and-clinically-manifest-Diabetic-Retinopathy-(DR)_vs_Healthy-controls_UP","bsdb:518/1/1_endometriosis:Stage-3/4-endometriosis-patients_vs_Healthy-controls_UP","bsdb:588/1/1_colorectal-cancer:colorectal-cancer-patients_vs_healthy-subjects_UP","bsdb:604/1/1_Parkinson's-disease:Participants-with-Parkinson's-Disease_vs_Healthy-controls-free-of-neurological-disease_UP","bsdb:604/2/1_Parkinson's-disease:Participants-with-Parkinson's-Disease_vs_Healthy-control-free-of-neurological-disease._UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:244/5/1_atopic-eczema:lesional-skin-in-young-children_vs_non-lesional-skin-in-young-children_UP","bsdb:244/5/1_atopic-eczema:lesional-skin-in-young-children_vs_non-lesional-skin-in-young-children_UP","bsdb:244/5/1_atopic-eczema:lesional-skin-in-young-children_vs_non-lesional-skin-in-young-children_UP","bsdb:284/2/1_chronic-kidney-disease:Chronic-kidney-disease_vs_healthy-controls_UP","bsdb:530/1/1_Smoking-status-measurement:Current-Smokers_vs_Never-Smokers_UP","bsdb:530/1/1_Smoking-status-measurement:Current-Smokers_vs_Never-Smokers_UP","bsdb:530/2/1_Smoking-status-measurement:Former-Smokers_vs_Never-Smokers_UP","bsdb:530/2/1_Smoking-status-measurement:Former-Smokers_vs_Never-Smokers_UP","bsdb:530/2/1_Smoking-status-measurement:Former-Smokers_vs_Never-Smokers_UP","bsdb:530/2/1_Smoking-status-measurement:Former-Smokers_vs_Never-Smokers_UP","bsdb:530/3/1_Smoking-status-measurement:Current-Smokers_vs_Former-Smokers_UP","bsdb:530/3/1_Smoking-status-measurement:Current-Smokers_vs_Former-Smokers_UP","bsdb:749/1/1_Down-syndrome:Down-Syndrome-children-with-primary-dentition-(PD)_vs_Controls-children-with-primary-dentition-(PD)_UP","bsdb:749/2/1_Down-syndrome:Down-Syndrome-children-with-mixed-dentition-(PD)_vs_Controls-children-with-mixed-dentition-(PD)_UP","bsdb:749/2/1_Down-syndrome:Down-Syndrome-children-with-mixed-dentition-(PD)_vs_Controls-children-with-mixed-dentition-(PD)_UP","bsdb:41/1/1_psychosis:FIrst-episode-Psychosis_vs_Controls_UP","bsdb:41/1/1_psychosis:FIrst-episode-Psychosis_vs_Controls_UP","bsdb:41/1/1_psychosis:FIrst-episode-Psychosis_vs_Controls_UP","bsdb:99/1/1_obesity:obese_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:151/1/1_breast-cancer:Postmenopausal-breast-cancer-patients_vs_controls_UP","bsdb:245/1/1_nephrolithiasis,urolithiasis:kidney-stone-group_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/1/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-control_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:296/2/1_multiple-myeloma:multiple-myeloma-patients_vs_healthy-controls_UP","bsdb:428/2/1_COVID-19:Recovered-COVID-19-cases_vs_Healthy-controls_UP","bsdb:428/3/1_COVID-19:Recovered-COVID-19-cases_vs_Healthy-controls_UP","bsdb:481/3/1_COVID-19:Severe-COVID-19-patients_vs_Mild-COVID-19-patients_UP","bsdb:481/3/1_COVID-19:Severe-COVID-19-patients_vs_Mild-COVID-19-patients_UP","bsdb:481/3/1_COVID-19:Severe-COVID-19-patients_vs_Mild-COVID-19-patients_UP","bsdb:541/2/1_schizophrenia:Schizophrenic-patients-(ARSCZ,-FESCZ)_vs_Healthy-controls_UP","bsdb:541/2/1_schizophrenia:Schizophrenic-patients-(ARSCZ,-FESCZ)_vs_Healthy-controls_UP","bsdb:630/1/1_colorectal-cancer:stage-I/II-(SI/II)_vs_healthy-control-(normal-and-a-few-polyps)_UP","bsdb:630/2/1_colorectal-cancer:stage-III/IV-(SIII/IV)_vs_healthy-control-(normal-and-a-few-polyps)_UP","bsdb:746/1/1_Parkinson's-disease:Parkinson's-Disease-subjects._vs_Healthy-controls._UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:768/1/1_Mismatch-repair-cancer-syndrome:deficient-DNA-mismatch-repair-(dMMR)-CRC_vs_proficient-DNA-mismatch-repair-(pMMR)-CRC_UP","bsdb:834/1/1_Vitiligo:Non-segmental-Vitiligo-patients_vs_Healthy-controls_UP"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>BSDB ID<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>control<\/th>\n      <th>treatment<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n      <th>Category<\/th>\n      <th>bsdb_sig<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[8,9,10,11,12,13,14,15,16]},{"name":"BSDB ID","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"control","targets":5},{"name":"treatment","targets":6},{"name":"sig_name","targets":7},{"name":"inBSDB_annotated","targets":8},{"name":"inBSDB_noAnnotated","targets":9},{"name":"notInBSDB_annotated","targets":10},{"name":"notInBSDB_noAnnotated","targets":11},{"name":"p_value","targets":12},{"name":"fdr","targets":13},{"name":"odds_ratio","targets":14},{"name":"lower_ci","targets":15},{"name":"upper_ci","targets":16},{"name":"HA","targets":17},{"name":"Category","targets":18},{"name":"bsdb_sig","targets":19}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="heatmap-up">Heatmap UP<a class="anchor" aria-label="anchor" href="#heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">en_tbl</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">body_site</span>, <span class="va">rank</span>, <span class="va">direction</span>, <span class="va">condition</span>, <span class="va">Category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dat_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"increased"</span><span class="op">)</span></span>
<span><span class="va">dat_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"decreased"</span><span class="op">)</span></span></code></pre></div>
<p>Data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_group) by genus</span></span>
<span><span class="va">summary_up_freq</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_up</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span>,<span class="va">summary_category_up</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_up</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span>,<span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span></span>
<span>            n <span class="op">=</span> <span class="va">x</span></span>
<span>            <span class="co"># n = x, begin = 0, option = "C", direction = -1</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_up</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rank_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">'gray50'</span>, species <span class="op">=</span> <span class="st">'gray80'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_anno_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_up_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_up</span> <span class="op">&lt;-</span> <span class="va">ht1_up</span> <span class="op">+</span> <span class="va">ht2_up</span> <span class="op">+</span> <span class="va">row_anno_up</span></span>
<span><span class="va">lgd_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rank_col</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Rank"</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_up</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb_signatures_files/figure-html/unnamed-chunk-19-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="table-down">Table Down<a class="anchor" aria-label="anchor" href="#table-down"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_down</span><span class="op">$</span><span class="va">bsdb_sig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_down</span><span class="op">$</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 25</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">en_down</span>, <span class="va">Category</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Category  n</span></span>
<span><span class="co">#&gt; 1 anatomical system disease 21</span></span>
<span><span class="co">#&gt; 2                    cancer 21</span></span>
<span><span class="co">#&gt; 3            mental disease  4</span></span>
<span><span class="co">#&gt; 4         metabolic disease  2</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_down</span>, page_len <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-4fa1010b098c1714d426" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4fa1010b098c1714d426">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"38\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"24\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"154\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"46\" data-max=\"256\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4.58\" data-max=\"362.14\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.81\" data-max=\"17.96\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"10.16\" data-max=\"9012.93\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["bsdb:530/1/2","bsdb:530/2/2","bsdb:530/3/2","bsdb:30/1/2","bsdb:74/1/2","bsdb:74/3/2","bsdb:158/1/2","bsdb:208/2/2","bsdb:226/2/2","bsdb:227/4/2","bsdb:605/2/2","bsdb:735/3/2","bsdb:774/2/1","bsdb:754/1/2","bsdb:31/1/2","bsdb:31/1/2","bsdb:31/2/2","bsdb:41/1/2","bsdb:41/1/2","bsdb:74/1/2","bsdb:74/1/2","bsdb:74/1/2","bsdb:74/1/2","bsdb:74/1/2","bsdb:74/3/2","bsdb:74/3/2","bsdb:74/3/2","bsdb:99/1/2","bsdb:99/1/2","bsdb:271/1/2","bsdb:271/1/2","bsdb:428/1/2","bsdb:428/1/2","bsdb:428/1/2","bsdb:428/3/2","bsdb:428/4/1","bsdb:481/2/2","bsdb:483/2/1","bsdb:483/2/1","bsdb:547/1/2","bsdb:790/1/1","bsdb:790/1/1","bsdb:790/1/1","bsdb:790/1/1","bsdb:790/1/1","bsdb:790/1/1","bsdb:790/3/1","bsdb:790/6/1"],["mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased","decreased"],["hepatitis","hepatitis","chronic obstructive pulmonary disease","colorectal adenoma","hepatitis","chronic obstructive pulmonary disease","non-alcoholic fatty liver disease","chronic fatigue syndrome","unipolar depression","chronic fatigue syndrome","obesity","periodontitis","periodontitis","colorectal cancer","colorectal adenoma","colorectal adenoma","colorectal adenoma","hyperplastic polyp","hyperplastic polyp","colon sessile serrated adenoma/polyp","colon sessile serrated adenoma/polyp","colon sessile serrated adenoma/polyp","colon sessile serrated adenoma/polyp","colon sessile serrated adenoma/polyp","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal adenoma","colorectal cancer","colorectal cancer","autism","autism","autism","type ii diabetes mellitus","breast carcinoma","cervical glandular intraepithelial neoplasia","halitosis","halitosis","non-alcoholic fatty liver disease","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome"],["Never-Smokers","Never-Smokers","Former-Smokers","Belgian controls","non-obese","low BMI","healthy volunteers","healthy controls","HAART-naive HIV-1 patients","healthy controls","Participants with Parkinson's Disease with non-tremor subtypes","Healthy control","Non-IBS2 (Non-irritable bowel syndrome 2)","Non-smokers","controls","controls","controls","Controls","Controls","non-obese","non-obese","non-obese","non-obese","non-obese","low BMI","low BMI","low BMI","controls","controls","Minimal Residual Disease+ (positivity) with Allogenic Stem Cell Transplant","Minimal Residual Disease+ (positivity) with Allogenic Stem Cell Transplant","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Antibiotic-naive COVID-19 patients","Antibiotic-naive COVID-19 patients, pneumonia patients, uninfected controls","Antibiotic-naive COVID-19 patients, pneumonia patients, uninfected controls","Healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","healthy controls","non-inflammatory bowel disease symptomatic controls","Inflammatory bowel disease patients with fecal calprotectin levels &lt; 1000 mg/kg"],["Current-Smokers","Former-Smokers","Current-Smokers","Norweigan controls","obese","high BMI","lung cancer patients","infants with food allergies","HAART-treated HIV-1 patients","infants with persistent atopic dermatitis","Participants with Parkinson's Disease with tremor subtypes","Crohn's disease","IBS-D (IBS-Diarrhea)","Smokers","CFS/ME patients","CFS/ME patients","CFS/ME patients with IBS","FIrst episode Psychosis","FIrst episode Psychosis","obese","obese","obese","obese","obese","high BMI","high BMI","high BMI","obese","obese","Minimal Residual Disease- (negativity) with Allogenic Stem Cell Transplant","Minimal Residual Disease- (negativity) with Allogenic Stem Cell Transplant","COVID-19 cases","COVID-19 cases","COVID-19 cases","Recovered COVID-19 cases","COVID-19 patients treated with antibiotics","Antibiotic-treated COVID-19 patients","Antibiotic-treated COVID-19 patients","Antibiotic-treated COVID-19 patients","Recovered COVID-19 patients","inflammatory bowel disease patients","inflammatory bowel disease patients","inflammatory bowel disease patients","inflammatory bowel disease patients","inflammatory bowel disease patients","inflammatory bowel disease patients","inflammatory bowel disease patients","Inflammatory bowel disease patients with fecal calprotectin levels &gt; 1000 mg/kg"],["aerophilicity|facultatively anaerobic","aerophilicity|facultatively anaerobic","aerophilicity|facultatively anaerobic","sphingolipid producing|TRUE","gram stain|gram stain negative","gram stain|gram stain negative","length|small| &gt; 0.19 &amp; &lt;= 3.8","aerophilicity|aerobic","gram stain|gram stain negative","plant pathogenicity|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","aerophilicity|aerobic","gram stain|gram stain negative","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|human gut microbiome","biofilm formation|FALSE","habitat|human gut microbiome","habitat|free-living","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","gram stain|gram stain negative","habitat|digestive system","habitat|feces","habitat|large intestine","shape|bacillus","habitat|feces","habitat|large intestine","shape|bacillus","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","aerophilicity|aerobic","hemolysis|beta","gram stain|gram stain positive","habitat|human gut microbiome","spore shape|endospore","habitat|human gut microbiome","habitat|feces","butyrate-producing bacteria|TRUE","habitat|human gut microbiome","spore shape|endospore","habitat|waste and sludge water","habitat|colonization of host","habitat|feces","animal pathogen|FALSE","biofilm formation|FALSE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","animal pathogen|FALSE","gram stain|gram stain variable"],[7,8,7,3,9,10,6,6,8,4,6,6,19,38,7,4,6,4,3,10,9,10,7,11,10,7,11,12,13,4,4,10,7,7,8,11,3,5,6,6,19,19,15,6,25,30,12,2],[5,8,5,2,0,1,0,3,0,5,0,3,8,2,5,8,3,4,5,1,2,1,4,0,2,5,1,2,1,2,2,0,3,3,7,3,7,1,0,7,11,11,15,24,5,0,8,3],[4,3,4,2,36,35,25,7,35,1,26,6,27,134,31,6,32,2,2,67,61,72,30,98,72,30,98,87,62,12,14,92,31,36,30,71,2,33,38,18,62,63,40,5,107,154,43,0],[50,46,50,102,67,66,81,99,67,103,81,100,62,76,216,241,218,256,256,183,189,178,220,152,177,219,151,158,183,244,242,156,217,212,215,177,248,220,215,231,168,167,190,225,123,76,196,253],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[17.5,15.33,17.5,76.5,35.14,18.86,41.55,28.29,32.32,82.40000000000001,39.98,33.33,5.45,10.78,9.75,20.08,13.62,128,76.8,27.31,13.94,24.72,12.83,35.61,12.29,10.22,16.95,10.9,38.37,40.67,34.57,35.53,16.33,13.74,8.19,9.140000000000001,53.14,33.33,72.77,11,4.68,4.58,4.75,11.25,5.75,30.2,6.84,362.14],[3.77,3.34,3.77,7.89,1.99,2.32,2.26,5.8,1.81,7.72,2.18,6.65,2.13,2.53,2.92,4.72,3.25,17.96,10.43,3.43,2.93,3.11,3.55,2.07,2.63,3.05,2.15,2.38,4.92,6.77,5.83,2.06,4.01,3.4,2.77,2.48,7.63,3.78,4.02,3.34,2.11,2.06,2.15,3.19,2.13,1.82,2.63,14.55],[81.17,70.43000000000001,81.17,741.5700000000001,621.0700000000001,153.39,763.1799999999999,137.84,576.39,879.7,733.66,167.14,13.98,45.92,32.64,85.45,57.2,912.16,565.28,217.45,66.29000000000001,196.66,46.45,611.15,57.49,34.25,133.36,49.8,299.33,244.45,205.17,613.41,66.48999999999999,55.6,24.21,33.74,369.99,294.28,1318.25,36.2,10.39,10.16,10.49,39.63,15.54,500.6,17.74,9012.93],["","","","","*","","*","","*","","*","","","","","","","","","","","","","*","","","","","","","","*","","","","","","","*","","","","","","","*","","*"],["anatomical system disease","anatomical system disease","anatomical system disease","cancer","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","mental disease","anatomical system disease","metabolic disease","anatomical system disease","anatomical system disease","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","mental disease","mental disease","mental disease","metabolic disease","cancer","cancer","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease"],["bsdb:530/1/2_Smoking-status-measurement:Current-Smokers_vs_Never-Smokers_DOWN","bsdb:530/2/2_Smoking-status-measurement:Former-Smokers_vs_Never-Smokers_DOWN","bsdb:530/3/2_Smoking-status-measurement:Current-Smokers_vs_Former-Smokers_DOWN","bsdb:30/1/2_chronic-fatigue-syndrome:Norweigan-controls_vs_Belgian-controls_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/3/2_obesity:high-BMI_vs_low-BMI_DOWN","bsdb:158/1/2_lung-cancer:lung-cancer-patients_vs_healthy-volunteers_DOWN","bsdb:208/2/2_food-allergy:infants-with-food-allergies_vs_healthy-controls_DOWN","bsdb:226/2/2_HIV-infection:HAART-treated-HIV-1-patients_vs_HAART-naive-HIV-1-patients_DOWN","bsdb:227/4/2_atopic-eczema:infants-with-persistent-atopic-dermatitis_vs_healthy-controls_DOWN","bsdb:605/2/2_Parkinson's-disease:Participants-with-Parkinson's-Disease-with-tremor-subtypes_vs_Participants-with-Parkinson's-Disease-with-non-tremor-subtypes_DOWN","bsdb:735/3/2_Crohn's-disease:Crohn's-disease_vs_Healthy-control_DOWN","bsdb:774/2/1_irritable-bowel-syndrome:IBS-D-(IBS-Diarrhea)_vs_Non-IBS2-(Non-irritable-bowel-syndrome-2)_DOWN","bsdb:754/1/2_smoking-behavior:Smokers_vs_Non-smokers_DOWN","bsdb:31/1/2_chronic-fatigue-syndrome:CFS/ME-patients_vs_controls_DOWN","bsdb:31/1/2_chronic-fatigue-syndrome:CFS/ME-patients_vs_controls_DOWN","bsdb:31/2/2_chronic-fatigue-syndrome:CFS/ME-patients-with-IBS_vs_controls_DOWN","bsdb:41/1/2_psychosis:FIrst-episode-Psychosis_vs_Controls_DOWN","bsdb:41/1/2_psychosis:FIrst-episode-Psychosis_vs_Controls_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/1/2_obesity:obese_vs_non-obese_DOWN","bsdb:74/3/2_obesity:high-BMI_vs_low-BMI_DOWN","bsdb:74/3/2_obesity:high-BMI_vs_low-BMI_DOWN","bsdb:74/3/2_obesity:high-BMI_vs_low-BMI_DOWN","bsdb:99/1/2_obesity:obese_vs_controls_DOWN","bsdb:99/1/2_obesity:obese_vs_controls_DOWN","bsdb:271/1/2_acute-lymphoblastic-leukemia:Minimal-Residual-Disease--(negativity)-with-Allogenic-Stem-Cell-Transplant_vs_Minimal-Residual-Disease+-(positivity)-with-Allogenic-Stem-Cell-Transplant_DOWN","bsdb:271/1/2_acute-lymphoblastic-leukemia:Minimal-Residual-Disease--(negativity)-with-Allogenic-Stem-Cell-Transplant_vs_Minimal-Residual-Disease+-(positivity)-with-Allogenic-Stem-Cell-Transplant_DOWN","bsdb:428/1/2_COVID-19:COVID-19-cases_vs_Healthy-controls_DOWN","bsdb:428/1/2_COVID-19:COVID-19-cases_vs_Healthy-controls_DOWN","bsdb:428/1/2_COVID-19:COVID-19-cases_vs_Healthy-controls_DOWN","bsdb:428/3/2_COVID-19:Recovered-COVID-19-cases_vs_Healthy-controls_DOWN","bsdb:428/4/1_COVID-19:COVID-19-patients-treated-with-antibiotics_vs_Healthy-controls_DOWN","bsdb:481/2/2_COVID-19:Antibiotic-treated-COVID-19-patients_vs_Antibiotic-naive-COVID-19-patients_DOWN","bsdb:483/2/1_COVID-19:Antibiotic-treated-COVID-19-patients_vs_Antibiotic-naive-COVID-19-patients,-pneumonia-patients,-uninfected-controls_DOWN","bsdb:483/2/1_COVID-19:Antibiotic-treated-COVID-19-patients_vs_Antibiotic-naive-COVID-19-patients,-pneumonia-patients,-uninfected-controls_DOWN","bsdb:547/1/2_COVID-19:Recovered-COVID-19-patients_vs_Healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/1/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_healthy-controls_DOWN","bsdb:790/3/1_inflammatory-bowel-disease:inflammatory-bowel-disease-patients_vs_non-inflammatory-bowel-disease-symptomatic-controls_DOWN","bsdb:790/6/1_Increased-inflammatory-response:Inflammatory-bowel-disease-patients-with-fecal-calprotectin-levels-&gt;-1000-mg/kg_vs_Inflammatory-bowel-disease-patients-with-fecal-calprotectin-levels-&lt;-1000-mg/kg_DOWN"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>BSDB ID<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>control<\/th>\n      <th>treatment<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n      <th>Category<\/th>\n      <th>bsdb_sig<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[8,9,10,11,12,13,14,15,16]},{"name":"BSDB ID","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"control","targets":5},{"name":"treatment","targets":6},{"name":"sig_name","targets":7},{"name":"inBSDB_annotated","targets":8},{"name":"inBSDB_noAnnotated","targets":9},{"name":"notInBSDB_annotated","targets":10},{"name":"notInBSDB_noAnnotated","targets":11},{"name":"p_value","targets":12},{"name":"fdr","targets":13},{"name":"odds_ratio","targets":14},{"name":"lower_ci","targets":15},{"name":"upper_ci","targets":16},{"name":"HA","targets":17},{"name":"Category","targets":18},{"name":"bsdb_sig","targets":19}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="heatmap-down">Heatmap Down<a class="anchor" aria-label="anchor" href="#heatmap-down"></a>
</h2>
<p>Data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_grodown) by genus</span></span>
<span><span class="va">summary_down_freq</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_down</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span>,<span class="va">summary_category_down</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_down</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span>,<span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lgd &lt;- Legend(col_fun = color_fun, title = "% (col)")</span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_down</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">row_anno_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_down_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_down</span> <span class="op">&lt;-</span> <span class="va">ht1_down</span> <span class="op">+</span> <span class="va">ht2_down</span> <span class="op">+</span> <span class="va">row_anno_down</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_down</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb_signatures_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># x &lt;- c(rep(1, 520), rep(2, 480))</span></span>
<span><span class="co"># lay &lt;- matrix(x, ncol = 100, byrow = FALSE)</span></span>
<span><span class="co"># lay[9:10,52:100] &lt;- NA</span></span>
<span><span class="co"># grid.arrange(p1, p2, layout_matrix = lay)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-15</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-02-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@1339325)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-02-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.2    <span style="color: #555555;">2024-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.15   <span style="color: #555555;">2022-05-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.1    <span style="color: #555555;">2024-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.31     <span style="color: #555555;">2023-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  forcats            1.0.0    <span style="color: #555555;">2023-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.4.4    <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra        * 2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ontologyIndex      2.11     <span style="color: #555555;">2023-05-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6    <span style="color: #555555;">2021-05-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.2    <span style="color: #555555;">2022-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-02-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.42     <span style="color: #555555;">2024-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
