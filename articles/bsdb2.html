<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-throughput ORA with BSDB meta-signatures • bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="High-throughput ORA with BSDB meta-signatures">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/bsdb2.html">High-throughput ORA with BSDB meta-signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down.html">Odds Ratio - Up vs Down</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bsdb2_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="bsdb2_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="bsdb2_files/datatables-binding-0.31/datatables.js"></script><link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="bsdb2_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="bsdb2_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="bsdb2_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="bsdb2_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="bsdb2_files/selectize-0.12.0/selectize.min.js"></script><link href="bsdb2_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="bsdb2_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>High-throughput ORA with BSDB
meta-signatures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/bsdb2.Rmd" class="external-link"><code>vignettes/articles/bsdb2.Rmd</code></a></small>
      <div class="hidden name"><code>bsdb2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://zenodo.org/records/7622129/files/waldronlab/TypicalMicrobiomeSignaturesExports-v1.0.1.zip?download=1"</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"tms.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url</span>, destfile <span class="op">=</span> <span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">temp_file</span>, exdir <span class="op">=</span> <span class="va">temp_dir</span>, junkpaths <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_dir</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">csv_files</span>,  <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>            names_to <span class="op">=</span> <span class="st">"Body site"</span>, values_to <span class="op">=</span> <span class="st">"Prevalence"</span>,</span>
<span>            cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>            `Body site` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_(species|genus)_prevalence$"</span>, <span class="st">""</span>, <span class="va">`Body site`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*matrix_(.*).csv$"</span>, <span class="st">"\\1"</span>, <span class="va">csv_files</span><span class="op">)</span></span>
<span><span class="va">tms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">l</span>, .id <span class="op">=</span> <span class="st">"rank_agegroup"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"rank_agegroup"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rank"</span>, <span class="st">"Age group"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span></span>
<span>        <span class="va">`Age group`</span>, <span class="va">`Rank`</span>, `NCBI ID` <span class="op">=</span> <span class="va">NCBI</span>, `Taxon name` <span class="op">=</span> <span class="va">name</span>,</span>
<span>        <span class="va">`Body site`</span>, <span class="va">Prevalence</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Age group`</span> <span class="op">==</span> <span class="st">"adult"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `Body site` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"stool"</span> <span class="op">~</span> <span class="st">"feces"</span>,</span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"oralcavity"</span> <span class="op">~</span> <span class="st">"mouth"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Body site`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Prevalence</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tms</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   `Age group` Rank  `NCBI ID` `Taxon name`   `Body site` Prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  vagina          0.063<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  mouth           0.302 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  feces           0.032<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus vagina          0.063<span style="text-decoration: underline;">2</span></span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## "10.5281/zenodo.10407666" v1.2.0</span></span>
<span><span class="co">## "10.5281/zenodo.6468009" v1.1.0</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"10.5281/zenodo.10407666"</span>, cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(grepl("(healthy|control)", `Group 0 name`, ignore.case = TRUE)) |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Study design`</span> <span class="op">==</span> <span class="st">"case-control"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1416   50</span></span></code></pre></div>
<p>BugSigDB subsets by body site:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uberon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getOntology.html" class="external-link">getOntology</a></span><span class="op">(</span>onto <span class="op">=</span> <span class="st">"uberon"</span><span class="op">)</span></span>
<span><span class="va">body_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tms</span><span class="op">$</span><span class="va">`Body site`</span><span class="op">)</span></span>
<span><span class="va">bsdb_subsets_by_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">body_sites</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"skin"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">`Body site`</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/subsetByOntology.html" class="external-link">subsetByOntology</a></span><span class="op">(</span></span>
<span>            <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Body site"</span>, term <span class="op">=</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ontology <span class="op">=</span> <span class="va">uberon</span> </span>
<span>        <span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bugphyzz:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="signatures">Signatures<a class="anchor" aria-label="anchor" href="#signatures"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genus"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="va">tms_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">tms_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tms</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Body site`</span> <span class="op">==</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">Rank</span> <span class="op">==</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`NCBI ID`</span><span class="op">)</span></span>
<span>        <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UP"</span>, <span class="st">"DOWN"</span><span class="op">)</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span></span>
<span>    mode <span class="op">=</span> <span class="st">"list"</span>, </span>
<span>    length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>                <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>                df <span class="op">=</span> <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                colum <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span>
<span>                min.studies <span class="op">=</span> <span class="fl">1</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>, tax.level <span class="op">=</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span></span></code></pre></div>
<p>Reference signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">background_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sig_name</span></span>
<span>    <span class="va">bodysite_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">rank_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\2"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">tms_sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">bodysite_name</span>, <span class="st">"_"</span>, <span class="va">rank_name</span><span class="op">)</span></span>
<span>    <span class="va">background_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">[[</span><span class="va">tms_sig_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>bugphyzz signatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span>, <span class="st">"|genus"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span>, <span class="st">"|species"</span><span class="op">)</span></span>
<span><span class="va">bp_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span>, <span class="va">bp_sigs_sp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enrichment">Enrichment<a class="anchor" aria-label="anchor" href="#enrichment"></a>
</h2>
<p>genus:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_genus_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span>, <span class="va">background_sigs_gn</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="va">en_gn_df</span> <span class="op">&lt;-</span> <span class="va">en_gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co">## Let's re calculate FRR (not just the output of microheSEtEnrichment)</span></span>
<span>    <span class="co"># mutate(fdr = p.adjust(p_value, method = "fdr")) |&gt; </span></span>
<span>    <span class="co"># filter(fdr &lt; 0.1) |&gt; </span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># myDataTable(en_gn_df, nrow(en_gn_df))</span></span></code></pre></div>
<p>species:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_species_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span>, <span class="va">background_sigs_sp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">en_sp_df</span> <span class="op">&lt;-</span> <span class="va">en_sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co">## Let's re calculate FRR (not just the output of microheSEtEnrichment)</span></span>
<span>    <span class="co"># mutate(fdr = p.adjust(p_value, method = "fdr")) |&gt;</span></span>
<span>    <span class="co"># filter(fdr &lt; 0.1) |&gt; </span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># myDataTable(en_sp_df, page_len = nrow(en_sp_df))</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># en_df &lt;- bind_rows(en_gn_df, en_sp_df) |&gt;</span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         fdr = p.adjust(p_value, method = "fdr")</span></span>
<span><span class="co">#     )</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">en_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">en_sp_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># group_by(rank) |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        fdr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p_value</span>, method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># ungroup() |&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span>,</span>
<span>        Category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span>, <span class="st">"other"</span>, <span class="va">Category</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">en_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">en_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="table-up">Table up<a class="anchor" aria-label="anchor" href="#table-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_up</span><span class="op">$</span><span class="va">bsdb_sig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_up</span><span class="op">$</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 56</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">en_up</span>, <span class="va">Category</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                    Category  n</span></span>
<span><span class="co">#&gt; 1                 anatomical system disease 20</span></span>
<span><span class="co">#&gt; 2                                    cancer 36</span></span>
<span><span class="co">#&gt; 3 environment, sociodemographics, lifestyle  4</span></span>
<span><span class="co">#&gt; 4                        infectious disease  6</span></span>
<span><span class="co">#&gt; 5                            mental disease 16</span></span>
<span><span class="co">#&gt; 6                         metabolic disease  8</span></span>
<span><span class="co">#&gt; 7                                     other 38</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_up</span>, page_len <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-df3496a23b9f8e2101f5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-df3496a23b9f8e2101f5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"126\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"203\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"276\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"563\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.001\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.097\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.73\" data-max=\"145.69\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.23\" data-max=\"14.68\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.42\" data-max=\"3173.64\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["skin_genus_UP_atopic eczema","mouth_genus_UP_Down syndrome","mouth_genus_UP_irritable bowel syndrome","mouth_genus_UP_oral squamous cell carcinoma","mouth_genus_UP_smoking behavior","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_cervical cancer","feces_genus_UP_colorectal adenocarcinoma","feces_genus_UP_diabetic retinopathy","feces_genus_UP_Eczema","feces_genus_UP_Eczema","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mismatch repair cancer syndrome","feces_genus_UP_Mood disorder","feces_genus_UP_multiple myeloma","feces_genus_UP_multiple sclerosis","feces_genus_UP_obesity","feces_genus_UP_pancreatic carcinoma","feces_genus_UP_psychosis","feces_genus_UP_psychosis","feces_genus_UP_type I diabetes mellitus","feces_genus_UP_ulcerative colitis","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","skin_species_UP_atopic eczema","mouth_species_UP_chronic kidney disease","mouth_species_UP_chronic kidney disease","mouth_species_UP_Down syndrome","mouth_species_UP_Down syndrome","mouth_species_UP_Smoking status measurement","mouth_species_UP_Smoking status measurement","mouth_species_UP_Smoking status measurement","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_Eczema","feces_species_UP_irritable bowel syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_Mismatch repair cancer syndrome","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_Parkinson's disease","feces_species_UP_Parkinson's disease","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_Time","feces_species_UP_Time","feces_species_UP_Time","feces_species_UP_Time","feces_species_UP_Time","feces_species_UP_Time","feces_species_UP_unipolar depression"],["skin","mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","skin","skin","skin","skin","skin","skin","skin","skin","mouth","mouth","mouth","mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP"],["atopic eczema","down syndrome","irritable bowel syndrome","oral squamous cell carcinoma","smoking behavior","breast cancer","breast cancer","cervical cancer","colorectal adenocarcinoma","diabetic retinopathy","eczema","eczema","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mood disorder","multiple myeloma","multiple sclerosis","obesity","pancreatic carcinoma","psychosis","psychosis","type i diabetes mellitus","ulcerative colitis","atopic eczema","atopic eczema","atopic eczema","atopic eczema","atopic eczema","atopic eczema","atopic eczema","atopic eczema","chronic kidney disease","chronic kidney disease","down syndrome","down syndrome","smoking status measurement","smoking status measurement","smoking status measurement","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","eczema","irritable bowel syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","mismatch repair cancer syndrome","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","obesity","obesity","obesity","obesity","obesity","parkinson's disease","parkinson's disease","psychosis","psychosis","psychosis","schizophrenia","schizophrenia","schizophrenia","schizophrenia","time","time","time","time","time","time","unipolar depression"],["shape|elliptic","aerophilicity|aerobic","motility|TRUE","animal pathogen|TRUE","habitat|waste and sludge water","gram stain|gram stain negative","length|small| &gt; 0.19 &amp; &lt;= 3.8","sphingolipid producing|TRUE","hemolysis|gamma","gram stain|gram stain negative","gram stain|gram stain negative","hemolysis|gamma","aerophilicity|aerobic","biosafety level|biosafety level 1","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain negative","animal pathogen|FALSE","host-associated|FALSE","motility|TRUE","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","length|small| &gt; 0.19 &amp; &lt;= 3.8","width|small| &gt; -0.01 &amp; &lt;= 0.9","sphingolipid producing|TRUE","gram stain|gram stain negative","gram stain|gram stain negative","animal pathogen|TRUE","gram stain|gram stain negative","aerophilicity|aerobic","cogem pathogenicity rating|cogem pathogenicity rating 1","habitat|waste and sludge water","hemolysis|gamma","aerophilicity|facultatively anaerobic","arrangement|cell chain","arrangement|cell cluster","arrangement|paired cells","gram stain|gram stain positive","habitat|human microbiome","hemolysis|beta","shape|coccus","aerophilicity|facultatively anaerobic","arrangement|cell chain","aerophilicity|aerobic","hemolysis|beta","arrangement|cell chain","cogem pathogenicity rating|cogem pathogenicity rating 1","antimicrobial sensitivity|FALSE","habitat|digestive system","habitat|human microbiome","habitat|large intestine","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","hemolysis|gamma","shape|bacillus","biofilm formation|TRUE","extreme environment|FALSE","motility|TRUE","plant pathogenicity|FALSE","spore formation|FALSE","mutation rate per site per year|slow| &gt; 0.08 &amp; &lt;= 7.5","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","habitat|human gut microbiome","spore shape|endospore","health associated|FALSE","aerophilicity|anaerobic","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|aerobic","biosafety level|biosafety level 2","gram stain|gram stain positive","habitat|feces","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|feces","mutation rate per site per generation|slow| &gt; 0.78 &amp; &lt;= 2.92","aerophilicity|aerobic","biosafety level|biosafety level 1","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain negative","habitat|free-living","habitat|plant matter","habitat|rhizosphere","habitat|root nodule","habitat|sediment","hemolysis|gamma","shape|bacillus","animal pathogen|FALSE","antimicrobial sensitivity|FALSE","host-associated|FALSE","motility|TRUE","coding genes|very large| &gt; 6000 &amp; &lt;= 14018","genome size|very large| &gt; 6997434 &amp; &lt;= 16040666","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","habitat|feces","habitat|human microbiome","habitat|oral","hemolysis|beta","biofilm formation|TRUE","host-associated|TRUE","plant pathogenicity|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","habitat|human gut microbiome","biofilm formation|FALSE","extreme environment|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","gram stain|gram stain positive","habitat|colonization of host","habitat|free-living","extreme environment|TRUE","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","gram stain|gram stain positive","habitat|digestive system","habitat|feces","host-associated|TRUE","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|digestive system"],[4,7,17,21,15,23,17,4,26,11,19,24,81,126,71,108,82,99,73,35,61,64,4,16,23,49,18,12,10,7,29,8,5,3,8,11,5,6,9,5,7,12,7,7,5,8,5,4,4,12,15,19,24,27,16,24,11,27,10,26,21,3,13,6,7,4,41,50,17,27,46,32,55,66,9,2,93,102,68,121,47,12,7,6,12,69,115,82,38,82,65,19,15,26,14,15,16,16,22,16,9,6,10,9,27,5,27,49,15,9,50,64,52,37,6,7,8,23,14,19,29,13,10,9,9,10,26,5],[4,2,9,2,12,7,13,17,3,1,7,2,55,10,65,28,54,37,63,101,75,72,15,6,12,18,7,4,6,2,6,4,7,9,4,1,7,6,3,4,2,3,8,12,14,11,1,2,2,20,17,13,8,5,16,8,21,5,22,6,11,29,19,6,5,8,15,6,58,48,29,43,20,9,3,14,116,107,141,88,162,197,202,203,197,140,94,127,171,127,144,190,194,183,15,14,13,13,7,13,20,23,19,20,2,24,2,18,52,58,17,3,41,56,13,12,11,11,20,15,5,15,18,19,19,18,2,1],[11,14,14,37,12,44,32,1,72,46,42,75,14,100,27,47,50,37,27,0,31,35,1,42,41,48,45,16,31,28,68,52,32,8,47,260,35,43,86,26,23,52,21,26,10,22,73,35,35,40,53,80,160,103,86,158,27,232,27,207,149,1,33,34,43,9,194,263,31,67,147,85,202,249,102,0,39,150,44,109,3,0,0,0,0,88,161,94,39,38,28,1,1,5,33,45,32,73,155,99,33,11,27,25,223,7,276,180,25,8,202,242,131,81,3,26,38,157,64,92,214,65,30,30,16,40,269,74],[193,70,61,34,57,91,103,138,60,97,92,59,120,34,107,87,84,97,107,134,103,99,136,93,89,52,95,134,119,118,58,519,539,563,524,311,536,528,485,275,278,242,273,272,288,276,354,392,392,379,366,339,259,316,333,261,392,187,392,212,270,418,386,388,379,413,207,138,355,319,239,301,184,137,321,422,383,272,378,313,419,422,422,422,422,334,261,328,383,384,394,421,421,417,382,370,383,342,260,316,382,404,388,390,192,408,139,200,355,372,178,138,232,282,424,401,389,248,341,313,191,343,378,378,392,368,139,354],[0.001,0,0,0,0,0,0.001,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0.001,0,0,0.001,0,0.001,0,0,0.001,0,0.001,0.001,0,0,0.001,0,0,0,0.001,0.001,0,0.001,0.001,0.001,0,0,0,0,0,0,0,0,0.001,0,0,0.001,0.001,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0.001,0,0.001,0,0,0,0,0,0.001,0,0.001,0,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0,0.001,0,0,0,0.001,0,0,0.001,0,0,0,0.001,0.001,0,0,0,0,0,0,0,0.001,0.001],[0.097,0,0,0,0,0,0.097,0.097,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.097,0,0,0.097,0,0,0.097,0,0.097,0,0,0.097,0,0.097,0.097,0,0,0.097,0,0,0,0.097,0.097,0,0.097,0.097,0.097,0,0,0,0,0,0,0,0,0.097,0,0,0.097,0.097,0,0,0,0,0,0,0,0,0,0,0.097,0,0,0.097,0,0.097,0,0,0,0,0,0.097,0,0.097,0,0,0.097,0,0,0,0,0,0,0,0,0,0,0,0.097,0,0,0,0,0,0.097,0,0,0,0.097,0,0,0.097,0,0,0,0.097,0.097,0,0,0,0,0,0,0,0.097,0.097],[17.55,17.5,8.23,9.65,5.94,6.8,4.21,32.47,7.22,23.2,5.95,9.44,12.62,4.28,4.33,7.14,2.55,7.01,4.59,94.08,2.7,2.51,36.27,5.9,4.16,2.95,5.43,25.12,6.4,14.75,4.12,19.96,12.03,23.46,22.3,13.16,10.94,12.28,16.92,13.22,42.3,18.62,11.38,6.1,10.29,9.119999999999999,24.25,22.4,22.4,5.68,6.09,6.19,4.86,16.57,3.87,4.96,7.6,4.35,6.6,4.44,3.46,43.24,8,11.41,12.34,22.94,2.92,4.37,3.36,2.68,2.58,2.64,2.5,4.03,9.44,145.69,7.87,1.73,4.14,3.95,40.52,53.48,31.3,26.99,53.48,1.87,1.98,2.25,2.18,6.52,6.35,42.1,32.55,11.85,10.8,8.81,14.73,5.77,5.27,3.93,5.21,9.58,7.56,7.02,11.62,12.14,6.8,3.02,4.1,7.22,2.59,12.17,2.25,2.3,65.23,9,7.44,3.3,3.73,4.31,5.18,4.57,7,5.97,11.61,5.11,6.72,23.92],[3.86,3.28,3.04,2.1,2.22,2.71,1.85,3.43,2.08,2.91,2.32,2.14,6.58,2.02,2.52,4.13,1.56,4.11,2.68,5.7,1.6,1.51,3.8,2.16,1.89,1.51,2.12,7.24,2.16,2.91,1.6,5.81,3.62,5.33,6.47,1.69,3.3,3.8,4.49,3.34,8.31,5.07,3.76,2.21,3.1,3.33,2.79,3.96,3.96,2.59,2.87,2.94,2.13,6.22,1.86,2.17,3.33,1.64,2.84,1.79,1.62,4.36,3.63,3.49,3.75,5.83,1.56,1.83,1.75,1.56,1.55,1.57,1.45,1.95,2.51,6.69,5.13,1.23,2.71,2.78,12.44,3.15,1.78,1.51,3.15,1.29,1.42,1.57,1.35,4.23,3.92,5.6,4.27,4.48,4.8,3.99,6.51,2.66,2.2,1.83,2.2,3.25,3.2,2.9,2.73,3.59,1.59,1.7,2.03,2.68,1.44,3.75,1.42,1.42,14.68,3.27,2.82,1.57,1.79,2.11,1.96,2.08,2.97,2.49,4.54,2.21,1.57,2.75],[79.68000000000001,93.23999999999999,22.26,44.26,15.85,17.04,9.59,307.6,25.04,185.11,15.23,41.56,24.2,9.09,7.43,12.33,4.17,11.98,7.88,1552.02,4.57,4.19,345.9,16.16,9.17,5.75,13.93,87.23,18.96,74.88,10.62,68.54000000000001,40.02,103.19,76.8,102.59,36.23,39.7,63.75,52.29,215.48,68.31,34.42,16.84,34.15,25.02,210.62,126.63,126.63,12.48,12.92,13.06,11.07,44.13,8.050000000000001,11.3,17.39,11.52,15.33,11,7.37,428.83,17.63,37.31,40.57,90.29000000000001,5.44,10.45,6.45,4.6,4.29,4.42,4.34,8.35,35.54,3173.64,12.08,2.42,6.34,5.61,132.02,907.84,550.65,481.43,907.84,2.71,2.78,3.23,3.53,10.07,10.29,316.78,248.19,31.34,24.3,19.44,33.31,12.51,12.63,8.449999999999999,12.35,28.21,17.86,17,49.51,41.1,29.01,5.38,8.27,19.45,4.66,39.45,3.57,3.73,289.94,24.78,19.63,6.96,7.77,8.82,13.64,10.06,16.51,14.33,29.64,11.83,28.72,207.74],["","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","*","*","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["anatomical system disease","other","anatomical system disease","cancer","environment, sociodemographics, lifestyle","cancer","cancer","cancer","cancer","metabolic disease","anatomical system disease","anatomical system disease","other","other","other","other","other","other","other","other","other","other","other","cancer","mental disease","metabolic disease","cancer","mental disease","mental disease","metabolic disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","other","other","environment, sociodemographics, lifestyle","environment, sociodemographics, lifestyle","environment, sociodemographics, lifestyle","mental disease","mental disease","mental disease","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","infectious disease","infectious disease","infectious disease","infectious disease","infectious disease","infectious disease","anatomical system disease","anatomical system disease","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","other","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","cancer","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","other","other","other","other","other","other","mental disease"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inBSDB_annotated","targets":6},{"name":"inBSDB_noAnnotated","targets":7},{"name":"notInBSDB_annotated","targets":8},{"name":"notInBSDB_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15},{"name":"Category","targets":16}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="heatmap-up">Heatmap UP<a class="anchor" aria-label="anchor" href="#heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">en_tbl</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">body_site</span>, <span class="va">rank</span>, <span class="va">direction</span>, <span class="va">condition</span>, <span class="va">Category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># dat &lt;- data.frame(bsdb_sig = names(bsdb_sigs)) |&gt; </span></span>
<span><span class="co">#     separate(</span></span>
<span><span class="co">#         col = "bsdb_sig",</span></span>
<span><span class="co">#         into =  c("body_site", "rank", "direction", "condition"),</span></span>
<span><span class="co">#         sep = "_"</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     mutate(condition = tolower(condition)) |&gt; </span></span>
<span><span class="co">#     left_join(cond2cat, by = c("condition" = "Condition")) |&gt; </span></span>
<span><span class="co">#     mutate(Category = ifelse(is.na(Category), "other", Category)) |&gt; </span></span>
<span><span class="co">#     filter(!is.na(Category)) |&gt; </span></span>
<span><span class="co">#     arrange()</span></span>
<span><span class="va">dat_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span></span>
<span><span class="va">dat_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span></span></code></pre></div>
<p>Data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_group) by genus</span></span>
<span><span class="va">summary_up_freq</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_up</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span>,<span class="va">summary_category_up</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_up</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span>,<span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span></span>
<span>            n <span class="op">=</span> <span class="va">x</span></span>
<span>            <span class="co"># n = x, begin = 0, option = "C", direction = -1</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_up</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rank_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">'gray50'</span>, species <span class="op">=</span> <span class="st">'gray80'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_anno_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_up_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_up</span> <span class="op">&lt;-</span> <span class="va">ht1_up</span> <span class="op">+</span> <span class="va">ht2_up</span> <span class="op">+</span> <span class="va">row_anno_up</span></span>
<span><span class="va">lgd_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rank_col</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Rank"</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_up</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-19-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="table-down">Table Down<a class="anchor" aria-label="anchor" href="#table-down"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_down</span><span class="op">$</span><span class="va">bsdb_sig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">en_down</span><span class="op">$</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 33</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">en_down</span>, <span class="va">Category</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                    Category  n</span></span>
<span><span class="co">#&gt; 1                 anatomical system disease 30</span></span>
<span><span class="co">#&gt; 2                                     birth  1</span></span>
<span><span class="co">#&gt; 3                                    cancer 10</span></span>
<span><span class="co">#&gt; 4 environment, sociodemographics, lifestyle  1</span></span>
<span><span class="co">#&gt; 5                        infectious disease  7</span></span>
<span><span class="co">#&gt; 6                            mental disease 10</span></span>
<span><span class="co">#&gt; 7                         metabolic disease 12</span></span>
<span><span class="co">#&gt; 8                                     other  8</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_down</span>, page_len <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-9577d2d426f24762dce9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9577d2d426f24762dce9">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"65\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"58\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"259\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"33\" data-max=\"429\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.001\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.097\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.36\" data-max=\"284\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.2\" data-max=\"23.83\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.99\" data-max=\"4041.93\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["mouth_genus_DOWN_Down syndrome","mouth_genus_DOWN_irritable bowel syndrome","mouth_genus_DOWN_irritable bowel syndrome","mouth_genus_DOWN_Smoking status measurement","feces_genus_DOWN_atopic eczema","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_Crohn's disease","feces_genus_DOWN_Crohn's disease","feces_genus_DOWN_diabetic retinopathy","feces_genus_DOWN_food allergy","feces_genus_DOWN_food allergy","feces_genus_DOWN_Population","vagina_species_DOWN_premature birth","mouth_species_DOWN_Down syndrome","feces_species_DOWN_acute lymphoblastic leukemia","feces_species_DOWN_acute lymphoblastic leukemia","feces_species_DOWN_Ankylosing spondylitis","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Increased inflammatory response","feces_species_DOWN_Increased inflammatory response","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_psychosis","feces_species_DOWN_psychosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_Treatment","feces_species_DOWN_Treatment","feces_species_DOWN_Treatment","feces_species_DOWN_ulcerative colitis","feces_species_DOWN_ulcerative colitis"],["mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","vagina","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN"],["down syndrome","irritable bowel syndrome","irritable bowel syndrome","smoking status measurement","atopic eczema","colorectal cancer","crohn's disease","crohn's disease","diabetic retinopathy","food allergy","food allergy","population","premature birth","down syndrome","acute lymphoblastic leukemia","acute lymphoblastic leukemia","ankylosing spondylitis","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","covid-19","covid-19","covid-19","crohn's disease","crohn's disease","crohn's disease","increased inflammatory response","increased inflammatory response","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","nephrolithiasis","nephrolithiasis","nephrolithiasis","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","parkinson's disease","parkinson's disease","psychosis","psychosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","treatment","treatment","treatment","ulcerative colitis","ulcerative colitis"],["animal pathogen|TRUE","habitat|waste and sludge water","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","aerophilicity|facultatively anaerobic","plant pathogenicity|TRUE","hemolysis|gamma","gram stain|gram stain negative","hemolysis|gamma","length|small| &gt; 0.19 &amp; &lt;= 3.8","gram stain|gram stain negative","habitat|waste and sludge water","animal pathogen|TRUE","arrangement|cell chain","habitat|oral","aerophilicity|aerobic","hemolysis|beta","spore shape|endospore","habitat|human gut microbiome","spore shape|endospore","biofilm formation|FALSE","aerophilicity|anaerobic","habitat|human gut microbiome","habitat|human gut microbiome","habitat|waste and sludge water","spore shape|endospore","habitat|colonization of host","habitat|human gut microbiome","biofilm formation|FALSE","gram stain|gram stain variable","butyrate-producing bacteria|TRUE","biosafety level|biosafety level 1","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|waste and sludge water","animal pathogen|FALSE","biofilm formation|FALSE","extreme environment|FALSE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","arrangement|paired cells","habitat|free-living","shape|bacillus","extreme environment|FALSE","aerophilicity|anaerobic","habitat|colonization of host","habitat|feces","habitat|human microbiome","habitat|large intestine","extreme environment|FALSE","arrangement|paired cells","habitat|free-living","host-associated|TRUE","aerophilicity|anaerobic","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","shape|bacillus","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|human gut microbiome","habitat|waste and sludge water","habitat|free-living","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","habitat|digestive system","habitat|large intestine","animal pathogen|FALSE","habitat|human gut microbiome","biofilm formation|FALSE"],[25,10,4,8,4,58,34,48,14,15,12,28,5,13,4,4,8,8,7,4,41,12,14,11,17,17,10,6,2,2,23,21,17,22,10,8,18,7,30,28,35,25,10,5,20,25,12,9,9,6,6,12,9,4,20,51,33,32,32,40,17,18,47,56,58,65,11,9,4,3,8,8,7,8,7,5,7,7,5],[3,4,10,9,8,14,26,12,11,3,6,4,3,43,2,2,7,5,6,9,9,38,43,46,40,16,23,27,3,3,12,14,18,13,25,27,17,28,5,7,0,3,18,23,8,3,0,3,3,6,6,0,14,19,3,24,42,43,43,35,58,57,28,19,17,10,33,35,4,5,13,13,14,13,3,5,3,13,15],[35,20,1,8,3,49,36,59,29,46,27,75,13,16,38,30,50,32,43,12,194,28,26,15,35,99,31,11,1,3,131,94,61,88,31,17,77,10,214,189,259,209,40,2,155,229,209,106,100,33,33,231,40,3,232,180,85,87,50,74,22,21,130,201,194,242,29,16,3,5,32,31,18,42,71,34,88,33,11],[33,65,84,70,142,52,78,55,106,95,114,61,177,248,390,398,379,388,377,408,207,373,365,376,356,309,377,397,426,424,267,304,337,310,367,381,321,388,184,209,139,209,378,416,263,189,211,314,320,387,387,189,384,421,192,200,295,293,330,306,358,359,250,179,186,138,366,379,429,427,383,384,397,373,351,388,334,385,407],[0,0.001,0.001,0.001,0.001,0,0.001,0,0.001,0,0,0,0,0,0.001,0,0,0,0,0.001,0,0,0,0,0,0.001,0,0.001,0,0.001,0,0,0,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0.001,0,0,0.001,0.001,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0,0,0.001,0,0.001,0.001,0.001,0],[0,0.097,0.097,0.097,0.097,0,0.097,0,0.097,0,0,0,0,0,0.097,0,0,0,0,0.097,0,0,0,0,0,0.097,0,0.097,0,0.097,0,0,0,0,0.097,0,0,0,0,0,0,0,0,0,0,0,0,0.097,0,0,0,0.097,0,0,0.097,0.097,0,0,0,0,0,0,0,0,0,0,0.097,0,0,0,0,0,0,0.097,0,0.097,0.097,0.097,0],[7.86,8.119999999999999,33.6,7.78,23.67,4.4,2.83,3.73,4.65,10.33,8.44,5.69,22.69,4.69,20.53,26.53,8.66,19.4,10.23,15.11,4.86,4.21,4.57,5.99,4.32,3.32,5.29,8.02,284,94.22,3.91,4.85,5.22,5.96,4.74,6.64,4.41,9.699999999999999,5.16,4.42,38.17,8.33,5.25,45.22,4.24,6.88,25.24,8.890000000000001,9.6,11.73,11.73,20.46,6.17,29.54,5.52,2.36,2.73,2.51,4.91,4.73,4.77,5.4,3.23,2.62,3.27,3.71,4.21,6.09,143,51.24,7.37,7.62,11.03,5.47,11.54,11.41,8.859999999999999,6.28,12.33],[2.17,2.3,3.41,2.34,4.51,2.18,1.49,1.79,1.91,2.85,2.91,1.89,4.87,2.11,3.64,4.67,3.01,6,3.29,4.08,2.3,1.98,2.22,2.6,2.22,1.62,2.31,2.76,19.95,11.32,1.89,2.37,2.55,2.89,2.09,2.63,2.17,3.43,1.96,1.89,2.32,2.48,2.27,8.32,1.82,2.04,1.48,2.36,2.55,3.58,3.58,1.2,2.51,6.17,1.62,1.4,1.63,1.5,2.85,2.81,2.39,2.71,1.93,1.5,1.84,1.84,1.93,2.51,23.83,9.539999999999999,2.84,2.94,3.97,2.14,2.91,3.15,2.24,2.35,3.8],[28.5,28.74,330.9,25.85,124.19,8.869999999999999,5.4,7.75,11.33,37.46,24.52,17.12,105.66,10.43,115.75,150.79,24.91,62.76,31.83,56.02,10.27,8.94,9.41,13.83,8.41,6.81,12.1,23.34,4041.93,784.3,8.09,9.91,10.68,12.31,10.75,16.77,8.960000000000001,27.42,13.57,10.36,626.92,28.02,12.15,245.72,9.859999999999999,23.13,429.03,33.44,36.15,38.4,38.4,347.89,15.16,141.43,18.85,3.99,4.57,4.2,8.48,7.95,9.52,10.75,5.4,4.59,5.82,7.45,9.18,14.79,857.9400000000001,275.23,19.08,19.78,30.67,13.94,45.68,41.38,34.95,16.83,39.98],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","*","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["other","anatomical system disease","anatomical system disease","environment, sociodemographics, lifestyle","anatomical system disease","cancer","anatomical system disease","anatomical system disease","metabolic disease","anatomical system disease","anatomical system disease","other","birth","other","cancer","cancer","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","infectious disease","infectious disease","infectious disease","anatomical system disease","anatomical system disease","anatomical system disease","other","other","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","cancer","cancer","cancer","mental disease","mental disease","mental disease","mental disease","mental disease","mental disease","anatomical system disease","anatomical system disease","anatomical system disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","metabolic disease","mental disease","mental disease","mental disease","mental disease","infectious disease","infectious disease","infectious disease","infectious disease","other","other","other","anatomical system disease","anatomical system disease"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inBSDB_annotated","targets":6},{"name":"inBSDB_noAnnotated","targets":7},{"name":"notInBSDB_annotated","targets":8},{"name":"notInBSDB_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15},{"name":"Category","targets":16}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="heatmap-down">Heatmap Down<a class="anchor" aria-label="anchor" href="#heatmap-down"></a>
</h2>
<p>Data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_grodown) by genus</span></span>
<span><span class="va">summary_down_freq</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_down</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span>,<span class="va">summary_category_down</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_down</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span>,<span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lgd &lt;- Legend(col_fun = color_fun, title = "% (col)")</span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_down</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">row_anno_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_down_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_down</span> <span class="op">&lt;-</span> <span class="va">ht1_down</span> <span class="op">+</span> <span class="va">ht2_down</span> <span class="op">+</span> <span class="va">row_anno_down</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_down</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># x &lt;- c(rep(1, 520), rep(2, 480))</span></span>
<span><span class="co"># lay &lt;- matrix(x, ncol = 100, byrow = FALSE)</span></span>
<span><span class="co"># lay[9:10,52:100] &lt;- NA</span></span>
<span><span class="co"># grid.arrange(p1, p2, layout_matrix = lay)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-13</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-02-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@1339325)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-02-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.2    <span style="color: #555555;">2024-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.15   <span style="color: #555555;">2022-05-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.1    <span style="color: #555555;">2024-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.31     <span style="color: #555555;">2023-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  forcats            1.0.0    <span style="color: #555555;">2023-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.4.4    <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra        * 2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ontologyIndex      2.11     <span style="color: #555555;">2023-05-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6    <span style="color: #555555;">2021-05-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.2    <span style="color: #555555;">2022-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-02-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.42     <span style="color: #555555;">2024-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
