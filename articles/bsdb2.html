<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-throughput ORA with BSDB meta-signatures • bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="High-throughput ORA with BSDB meta-signatures">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
    <li>
      <a href="../articles/high_throughput_bsea_bsdb.html">High-throughput BSEA with BugSigDB sets</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/bsdb2.html">High-throughput ORA with BSDB meta-signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down.html">Odds Ratio - Up vs Down</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bsdb2_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="bsdb2_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="bsdb2_files/datatables-binding-0.31/datatables.js"></script><link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="bsdb2_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="bsdb2_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="bsdb2_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="bsdb2_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="bsdb2_files/selectize-0.12.0/selectize.min.js"></script><link href="bsdb2_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="bsdb2_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>High-throughput ORA with BSDB
meta-signatures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/bsdb2.Rmd" class="external-link"><code>vignettes/articles/bsdb2.Rmd</code></a></small>
      <div class="hidden name"><code>bsdb2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://zenodo.org/records/7622129/files/waldronlab/TypicalMicrobiomeSignaturesExports-v1.0.1.zip?download=1"</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"tms.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url</span>, destfile <span class="op">=</span> <span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">temp_file</span>, exdir <span class="op">=</span> <span class="va">temp_dir</span>, junkpaths <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_dir</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">csv_files</span>,  <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>            names_to <span class="op">=</span> <span class="st">"Body site"</span>, values_to <span class="op">=</span> <span class="st">"Prevalence"</span>,</span>
<span>            cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>            `Body site` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_(species|genus)_prevalence$"</span>, <span class="st">""</span>, <span class="va">`Body site`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*matrix_(.*).csv$"</span>, <span class="st">"\\1"</span>, <span class="va">csv_files</span><span class="op">)</span></span>
<span><span class="va">tms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">l</span>, .id <span class="op">=</span> <span class="st">"rank_agegroup"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"rank_agegroup"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rank"</span>, <span class="st">"Age group"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span></span>
<span>        <span class="va">`Age group`</span>, <span class="va">`Rank`</span>, `NCBI ID` <span class="op">=</span> <span class="va">NCBI</span>, `Taxon name` <span class="op">=</span> <span class="va">name</span>,</span>
<span>        <span class="va">`Body site`</span>, <span class="va">Prevalence</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Age group`</span> <span class="op">==</span> <span class="st">"adult"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `Body site` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"stool"</span> <span class="op">~</span> <span class="st">"feces"</span>,</span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"oralcavity"</span> <span class="op">~</span> <span class="st">"mouth"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Body site`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Prevalence</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tms</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   `Age group` Rank  `NCBI ID` `Taxon name`   `Body site` Prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  vagina          0.063<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  mouth           0.302 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  feces           0.032<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus vagina          0.063<span style="text-decoration: underline;">2</span></span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## "10.5281/zenodo.1040766" v1.2.0</span></span>
<span><span class="co">## "10.5281/zenodo.6468009" v1.1.0</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"10.5281/zenodo.6468009"</span>, cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(grepl("(healthy|control)", `Group 0 name`, ignore.case = TRUE)) |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Study design`</span> <span class="op">==</span> <span class="st">"case-control"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 990  48</span></span></code></pre></div>
<p>BugSigDB subsets by body site:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uberon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getOntology.html" class="external-link">getOntology</a></span><span class="op">(</span>onto <span class="op">=</span> <span class="st">"uberon"</span><span class="op">)</span></span>
<span><span class="va">body_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tms</span><span class="op">$</span><span class="va">`Body site`</span><span class="op">)</span></span>
<span><span class="va">bsdb_subsets_by_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">body_sites</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"skin"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">`Body site`</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/subsetByOntology.html" class="external-link">subsetByOntology</a></span><span class="op">(</span></span>
<span>            <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Body site"</span>, term <span class="op">=</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ontology <span class="op">=</span> <span class="va">uberon</span> </span>
<span>        <span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bugphyzz:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="signatures">Signatures<a class="anchor" aria-label="anchor" href="#signatures"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genus"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="va">tms_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">tms_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tms</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Body site`</span> <span class="op">==</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">Rank</span> <span class="op">==</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`NCBI ID`</span><span class="op">)</span></span>
<span>        <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UP"</span>, <span class="st">"DOWN"</span><span class="op">)</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span></span>
<span>    mode <span class="op">=</span> <span class="st">"list"</span>, </span>
<span>    length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>                <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>                df <span class="op">=</span> <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                colum <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span>
<span>                min.studies <span class="op">=</span> <span class="fl">1</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>, tax.level <span class="op">=</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span></span></code></pre></div>
<p>Reference signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">background_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sig_name</span></span>
<span>    <span class="va">bodysite_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">rank_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\2"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">tms_sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">bodysite_name</span>, <span class="st">"_"</span>, <span class="va">rank_name</span><span class="op">)</span></span>
<span>    <span class="va">background_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">[[</span><span class="va">tms_sig_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>bugphyzz signatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span>, <span class="st">"|genus"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span>, <span class="st">"|species"</span><span class="op">)</span></span>
<span><span class="va">bp_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span>, <span class="va">bp_sigs_sp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enrichment">Enrichment<a class="anchor" aria-label="anchor" href="#enrichment"></a>
</h2>
<p>genus:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_genus_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span>, <span class="va">background_sigs_gn</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="va">en_gn_df</span> <span class="op">&lt;-</span> <span class="va">en_gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1c1419babddf101b9f05" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1c1419babddf101b9f05">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"43\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"85\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"53\" data-max=\"149\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.005\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.088\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.57\" data-max=\"166.11\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.4\" data-max=\"7.24\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"7.64\" data-max=\"3985.93\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["vagina_genus_UP_Human immunodeficiency virus","mouth_genus_UP_inflammatory bowel disease","mouth_genus_DOWN_inflammatory bowel disease","mouth_genus_DOWN_inflammatory bowel disease","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_cervical cancer","feces_genus_UP_colorectal cancer","feces_genus_UP_Eczema","feces_genus_UP_Eczema","feces_genus_UP_Eczema","feces_genus_UP_irritable bowel syndrome","feces_genus_UP_irritable bowel syndrome","feces_genus_UP_irritable bowel syndrome","feces_genus_UP_irritable bowel syndrome","feces_genus_UP_multiple myeloma","feces_genus_UP_multiple sclerosis","feces_genus_UP_pancreatic carcinoma","feces_genus_UP_pancreatic carcinoma","feces_genus_UP_psychosis","feces_genus_UP_psychosis","feces_genus_UP_pulmonary tuberculosis","feces_genus_UP_type I diabetes mellitus","feces_genus_UP_type II diabetes mellitus","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_diabetic retinopathy","feces_genus_DOWN_diabetic retinopathy","feces_genus_DOWN_food allergy","feces_genus_DOWN_food allergy","feces_genus_DOWN_HIV infection","feces_genus_DOWN_Parkinson's disease"],["vagina","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],["UP","UP","DOWN","DOWN","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN"],["human immunodeficiency virus","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","cervical cancer","colorectal cancer","eczema","eczema","eczema","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","multiple myeloma","multiple sclerosis","pancreatic carcinoma","pancreatic carcinoma","psychosis","psychosis","pulmonary tuberculosis","type i diabetes mellitus","type ii diabetes mellitus","colorectal cancer","diabetic retinopathy","diabetic retinopathy","food allergy","food allergy","hiv infection","parkinson's disease"],["aerophilicity|facultatively anaerobic","motility|TRUE","habitat|waste and sludge water","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","hemolysis|gamma","motility|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","sphingolipid producing|TRUE","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","hemolysis|gamma","sphingolipid producing|TRUE","aerophilicity|facultatively anaerobic","arrangement|paired cells","habitat|waste and sludge water","shape|elliptic","motility|TRUE","gram stain|gram stain negative","gram stain|gram stain negative","motility|TRUE","aerophilicity|aerobic","cogem pathogenicity rating|cogem pathogenicity rating 1","length|average| &gt; 3.8 &amp; &lt;= 22","habitat|waste and sludge water","gram stain|gram stain negative","hemolysis|gamma","length|small| &gt; 0.19 &amp; &lt;= 3.8","width|small| &gt; -0.01 &amp; &lt;= 0.9","gram stain|gram stain negative","habitat|waste and sludge water","gram stain|gram stain negative","length|small| &gt; 0.19 &amp; &lt;= 3.8"],[5,17,10,4,10,17,18,12,13,4,17,20,26,4,8,7,15,6,12,23,15,12,12,10,2,7,17,43,14,14,15,13,18,12],[3,9,4,10,10,3,2,8,7,16,42,9,3,25,20,21,13,22,13,12,7,10,4,6,4,2,1,11,11,11,4,6,4,9],[7,14,20,1,14,49,85,27,35,1,10,40,73,1,9,5,22,4,21,40,48,25,16,31,0,28,42,58,29,33,46,27,42,30],[75,61,65,84,130,95,59,117,109,138,105,91,58,130,122,126,109,127,110,89,95,118,134,119,149,118,97,53,106,102,95,114,95,109],[0.001,0,0.001,0.001,0,0,0.005,0,0,0.001,0.001,0,0,0.004,0.003,0.001,0,0.002,0.001,0,0.002,0,0,0.001,0.001,0,0,0,0.001,0.002,0,0,0,0.001],[0.055,0.001,0.041,0.041,0.002,0.001,0.064,0.005,0.007,0.058,0.051,0.01,0.011,0.08799999999999999,0.047,0.037,0.007,0.047,0.063,0.015,0.076,0.027,0,0.027,0.08400000000000001,0.03,0,0.033,0.05,0.076,0.005,0.002,0,0.08400000000000001],[17.86,8.23,8.119999999999999,33.6,9.289999999999999,10.99,6.25,6.5,5.78,34.5,4.25,5.06,6.89,20.8,5.42,8.4,5.72,8.66,4.84,4.26,4.24,5.66,25.12,6.4,166.11,14.75,39.26,3.57,4.65,3.93,7.74,9.15,10.18,4.84],[3.51,3.04,2.3,3.41,3.3,3.07,1.4,2.42,2.14,3.63,1.8,2.12,1.99,2.23,1.87,2.44,2.39,2.26,1.94,1.93,1.62,2.2,7.24,2.16,6.92,2.91,5.06,1.67,1.91,1.63,2.43,3.19,3.25,1.87],[90.91,22.26,28.74,330.9,26.15,39.31,27.95,17.45,15.64,327.85,10.04,12.07,23.89,193.96,15.7,28.94,13.68,33.19,12.05,9.41,11.1,14.55,87.23,18.96,3985.93,74.88,304.68,7.64,11.33,9.5,24.65,26.26,31.91,12.58],["","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":34,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inBSDB_annotated","targets":6},{"name":"inBSDB_noAnnotated","targets":7},{"name":"notInBSDB_annotated","targets":8},{"name":"notInBSDB_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,34,50,100]}},"evals":[],"jsHooks":[]}</script><p>species:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_species_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span>, <span class="va">background_sigs_sp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">en_sp_df</span> <span class="op">&lt;-</span> <span class="va">en_sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_sp_df</span>, page_len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-8393b7f739eaa172d600" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8393b7f739eaa172d600">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"64\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"68\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"285\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"91\" data-max=\"429\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.016\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.099\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.93\" data-max=\"387.73\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.73\" data-max=\"23.83\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.34\" data-max=\"9054.43\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["vagina_species_DOWN_premature birth","mouth_species_UP_chronic kidney disease","mouth_species_UP_chronic kidney disease","mouth_species_DOWN_squamous cell carcinoma","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_Eczema","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_Graves disease","feces_species_UP_hypertension","feces_species_UP_hypertension","feces_species_UP_hypertension","feces_species_UP_irritable bowel syndrome","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_unipolar depression","feces_species_DOWN_acute lymphoblastic leukemia","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_psychosis","feces_species_DOWN_psychosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis"],["vagina","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["DOWN","UP","UP","DOWN","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN"],["premature birth","chronic kidney disease","chronic kidney disease","squamous cell carcinoma","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","eczema","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","graves disease","hypertension","hypertension","hypertension","irritable bowel syndrome","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","psychosis","psychosis","psychosis","psychosis","psychosis","psychosis","psychosis","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","unipolar depression","acute lymphoblastic leukemia","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","psychosis","psychosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis"],["arrangement|cell chain","aerophilicity|facultatively anaerobic","arrangement|cell chain","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|digestive system","habitat|human microbiome","habitat|large intestine","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","hemolysis|gamma","shape|bacillus","animal pathogen|TRUE","antimicrobial sensitivity|TRUE","biofilm formation|TRUE","extreme environment|FALSE","host-associated|TRUE","motility|TRUE","plant pathogenicity|FALSE","spore formation|FALSE","coding genes|average| &gt; 600 &amp; &lt;= 6000","genome size|large| &gt; 998123 &amp; &lt;= 6997434","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","mutation rate per site per generation|slow| &gt; 0.78 &amp; &lt;= 2.92","mutation rate per site per year|medium| &gt; 7.5 &amp; &lt;= 20","mutation rate per site per year|slow| &gt; 0.08 &amp; &lt;= 7.5","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","aerophilicity|anaerobic","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","spore shape|endospore","health associated|FALSE","gram stain|gram stain positive","habitat|human gut microbiome","habitat|waste and sludge water","spore shape|endospore","extreme environment|FALSE","motility|TRUE","plant pathogenicity|FALSE","spore formation|TRUE","aerophilicity|aerobic","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain positive","habitat|colonization of host","habitat|feces","shape|staphylococcus","antimicrobial sensitivity|FALSE","biofilm formation|TRUE","host-associated|TRUE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","optimal ph|acidic| &gt; 1.64 &amp; &lt;= 6","habitat|feces","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|cell chain","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|feces","habitat|human microbiome","habitat|oral","hemolysis|beta","shape|coccus","biofilm formation|TRUE","extreme environment|FALSE","host-associated|TRUE","plant pathogenicity|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|digestive system","habitat|feces","habitat|human microbiome","mutation rate per site per generation|slow| &gt; 0.78 &amp; &lt;= 2.92","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|feces","habitat|oral","hemolysis|beta","antimicrobial sensitivity|TRUE","biofilm formation|TRUE","host-associated|TRUE","motility|TRUE","plant pathogenicity|TRUE","aerophilicity|anaerobic","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","biofilm formation|TRUE","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|aerobic","arrangement|cell chain","habitat|environmental system","habitat|free-living","shape|bacillus","extreme environment|TRUE","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","aerophilicity|anaerobic","gram stain|gram stain positive","habitat|digestive system","habitat|feces","host-associated|TRUE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|digestive system","aerophilicity|aerobic","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","aerophilicity|anaerobic","biosafety level|biosafety level 1","habitat|human gut microbiome","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","aerophilicity|anaerobic","arrangement|paired cells","gram stain|gram stain positive","habitat|free-living","shape|bacillus","extreme environment|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","shape|bacillus","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|free-living","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain variable","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","animal pathogen|FALSE","biofilm formation|FALSE"],[5,5,7,20,5,4,4,12,15,8,18,21,23,14,21,14,16,10,21,22,10,22,19,19,19,24,2,2,3,10,11,7,6,5,7,4,12,5,5,6,15,5,13,5,18,27,40,47,31,30,4,13,11,51,48,64,7,9,12,14,9,15,14,20,12,14,9,6,9,8,6,20,24,4,24,5,6,4,2,11,11,11,11,11,9,9,3,5,9,6,13,4,4,45,32,25,27,20,23,14,11,8,13,8,10,47,46,58,7,7,2,6,14,7,8,32,29,18,20,39,31,40,5,6,8,5,4,7,4,24,18,10,6,9,5,19,23,13,12,10,15,25,10,19,5,20,25,26,12,8,9,7,9,6,6,12,11,12,50,39,34,32,33,41,18,18,46,54,59,64,4,3,7,2,9,8,8,7,8,11,4],[3,3,1,0,1,2,2,14,11,18,8,5,3,12,5,12,10,16,5,4,16,4,7,7,7,2,24,24,23,16,1,5,6,7,5,8,3,10,10,9,0,10,2,10,54,45,32,25,41,42,68,59,61,21,24,8,65,3,13,11,16,10,11,5,13,11,16,19,16,17,19,5,1,21,1,2,1,3,5,3,3,3,3,3,5,5,11,9,5,8,1,10,10,15,28,35,33,40,37,46,49,52,47,52,50,13,14,2,12,12,17,13,5,12,11,12,15,26,24,5,13,4,1,3,5,8,9,6,9,4,10,18,22,19,23,36,32,42,43,45,40,3,18,9,23,8,3,2,0,4,3,5,3,6,6,0,1,0,21,32,37,39,38,30,53,53,25,17,12,7,4,5,14,19,12,13,13,14,13,10,17],[13,26,23,200,73,35,35,40,53,42,80,162,106,87,160,125,134,28,237,233,27,210,150,179,179,285,0,1,1,36,211,71,34,34,43,9,166,35,20,44,230,25,206,16,31,68,144,148,93,87,2,31,23,207,186,253,6,102,33,45,39,32,73,155,106,100,33,11,27,36,26,231,224,7,277,73,103,35,0,34,47,35,76,161,106,102,12,30,132,27,231,27,7,182,142,90,89,58,87,26,28,17,37,9,22,204,202,244,40,41,0,3,159,26,38,192,151,60,91,205,191,259,74,38,32,34,21,43,12,205,141,30,20,41,12,61,89,27,28,16,37,209,40,168,2,155,229,279,209,104,106,71,100,33,33,231,229,281,180,138,84,87,49,73,21,21,129,201,193,241,3,5,37,1,69,32,31,18,42,85,12],[177,276,279,91,354,392,392,384,371,382,344,262,318,337,264,299,290,396,187,191,397,214,274,245,245,139,424,423,423,388,211,351,388,388,379,413,253,384,399,375,189,394,213,403,361,324,248,244,299,305,390,361,369,185,206,139,386,321,383,371,377,384,343,261,310,316,383,405,389,380,390,185,192,409,139,352,322,390,426,389,376,388,347,262,317,321,411,393,291,396,192,396,416,200,240,292,293,324,295,356,354,365,345,373,360,178,180,138,387,386,427,424,268,401,389,204,245,336,305,191,205,137,354,389,388,386,399,377,408,208,272,383,393,372,401,333,305,367,366,378,357,209,378,250,416,263,189,139,211,316,314,349,320,387,387,189,191,139,199,241,295,292,330,306,358,358,250,178,186,138,429,427,378,414,346,383,384,397,373,330,403],[0,0,0,0.001,0.001,0.001,0.001,0,0,0.004,0,0,0,0,0,0.01,0.002,0,0.008999999999999999,0.002,0,0,0,0.002,0.002,0.004,0.003,0.008999999999999999,0.001,0,0.004,0.002,0,0.002,0,0,0.002,0.008,0.001,0.004,0,0.002,0.004,0,0,0,0.002,0,0.001,0.001,0.006,0.01,0.008,0.003,0.002,0,0.001,0,0,0,0.001,0,0,0,0.016,0.001,0,0,0,0.002,0.006,0.012,0,0.002,0.001,0.003,0.001,0.002,0,0,0,0,0,0.003,0.003,0.002,0.01,0.003,0.013,0,0.003,0.013,0,0,0.013,0.003,0.001,0.001,0.008999999999999999,0,0.008999999999999999,0.012,0.008999999999999999,0.001,0.006,0,0,0,0.002,0.002,0.002,0,0.002,0,0,0.002,0,0,0.002,0,0.004,0,0.001,0,0,0.003,0.004,0,0.001,0,0.002,0,0.004,0.002,0.003,0.001,0.003,0,0.001,0,0,0,0,0.004,0,0,0,0.002,0,0.003,0.001,0.002,0,0,0,0.001,0.008,0.008999999999999999,0,0.003,0,0,0,0,0,0,0,0,0,0,0,0,0.003,0.006,0.006,0,0,0,0.001,0.002,0.005],[0.017,0.017,0,0.077,0.03,0.03,0.03,0,0,0.022,0,0,0,0.003,0,0.046,0.014,0,0.043,0.013,0,0.003,0.002,0.013,0.013,0.02,0.018,0.043,0.005,0.001,0.061,0.044,0.008999999999999999,0.046,0.008999999999999999,0.008999999999999999,0.043,0.099,0.029,0.056,0.016,0.043,0.056,0.018,0.003,0.005,0.025,0.001,0.014,0.013,0.058,0.077,0.07199999999999999,0.032,0.025,0.001,0.019,0.039,0,0,0.006,0,0.001,0.001,0.095,0.008,0.002,0.002,0.001,0.012,0.04,0.077,0,0.015,0.006,0.091,0.08400000000000001,0.08400000000000001,0.023,0,0,0,0,0.028,0.028,0.028,0.081,0.028,0.092,0.004,0.028,0.092,0.004,0.003,0.09,0.037,0.008999999999999999,0.014,0.074,0.006,0.074,0.08699999999999999,0.074,0.01,0.059,0.006,0.007,0,0.029,0.029,0.029,0,0.029,0.008,0.008,0.029,0.01,0.006,0.029,0,0.056,0.007,0.094,0.005,0,0.08799999999999999,0.089,0.008999999999999999,0.025,0.006,0.05,0.005,0.061,0.05,0.053,0.027,0.043,0.016,0.027,0.016,0.016,0.001,0.008,0.057,0.001,0.008,0.005,0.03,0.008999999999999999,0.04,0.011,0.026,0.008999999999999999,0.008999999999999999,0.008999999999999999,0.015,0.09,0.09,0.003,0.024,0,0.002,0,0,0,0,0,0.002,0,0,0,0.011,0.044,0.073,0.07199999999999999,0.007,0.007,0.006,0.028,0.035,0.07199999999999999],[22.69,17.69,84.91,18.71,24.25,22.4,22.4,8.23,9.550000000000001,4.04,9.68,6.79,23,4.52,6.93,2.79,3.46,8.84,3.31,4.51,9.19,5.6,4.96,3.72,3.72,5.85,86.63,35.25,55.17,6.74,11,6.92,11.41,8.15,12.34,22.94,6.1,5.49,9.970000000000001,5.68,25.49,7.88,6.72,12.59,3.88,2.86,2.15,3.1,2.43,2.5,11.47,2.57,2.89,2.17,2.22,4.4,6.93,9.44,10.71,10.49,5.44,18,5.98,6.74,2.7,4.02,6.53,11.63,8.1,4.97,4.74,3.2,20.57,11.13,12.04,12.05,18.76,14.86,387.73,41.95,29.33,40.65,16.74,5.97,5.38,5.66,9.34,7.28,3.97,11,10.81,5.87,23.77,3.3,1.93,2.32,2.69,2.79,2.11,4.17,2.84,3.3,2.58,6.38,3.27,3.15,2.93,16.4,5.64,5.49,122.14,65.23,4.72,9,7.44,2.83,3.14,3.88,2.79,7.27,2.56,5.29,23.92,20.47,19.4,7.1,8.44,10.23,15.11,6.09,3.47,7.09,5.36,4.3,7.26,2.88,2.46,4.21,3.65,5.25,3.62,8.33,5.25,3.14,45.22,4.24,6.88,6.48,25.24,6.08,8.890000000000001,6.88,9.6,11.73,11.73,20.46,9.17,12.39,2.63,2.13,3.23,2.75,5.85,5.73,5.79,5.79,3.57,2.81,4.74,5.24,143,51.24,5.11,43.58,3.76,7.37,7.62,11.03,5.47,4.27,7.9],[4.87,4,10.01,1.12,2.79,3.96,3.96,3.56,4.16,1.66,4.06,2.51,6.77,2.02,2.56,1.26,1.53,3.67,1.23,1.53,3.81,1.9,2.04,1.53,1.53,1.36,4.05,3.09,5.52,2.85,1.41,2.14,3.49,2.46,3.75,5.83,1.69,1.78,3.12,1.93,1.52,2.5,1.5,3.85,2.03,1.66,1.3,1.83,1.44,1.48,2.06,1.27,1.34,1.26,1.31,2.05,2.26,2.51,4.53,4.49,2.25,7.48,2.61,2.48,1.19,1.77,2.68,3.89,3.28,2.01,1.74,1.18,2.76,3.02,1.61,2.29,2.23,3.2,16.6,11.16,7.9,10.83,4.56,1.64,1.76,1.86,2.3,2.29,1.3,3.56,1.4,1.73,5.98,1.78,1.12,1.32,1.54,1.53,1.19,2.03,1.33,1.36,1.28,2.36,1.46,1.65,1.56,3.94,2.1,2.05,5.65,14.68,1.67,3.27,2.82,1.42,1.63,2,1.48,2.81,1.3,1.85,2.75,4.92,6,2.2,2.4,3.29,4.08,2.08,1.56,3.01,1.96,1.83,2.36,1.55,1.37,2.02,1.73,2.25,1.83,2.48,2.27,1.39,8.32,1.82,2.04,1.52,1.48,1.79,2.36,2.12,2.55,3.58,3.58,1.2,1.17,0.73,1.52,1.28,1.91,1.63,3.36,3.35,2.9,2.9,2.1,1.57,2.47,2.33,23.83,9.539999999999999,1.94,3.78,1.53,2.84,2.94,3.97,2.14,1.76,2.31],[105.66,78.25,720.27,312.74,210.62,126.63,126.63,19,21.88,9.859999999999999,23.04,18.37,78.14,10.12,18.74,6.2,7.83,21.27,8.949999999999999,13.31,22.18,16.54,12.06,9.029999999999999,9.029999999999999,25.12,1854.24,402.58,551.28,15.93,85.95999999999999,22.43,37.31,27.06,40.57,90.29000000000001,21.93,16.95,31.94,16.72,428.73,24.81,30.15,41.15,7.42,4.93,3.58,5.25,4.09,4.24,63.85,5.19,6.24,3.75,3.76,9.43,21.27,35.54,25.35,24.5,13.12,43.29,13.7,18.31,6.1,9.140000000000001,15.91,34.79,20.03,12.31,12.88,8.699999999999999,153.48,41.02,89.95,63.34,157.62,69.05,9054.43,157.65,108.95,152.56,61.46,21.71,16.42,17.29,37.87,23.09,12.07,33.98,83.34,19.94,94.42,6.12,3.34,4.08,4.72,5.12,3.74,8.550000000000001,6.06,8.039999999999999,5.2,17.26,7.31,6.02,5.5,68.19,15.15,14.72,2641.1,289.94,13.35,24.78,19.63,5.66,6.04,7.51,5.29,18.82,5.04,15.09,207.74,85.16,62.76,22.89,29.68,31.83,56.02,17.85,7.72,16.72,14.69,10.12,22.37,5.35,4.42,8.77,7.69,12.26,7.16,28.02,12.15,7.11,245.72,9.859999999999999,23.13,27.68,429.03,20.59,33.44,22.3,36.15,38.4,38.4,347.89,71.7,210.77,4.55,3.55,5.46,4.66,10.18,9.789999999999999,11.57,11.57,6.07,5.03,9.1,11.74,857.9400000000001,275.23,13.45,502.04,9.27,19.08,19.78,30.67,13.94,10.39,27.07],["","","","*","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","*","","*","","","","","","","","","","","","","","","","","","","","","","",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inSet_annotated<\/th>\n      <th>inSet_noAnnotated<\/th>\n      <th>notInSet_annotated<\/th>\n      <th>notInSet_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":181,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inSet_annotated","targets":6},{"name":"inSet_noAnnotated","targets":7},{"name":"notInSet_annotated","targets":8},{"name":"notInSet_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,100,181]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">en_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">en_sp_df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_sp_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">en_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">en_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span></span>
<span><span class="va">en_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="heatmap-up">Heatmap UP<a class="anchor" aria-label="anchor" href="#heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>bsdb_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span></span>
<span><span class="va">dat_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span></span></code></pre></div>
<p>Data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_group) by genus</span></span>
<span><span class="va">summary_up_freq</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_up</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span>,<span class="va">summary_category_up</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_up</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span>,<span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span></span>
<span>            n <span class="op">=</span> <span class="va">x</span>, begin <span class="op">=</span> <span class="fl">0</span>, option <span class="op">=</span> <span class="st">"C"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_up</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rank_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">'gray50'</span>, species <span class="op">=</span> <span class="st">'gray80'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_anno_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_up_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_up</span> <span class="op">&lt;-</span> <span class="va">ht1_up</span> <span class="op">+</span> <span class="va">ht2_up</span> <span class="op">+</span> <span class="va">row_anno_up</span></span>
<span><span class="va">lgd_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rank_col</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Rank"</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_up</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-17-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="heatmap-down">Heatmap Down<a class="anchor" aria-label="anchor" href="#heatmap-down"></a>
</h2>
<p>Data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_grodown) by genus</span></span>
<span><span class="va">summary_down_freq</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_down</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span>,<span class="va">summary_category_down</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_down</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span>,<span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lgd &lt;- Legend(col_fun = color_fun, title = "% (col)")</span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_down</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">row_anno_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_down_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_down</span> <span class="op">&lt;-</span> <span class="va">ht1_down</span> <span class="op">+</span> <span class="va">ht2_down</span> <span class="op">+</span> <span class="va">row_anno_down</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_down</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-19-1.png" width="864"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">520</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">480</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">x</span>, ncol <span class="op">=</span> <span class="fl">100</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lay</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">52</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, layout_matrix <span class="op">=</span> <span class="va">lay</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-20-1.png" width="1920"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-01</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-02-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@47ba4db)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-02-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.1    <span style="color: #555555;">2023-10-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.15   <span style="color: #555555;">2022-05-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.1    <span style="color: #555555;">2024-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.31     <span style="color: #555555;">2023-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  forcats            1.0.0    <span style="color: #555555;">2023-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.4.4    <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra        * 2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ontologyIndex      2.11     <span style="color: #555555;">2023-05-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6    <span style="color: #555555;">2021-05-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.2    <span style="color: #555555;">2022-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-02-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.41     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
