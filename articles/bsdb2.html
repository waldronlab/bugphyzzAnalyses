<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-throughput analysis with BSDB sigs â€¢ bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="High-throughput analysis with BSDB sigs">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
    <li>
      <a href="../articles/high_throughput_bsea_bsdb.html">High-throughput BSEA with BugSigDB sets</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/bsdb2.html">BSDB 2</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bsdb2_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="bsdb2_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="bsdb2_files/datatables-binding-0.31/datatables.js"></script><link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="bsdb2_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="bsdb2_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="bsdb2_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="bsdb2_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="bsdb2_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="bsdb2_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="bsdb2_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="bsdb2_files/selectize-0.12.0/selectize.min.js"></script><link href="bsdb2_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="bsdb2_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>High-throughput analysis with BSDB sigs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/bsdb2.Rmd" class="external-link"><code>vignettes/articles/bsdb2.Rmd</code></a></small>
      <div class="hidden name"><code>bsdb2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://zenodo.org/records/7622129/files/waldronlab/TypicalMicrobiomeSignaturesExports-v1.0.1.zip?download=1"</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"tms.zip"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">url</span>, destfile <span class="op">=</span> <span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">temp_file</span>, exdir <span class="op">=</span> <span class="va">temp_dir</span>, junkpaths <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">csv_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_dir</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">csv_files</span>,  <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>            names_to <span class="op">=</span> <span class="st">"Body site"</span>, values_to <span class="op">=</span> <span class="st">"Prevalence"</span>,</span>
<span>            cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>            `Body site` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_(species|genus)_prevalence$"</span>, <span class="st">""</span>, <span class="va">`Body site`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^.*matrix_(.*).csv$"</span>, <span class="st">"\\1"</span>, <span class="va">csv_files</span><span class="op">)</span></span>
<span><span class="va">tms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">l</span>, .id <span class="op">=</span> <span class="st">"rank_agegroup"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"rank_agegroup"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rank"</span>, <span class="st">"Age group"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span>, remove <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span></span>
<span>        <span class="va">`Age group`</span>, <span class="va">`Rank`</span>, `NCBI ID` <span class="op">=</span> <span class="va">NCBI</span>, `Taxon name` <span class="op">=</span> <span class="va">name</span>,</span>
<span>        <span class="va">`Body site`</span>, <span class="va">Prevalence</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Age group`</span> <span class="op">==</span> <span class="st">"adult"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `Body site` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"stool"</span> <span class="op">~</span> <span class="st">"feces"</span>,</span>
<span>            <span class="va">`Body site`</span> <span class="op">==</span> <span class="st">"oralcavity"</span> <span class="op">~</span> <span class="st">"mouth"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">`Body site`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Prevalence</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tms</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 6</span></span></span>
<span><span class="co">#&gt;   `Age group` Rank  `NCBI ID` `Taxon name`   `Body site` Prevalence</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  vagina          0.063<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  mouth           0.302 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> adult       genus   1<span style="text-decoration: underline;">912</span>216 Cutibacterium  feces           0.032<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus skin            0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> adult       genus      <span style="text-decoration: underline;">1</span>279 Staphylococcus vagina          0.063<span style="text-decoration: underline;">2</span></span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"10.5281/zenodo.10407666"</span>, cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(healthy|control)"</span>, <span class="va">`Group 0 name`</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1433   50</span></span></code></pre></div>
<p>BugSigDB subsets by body site:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uberon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getOntology.html" class="external-link">getOntology</a></span><span class="op">(</span>onto <span class="op">=</span> <span class="st">"uberon"</span><span class="op">)</span></span>
<span><span class="va">body_sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tms</span><span class="op">$</span><span class="va">`Body site`</span><span class="op">)</span></span>
<span><span class="va">bsdb_subsets_by_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">body_sites</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bsdb_subsets_by_bodysite</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"skin"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">`Body site`</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/subsetByOntology.html" class="external-link">subsetByOntology</a></span><span class="op">(</span></span>
<span>            <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Body site"</span>, term <span class="op">=</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, ontology <span class="op">=</span> <span class="va">uberon</span> </span>
<span>        <span class="op">)</span></span>
<span>        </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bugphyzz:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="signatures">Signatures<a class="anchor" aria-label="anchor" href="#signatures"></a>
</h2>
<p>TypicalMicrobiomeSignatures:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"genus"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span><span class="va">tms_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">tms_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tms</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Body site`</span> <span class="op">==</span> <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">Rank</span> <span class="op">==</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`NCBI ID`</span><span class="op">)</span></span>
<span>        <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>BugSigDB:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UP"</span>, <span class="st">"DOWN"</span><span class="op">)</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span></span>
<span>    mode <span class="op">=</span> <span class="st">"list"</span>, </span>
<span>    length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">body_sites</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">directions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">index</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>                <span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"_"</span>, <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>            <span class="op">)</span></span>
<span>            <span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>                df <span class="op">=</span> <span class="va">bsdb_subsets_by_bodysite</span><span class="op">[[</span><span class="va">body_sites</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                colum <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="va">directions</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>,</span>
<span>                min.studies <span class="op">=</span> <span class="fl">1</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>, tax.level <span class="op">=</span> <span class="va">ranks</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>                exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">bsdb_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span></span></code></pre></div>
<p>Reference signatures:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">background_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">background_sigs</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sig_name</span></span>
<span>    <span class="va">bodysite_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">rank_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(\\w+)_(species|genus)_.*$"</span>, <span class="st">"\\2"</span>, <span class="va">sig_name</span><span class="op">)</span></span>
<span>    <span class="va">tms_sig_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">bodysite_name</span>, <span class="st">"_"</span>, <span class="va">rank_name</span><span class="op">)</span></span>
<span>    <span class="va">background_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">tms_sigs</span><span class="op">[[</span><span class="va">tms_sig_name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>bugphyzz signatures:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span>, <span class="st">"|genus"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"igc"</span>, <span class="st">"nas"</span>, <span class="st">"tas"</span>, <span class="st">"tax"</span>, <span class="st">"asr"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span>, <span class="st">"|species"</span><span class="op">)</span></span>
<span><span class="va">bp_sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span>, <span class="va">bp_sigs_sp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enrichment">Enrichment<a class="anchor" aria-label="anchor" href="#enrichment"></a>
</h2>
<p>genus:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_genus_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_gn</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_gn</span>, <span class="va">background_sigs_gn</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span>
<span><span class="va">en_gn_df</span> <span class="op">&lt;-</span> <span class="va">en_gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-76dbde2f54b77e3c2596" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-76dbde2f54b77e3c2596">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"109\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"115\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"78\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"30\" data-max=\"145\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.007\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.24\" data-max=\"126.43\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.23\" data-max=\"7.98\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.89\" data-max=\"3160.37\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["mouth_genus_UP_COVID-19","mouth_genus_UP_Down syndrome","mouth_genus_UP_gastric cancer","mouth_genus_UP_gastric cancer","mouth_genus_UP_irritable bowel syndrome","mouth_genus_UP_rheumatoid arthritis","mouth_genus_UP_smoking behavior","mouth_genus_UP_smoking behavior","mouth_genus_DOWN_irritable bowel syndrome","mouth_genus_DOWN_irritable bowel syndrome","mouth_genus_DOWN_rheumatoid arthritis","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_breast cancer","feces_genus_UP_cervical cancer","feces_genus_UP_chronic hepatitis C virus infection","feces_genus_UP_chronic hepatitis C virus infection","feces_genus_UP_chronic hepatitis C virus infection","feces_genus_UP_chronic hepatitis C virus infection","feces_genus_UP_colorectal cancer","feces_genus_UP_colorectal cancer","feces_genus_UP_colorectal cancer","feces_genus_UP_colorectal cancer","feces_genus_UP_colorectal carcinoma","feces_genus_UP_diabetic retinopathy","feces_genus_UP_Eczema","feces_genus_UP_Eczema","feces_genus_UP_Eczema","feces_genus_UP_endometriosis","feces_genus_UP_endometriosis","feces_genus_UP_endometriosis","feces_genus_UP_high fat diet","feces_genus_UP_high fat diet","feces_genus_UP_Mood disorder","feces_genus_UP_multiple myeloma","feces_genus_UP_pancreatic carcinoma","feces_genus_UP_psychosis","feces_genus_UP_psychosis","feces_genus_UP_thyroid carcinoma","feces_genus_UP_thyroid carcinoma","feces_genus_UP_thyroid carcinoma","feces_genus_DOWN_anxiety disorder","feces_genus_DOWN_anxiety disorder","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_colorectal cancer","feces_genus_DOWN_COVID-19","feces_genus_DOWN_COVID-19","feces_genus_DOWN_food allergy","feces_genus_DOWN_food allergy","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_gestational diabetes","feces_genus_DOWN_leukemia","feces_genus_DOWN_Population","feces_genus_DOWN_schizophrenia"],["mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],["UP","UP","UP","UP","UP","UP","UP","UP","DOWN","DOWN","DOWN","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN"],["covid-19","down syndrome","gastric cancer","gastric cancer","irritable bowel syndrome","rheumatoid arthritis","smoking behavior","smoking behavior","irritable bowel syndrome","irritable bowel syndrome","rheumatoid arthritis","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","cervical cancer","chronic hepatitis c virus infection","chronic hepatitis c virus infection","chronic hepatitis c virus infection","chronic hepatitis c virus infection","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal carcinoma","diabetic retinopathy","eczema","eczema","eczema","endometriosis","endometriosis","endometriosis","high fat diet","high fat diet","mood disorder","multiple myeloma","pancreatic carcinoma","psychosis","psychosis","thyroid carcinoma","thyroid carcinoma","thyroid carcinoma","anxiety disorder","anxiety disorder","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","covid-19","covid-19","food allergy","food allergy","gestational diabetes","gestational diabetes","gestational diabetes","gestational diabetes","gestational diabetes","gestational diabetes","leukemia","population","schizophrenia"],["shape|spirillum","aerophilicity|aerobic","habitat|waste and sludge water","length|average| &gt; 3.8 &amp; &lt;= 22","motility|TRUE","aerophilicity|anaerobic","aerophilicity|aerobic","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","habitat|waste and sludge water","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","hemolysis|gamma","motility|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","sphingolipid producing|TRUE","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","width|average| &gt; 0.9 &amp; &lt;= 3.5","aerophilicity|aerobic","gram stain|gram stain negative","hemolysis|gamma","motility|TRUE","sphingolipid producing|TRUE","gram stain|gram stain negative","gram stain|gram stain negative","hemolysis|gamma","length|small| &gt; 0.19 &amp; &lt;= 3.8","habitat|human urine","habitat|waste and sludge water","shape|elliptic","aerophilicity|facultatively anaerobic","shape|elliptic","sphingolipid producing|TRUE","gram stain|gram stain negative","gram stain|gram stain negative","aerophilicity|aerobic","cogem pathogenicity rating|cogem pathogenicity rating 1","aerophilicity|facultatively anaerobic","shape|pleiomorphic cell","motility|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","width|small| &gt; -0.01 &amp; &lt;= 0.9","aerophilicity|aerobic","gram stain|gram stain negative","hemolysis|gamma","motility|TRUE","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","width|small| &gt; -0.01 &amp; &lt;= 0.9","gram stain|gram stain negative","hemolysis|gamma","gram stain|gram stain negative","habitat|waste and sludge water","aerophilicity|aerobic","arrangement|single","gram stain|gram stain negative","motility|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","width|small| &gt; -0.01 &amp; &lt;= 0.9","sphingolipid producing|TRUE","animal pathogen|TRUE","hemolysis|gamma"],[4,7,5,2,17,29,11,4,10,4,18,12,22,28,14,17,4,6,6,4,5,44,94,109,59,4,10,19,25,14,4,10,5,5,3,3,16,15,12,10,6,4,8,12,12,29,61,76,39,11,40,40,57,15,12,5,3,7,6,7,7,4,28,28],[5,2,0,3,9,4,7,14,4,10,21,21,11,5,19,16,17,6,6,8,7,115,65,50,100,9,1,9,3,14,15,9,14,0,2,6,6,3,4,6,9,11,7,9,9,77,45,30,67,95,66,32,15,3,6,2,4,0,1,0,0,7,4,5],[1,14,21,0,14,35,21,1,20,1,11,13,45,78,26,32,1,14,12,7,6,7,20,39,16,1,47,42,74,28,3,26,5,13,7,2,42,46,16,31,12,4,24,29,33,10,30,46,14,0,20,28,48,46,27,17,6,53,29,36,40,1,75,67],[84,70,67,88,61,30,67,87,65,84,55,121,89,56,108,102,138,132,134,139,140,72,59,40,63,141,97,90,58,104,134,111,132,137,143,143,93,96,134,119,129,137,117,110,106,86,66,50,82,96,76,70,50,95,114,134,145,98,122,115,111,142,61,57],[0,0,0.001,0.002,0,0.001,0.003,0.003,0.001,0.001,0.001,0,0.001,0.003,0.007,0.002,0.001,0.001,0.001,0.005,0,0,0,0.003,0.006,0,0,0,0.001,0.003,0.004,0.003,0.003,0,0.002,0.001,0,0,0,0.001,0.003,0.003,0.003,0.001,0.003,0.002,0,0,0,0.001,0.006,0,0,0,0,0.001,0.004,0.001,0,0,0,0,0,0.001],[0.013,0.022,0.078,0.078,0.001,0.038,0.097,0.097,0.041,0.041,0.08699999999999999,0.019,0.019,0.049,0.094,0.049,0.07000000000000001,0.025,0.019,0.081,0.019,0.015,0,0.073,0.095,0.01,0.014,0.018,0.018,0.058,0.1,0.091,0.091,0.001,0.062,0.089,0.018,0.003,0,0.027,0.07099999999999999,0.07099999999999999,0.07099999999999999,0.065,0.089,0.024,0.008999999999999999,0.01,0.008999999999999999,0.011,0.07199999999999999,0.012,0.003,0.002,0.002,0.01,0.045,0.012,0.01,0.005,0.005,0.005,0.027,0.055],[67.2,17.5,34.53,126.43,8.23,6.21,5.01,24.86,8.119999999999999,33.6,4.29,5.32,3.96,4.02,3.06,3.39,32.47,9.43,11.17,9.93,16.67,3.94,4.27,2.24,2.32,62.67,20.64,4.52,6.53,3.71,11.91,4.74,9.43,112.04,30.64,35.75,5.9,10.43,25.12,6.4,7.17,12.45,5.57,5.06,4.28,3.24,2.98,2.75,3.41,23.24,2.3,3.12,3.96,10.33,8.44,19.71,18.12,27.62,25.24,47.47,41.3,81.14,5.69,4.76],[6.28,3.28,1.83,5.06,3.04,1.96,1.73,2.59,2.3,3.41,1.74,2.14,1.76,1.46,1.36,1.54,3.43,2.68,3.12,2.4,4.07,1.68,2.35,1.29,1.23,6.33,2.57,1.89,1.88,1.59,2.43,1.75,2.43,5.87,4.39,5,2.16,2.88,7.24,2.16,2.18,2.74,1.84,1.94,1.66,1.48,1.67,1.54,1.71,1.35,1.23,1.65,1.98,2.85,2.91,3.54,3.29,1.55,2.92,2.65,2.31,7.98,1.89,1.73],[718.71,93.23999999999999,650.3,3160.37,22.26,19.7,14.57,238.88,28.74,330.9,10.57,13.23,8.869999999999999,11.06,6.9,7.46,307.6,33.19,40.02,41.08,68.18000000000001,9.210000000000001,7.75,3.89,4.39,620.42,166.02,10.84,22.7,8.69,58.36,12.85,36.61,2137.44,213.97,255.53,16.16,37.85,87.23,18.96,23.57,56.71,16.83,13.16,11.06,7.08,5.32,4.93,6.8,399.99,4.32,5.92,7.92,37.46,24.52,109.58,99.73,492.96,217.86,851.34,739.5,824.84,17.12,13.15],["","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","*","","","","","","","","*","","*","*","","",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inBSDB_annotated<\/th>\n      <th>inBSDB_noAnnotated<\/th>\n      <th>notInBSDB_annotated<\/th>\n      <th>notInBSDB_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":64,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inBSDB_annotated","targets":6},{"name":"inBSDB_noAnnotated","targets":7},{"name":"notInBSDB_annotated","targets":8},{"name":"notInBSDB_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,64,100]}},"evals":[],"jsHooks":[]}</script><p>species:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bsdb_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">bsdb_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_species_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">background_sigs_sp</span> <span class="op">&lt;-</span> <span class="va">background_sigs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">en_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">bsdb_sigs_sp</span>, <span class="va">background_sigs_sp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/microbeSetEnrichment.html">microbeSetEnrichment</a></span><span class="op">(</span>set <span class="op">=</span> <span class="va">.x</span>, reference <span class="op">=</span> <span class="va">.y</span>, sigs <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">en_sp_df</span> <span class="op">&lt;-</span> <span class="va">en_sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"bsdb_sig"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fdr</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>        remove <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p_value"</span>, <span class="st">"fdr"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span></span>
<span>        .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odds_ratio"</span>, <span class="st">"upper_ci"</span>, <span class="st">"lower_ci"</span><span class="op">)</span>, .funs <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)$"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Set"</span>, <span class="st">"BSDB"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">en_gn_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">en_sp_df</span>, page_len <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">en_sp_df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-c2fe53db093586081fa4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c2fe53db093586081fa4">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"164\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"220\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"285\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"135\" data-max=\"429\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.018\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.49\" data-max=\"143\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.73\" data-max=\"23.83\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.09\" data-max=\"2641.1\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["mouth_species_UP_chronic kidney disease","mouth_species_UP_chronic kidney disease","mouth_species_UP_Down syndrome","mouth_species_UP_Down syndrome","mouth_species_UP_Down syndrome","mouth_species_UP_oral squamous cell carcinoma","mouth_species_DOWN_arthritis","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_attention deficit hyperactivity disorder","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_breast cancer","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_chronic fatigue syndrome","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_colorectal cancer","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_COVID-19","feces_species_UP_Eczema","feces_species_UP_Eczema","feces_species_UP_Eczema","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_irritable bowel syndrome","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_multiple myeloma","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_obesity","feces_species_UP_Parkinson's disease","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_psychosis","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_schizophrenia","feces_species_UP_type ii diabetes mellitus","feces_species_UP_type ii diabetes mellitus","feces_species_UP_type ii diabetes mellitus","feces_species_UP_unipolar depression","feces_species_DOWN_Ankylosing spondylitis","feces_species_DOWN_Ankylosing spondylitis","feces_species_DOWN_antimicrobial agent","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_chronic fatigue syndrome","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal cancer","feces_species_DOWN_colorectal carcinoma","feces_species_DOWN_colorectal carcinoma","feces_species_DOWN_colorectal carcinoma","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_COVID-19","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Crohn's disease","feces_species_DOWN_Eczema","feces_species_DOWN_Eczema","feces_species_DOWN_Eczema","feces_species_DOWN_Eczema","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_inflammatory bowel disease","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_irritable bowel syndrome","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple myeloma","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_multiple sclerosis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_Nephrolithiasis","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_obesity","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_Parkinson's disease","feces_species_DOWN_psychosis","feces_species_DOWN_psychosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_pulmonary tuberculosis","feces_species_DOWN_schizophrenia","feces_species_DOWN_ulcerative colitis","feces_species_DOWN_ulcerative colitis","feces_species_DOWN_ulcerative colitis"],["mouth","mouth","mouth","mouth","mouth","mouth","mouth","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces","feces"],["species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species","species"],["UP","UP","UP","UP","UP","UP","DOWN","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","UP","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN","DOWN"],["chronic kidney disease","chronic kidney disease","down syndrome","down syndrome","down syndrome","oral squamous cell carcinoma","arthritis","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","attention deficit hyperactivity disorder","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","breast cancer","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","covid-19","eczema","eczema","eczema","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","parkinson's disease","psychosis","psychosis","psychosis","psychosis","psychosis","psychosis","psychosis","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","schizophrenia","type ii diabetes mellitus","type ii diabetes mellitus","type ii diabetes mellitus","unipolar depression","ankylosing spondylitis","ankylosing spondylitis","antimicrobial agent","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","chronic fatigue syndrome","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal cancer","colorectal carcinoma","colorectal carcinoma","colorectal carcinoma","covid-19","covid-19","covid-19","covid-19","covid-19","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","crohn's disease","eczema","eczema","eczema","eczema","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","inflammatory bowel disease","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","irritable bowel syndrome","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple myeloma","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","multiple sclerosis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","nephrolithiasis","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","obesity","parkinson's disease","parkinson's disease","parkinson's disease","parkinson's disease","parkinson's disease","parkinson's disease","parkinson's disease","parkinson's disease","psychosis","psychosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","pulmonary tuberculosis","schizophrenia","ulcerative colitis","ulcerative colitis","ulcerative colitis"],["aerophilicity|facultatively anaerobic","arrangement|cell chain","aerophilicity|aerobic","gram stain|gram stain positive","hemolysis|beta","hemolysis|beta","hemolysis|beta","habitat|digestive system","habitat|human microbiome","habitat|large intestine","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","hemolysis|gamma","shape|bacillus","animal pathogen|TRUE","antimicrobial sensitivity|TRUE","biofilm formation|TRUE","extreme environment|FALSE","host-associated|TRUE","motility|TRUE","plant pathogenicity|FALSE","spore formation|FALSE","coding genes|average| &gt; 600 &amp; &lt;= 6000","genome size|large| &gt; 998123 &amp; &lt;= 6997434","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","mutation rate per site per generation|slow| &gt; 0.78 &amp; &lt;= 2.92","mutation rate per site per year|medium| &gt; 7.5 &amp; &lt;= 20","mutation rate per site per year|slow| &gt; 0.08 &amp; &lt;= 7.5","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","aerophilicity|anaerobic","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","spore shape|endospore","health associated|FALSE","aerophilicity|aerobic","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|digestive system","habitat|free-living","shape|bacillus","animal pathogen|TRUE","biofilm formation|TRUE","host-associated|TRUE","motility|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","mutation rate per site per year|slow| &gt; 0.08 &amp; &lt;= 7.5","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","aerophilicity|anaerobic","biosafety level|biosafety level 2","gram stain|gram stain positive","habitat|digestive system","habitat|feces","habitat|human gut microbiome","spore shape|endospore","extreme environment|FALSE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","optimal ph|acidic| &gt; 1.64 &amp; &lt;= 6","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","extreme environment|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|aerobic","aerophilicity|facultatively anaerobic","arrangement|cell chain","arrangement|paired cells","biosafety level|biosafety level 2","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|feces","habitat|human microbiome","habitat|oral","hemolysis|beta","shape|coccus","biofilm formation|TRUE","extreme environment|FALSE","host-associated|TRUE","plant pathogenicity|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","gram stain|gram stain positive","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|colonization of host","aerophilicity|aerobic","arrangement|cell chain","habitat|environmental system","habitat|free-living","shape|bacillus","extreme environment|TRUE","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","arrangement|cell chain","gram stain|gram stain positive","habitat|digestive system","habitat|feces","animal pathogen|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","cogem pathogenicity rating|cogem pathogenicity rating 1","habitat|waste and sludge water","extreme environment|TRUE","habitat|digestive system","habitat|large intestine","spore shape|endospore","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","aerophilicity|anaerobic","arrangement|paired cells","cogem pathogenicity rating|cogem pathogenicity rating 1","habitat|digestive system","habitat|feces","habitat|free-living","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","animal pathogen|FALSE","biofilm formation|FALSE","extreme environment|FALSE","host-associated|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","arrangement|paired cells","habitat|human gut microbiome","biofilm formation|FALSE","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|waste and sludge water","spore shape|endospore","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|human microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","butyrate-producing bacteria|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","aerophilicity|anaerobic","arrangement|paired cells","biosafety level|biosafety level 1","gram stain|gram stain positive","gram stain|gram stain variable","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","animal pathogen|FALSE","biofilm formation|FALSE","butyrate-producing bacteria|TRUE","extreme environment|FALSE","host-associated|TRUE","plant pathogenicity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","shape|bacillus","aerophilicity|anaerobic","arrangement|paired cells","gram stain|gram stain positive","habitat|free-living","shape|bacillus","extreme environment|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","gram stain|gram stain negative","habitat|colonization of host","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","arrangement|cell chain","arrangement|paired cells","gram stain|gram stain positive","habitat|free-living","habitat|rumen","animal pathogen|FALSE","biofilm formation|TRUE","extreme environment|TRUE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","mutation rate per site per year|medium| &gt; 7.5 &amp; &lt;= 20","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","aerophilicity|anaerobic","gram stain|gram stain negative","habitat|digestive system","habitat|feces","habitat|human microbiome","habitat|large intestine","shape|bacillus","antimicrobial sensitivity|TRUE","extreme environment|FALSE","host-associated|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain positive","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","biofilm formation|FALSE","habitat|free-living","growth temperature|psychrophile| &gt; -10.01 &amp; &lt;= 25","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain variable","habitat|digestive system","habitat|human gut microbiome","habitat|large intestine","habitat|waste and sludge water","spore shape|endospore","animal pathogen|FALSE","biofilm formation|FALSE","host-associated|TRUE","habitat|human gut microbiome","habitat|waste and sludge water","biofilm formation|FALSE"],[5,7,12,10,7,7,5,5,4,4,12,15,9,18,22,23,14,21,15,16,10,22,23,10,23,19,19,19,25,2,2,3,10,11,7,6,5,7,4,44,35,65,104,98,48,9,101,82,26,148,40,164,6,32,54,25,48,29,36,17,18,57,51,70,7,11,6,6,20,25,17,14,12,18,41,48,14,15,9,16,16,22,14,16,9,6,10,8,9,23,27,5,27,34,26,20,16,18,15,9,7,14,9,35,34,42,42,7,7,2,6,14,7,8,9,23,14,19,14,29,30,5,4,4,5,6,8,25,8,5,4,7,4,75,20,24,34,42,9,17,17,13,39,11,83,23,99,4,4,4,21,27,19,13,21,21,16,17,13,9,10,9,12,9,3,34,8,9,5,7,26,9,23,21,2,21,17,22,10,8,8,9,18,7,3,30,28,28,35,13,11,13,13,7,7,15,25,10,19,5,20,25,26,12,8,9,7,9,6,6,12,11,12,7,9,16,4,2,11,6,6,20,22,2,7,38,22,22,32,12,15,33,27,40,43,50,12,33,18,14,12,11,17,7,4,3,7,2,9,8,8,7,8,11,4,15,10,9,7],[4,2,3,5,8,9,4,1,2,2,16,13,19,10,6,5,14,7,13,12,18,6,5,18,5,9,9,9,3,26,26,25,18,1,5,6,7,5,8,182,191,161,122,128,178,217,125,144,200,78,186,62,220,194,27,56,33,52,45,64,63,24,30,11,74,6,11,11,35,30,38,41,43,37,14,7,15,14,20,13,13,7,15,13,20,23,19,21,20,6,2,24,2,10,18,24,28,26,29,35,37,30,35,9,10,2,67,12,12,17,13,5,12,11,25,11,20,15,20,5,4,5,6,6,1,9,7,1,5,8,9,6,9,51,106,102,92,84,117,109,109,113,87,115,43,103,27,3,3,3,48,42,50,56,48,19,24,23,27,31,30,31,28,31,37,6,4,3,7,5,9,26,12,14,33,14,18,13,25,27,27,26,17,28,32,5,7,7,0,6,8,6,6,12,12,4,3,18,9,23,8,3,2,0,4,3,5,3,6,6,0,1,0,16,14,7,19,21,12,17,17,3,1,21,16,18,34,34,24,44,41,23,29,16,13,6,45,24,39,43,45,46,40,50,4,5,14,19,12,13,13,14,13,10,17,1,24,25,27],[26,23,52,81,21,23,25,73,35,35,40,53,41,80,161,106,87,160,124,134,28,236,232,27,209,150,179,179,284,0,1,1,36,211,71,34,34,43,9,33,27,52,122,74,47,2,125,95,21,172,23,218,0,24,184,67,147,56,84,24,35,207,186,250,6,100,34,33,59,86,24,25,14,34,211,255,33,45,39,32,73,155,106,99,33,11,27,36,25,230,223,7,276,189,153,95,62,91,25,30,18,36,7,211,208,254,78,40,41,0,3,159,26,38,38,157,64,92,82,214,268,39,21,26,74,38,50,272,32,34,21,43,12,171,30,32,50,74,2,23,23,14,73,7,190,35,232,39,36,12,59,85,22,13,31,96,62,92,27,30,29,18,38,9,2,265,70,100,34,32,196,34,131,156,1,94,61,88,31,31,17,41,77,10,2,214,213,189,259,103,106,68,99,32,32,153,209,40,168,2,155,229,279,209,104,106,71,100,33,33,231,229,281,42,40,169,3,0,89,27,27,232,285,0,38,189,91,58,80,27,24,137,118,210,204,251,34,151,64,26,28,14,35,9,3,5,37,1,69,32,31,18,42,85,12,227,30,17,10],[275,278,242,213,273,279,277,354,392,392,383,370,382,343,262,317,336,263,299,289,395,187,191,396,214,273,244,244,139,423,422,422,387,211,351,388,388,379,413,322,328,303,233,281,308,353,230,260,334,183,332,137,355,331,203,320,240,331,303,363,352,180,201,137,381,319,385,386,334,307,369,368,379,359,182,138,382,370,376,383,342,260,309,316,382,404,388,379,390,185,192,408,139,203,239,297,330,301,367,362,374,356,385,181,184,138,275,387,386,427,424,268,401,389,367,248,341,313,323,191,137,386,404,399,354,391,379,139,388,386,399,377,408,196,337,335,317,293,365,344,344,353,294,360,177,332,135,386,389,413,324,298,361,370,352,307,341,311,376,373,374,385,365,394,401,138,352,322,388,390,202,364,267,242,397,304,337,310,367,367,381,357,321,388,396,184,185,209,139,317,314,352,321,388,388,267,209,378,250,416,263,189,139,211,316,314,349,320,387,387,189,191,139,382,384,255,421,424,335,397,397,192,139,424,386,200,298,331,309,362,365,252,271,179,185,138,353,236,323,361,359,373,352,378,429,427,378,414,346,383,384,397,373,330,403,192,380,393,400],[0.001,0,0,0.002,0,0,0.001,0.001,0.001,0.001,0,0,0.002,0,0,0,0.001,0,0.008,0.006,0,0.013,0.003,0,0.001,0.001,0.007,0.007,0.008999999999999999,0.004,0.011,0.001,0,0.004,0.002,0,0.002,0,0,0,0.002,0,0.003,0,0.008,0.004,0.014,0.01,0.013,0,0,0.004,0.003,0.003,0.001,0.005,0,0,0,0,0.001,0.003,0.01,0,0.003,0.001,0.002,0.002,0,0,0,0,0,0,0.002,0,0,0,0.002,0,0,0,0.008999999999999999,0,0.001,0,0,0.004,0,0.008999999999999999,0,0,0.001,0,0.008999999999999999,0.003,0.002,0.011,0,0.01,0.008,0,0,0.001,0.001,0,0.001,0.002,0.002,0.002,0,0.002,0,0,0.006,0.001,0.001,0,0.007,0,0.005,0.001,0.001,0.003,0.001,0.002,0,0,0,0.003,0.004,0,0.001,0.008,0.013,0.002,0.001,0.002,0,0.011,0.011,0.008,0.008,0.001,0.004,0.008999999999999999,0.001,0.002,0.002,0,0.003,0.003,0,0,0,0,0,0.007,0,0.005,0.001,0,0.001,0,0.006,0.008,0,0,0.002,0,0.003,0.004,0,0.014,0.018,0,0,0,0.001,0.008,0,0.012,0,0,0.004,0,0.002,0,0,0,0.003,0,0,0.001,0.001,0,0,0,0.004,0,0,0,0.002,0,0.003,0.001,0.002,0,0,0,0.001,0.008,0.008999999999999999,0.008,0,0.005,0,0.003,0.005,0.004,0.004,0.001,0.002,0.003,0.005,0.005,0.01,0,0,0.001,0,0.001,0.007,0.008999999999999999,0,0,0.008,0.006,0.007,0,0.002,0,0,0.002,0,0,0.003,0.006,0.006,0,0,0,0.001,0.002,0.005,0.001,0,0,0],[0.035,0,0,0.08500000000000001,0.005,0.021,0.059,0.03,0.03,0.03,0,0,0.012,0,0,0,0.007,0.002,0.042,0.038,0,0.059,0.022,0,0.006,0.007,0.04,0.04,0.042,0.024,0.05,0.007,0.002,0.061,0.044,0.008999999999999999,0.046,0.008999999999999999,0.008999999999999999,0.008,0.036,0.001,0.036,0,0.068,0.041,0.096,0.078,0.094,0.001,0.001,0.036,0.036,0.036,0.02,0.056,0.007,0.002,0.002,0.003,0.02,0.04,0.093,0.002,0.033,0.058,0.081,0.081,0.005,0.005,0,0.001,0,0,0.029,0.006,0,0,0.013,0,0,0.001,0.056,0.005,0.005,0.004,0.001,0.029,0.001,0.054,0,0.005,0.008999999999999999,0.004,0.079,0.035,0.02,0.08400000000000001,0,0.08400000000000001,0.079,0.003,0,0.012,0.02,0,0.066,0.029,0.029,0.029,0,0.029,0.008,0.008,0.096,0.026,0.024,0.007,0.096,0.007,0.092,0.074,0.074,0.099,0.094,0.08699999999999999,0.017,0.044,0,0.08799999999999999,0.089,0.008999999999999999,0.025,0.08,0.095,0.04,0.03,0.04,0.013,0.08699999999999999,0.08699999999999999,0.08,0.08,0.031,0.057,0.08,0.03,0.082,0.082,0.004,0.07000000000000001,0.07000000000000001,0,0.001,0,0.006,0.008,0.07199999999999999,0,0.058,0.016,0.006,0.01,0,0.068,0.074,0.011,0.011,0.057,0.002,0.027,0.03,0.002,0.078,0.097,0,0,0,0.006,0.051,0.003,0.07099999999999999,0.001,0.002,0.03,0.002,0.014,0.002,0,0.004,0.047,0,0.004,0.01,0.01,0.007,0.001,0.008,0.057,0.001,0.008,0.005,0.03,0.008999999999999999,0.04,0.011,0.026,0.008999999999999999,0.008999999999999999,0.008999999999999999,0.015,0.09,0.09,0.065,0.014,0.047,0.014,0.043,0.047,0.047,0.047,0.042,0.042,0.043,0.047,0.064,0.095,0.001,0,0.019,0.001,0.011,0.078,0.095,0.008,0.002,0.098,0.094,0.098,0.004,0.043,0.003,0.003,0.043,0,0.011,0.044,0.073,0.07199999999999999,0.007,0.007,0.006,0.028,0.035,0.07199999999999999,0.1,0.01,0.004,0.005],[13.22,42.3,18.62,5.26,11.38,9.43,13.85,24.25,22.4,22.4,7.18,8.06,4.41,7.72,5.97,13.76,3.86,4.93,2.78,2.88,7.84,2.91,3.79,8.15,4.71,3.84,2.88,2.88,4.08,79.91,32.46,50.64,5.97,11,6.92,11.41,8.15,12.34,22.94,2.36,2.23,2.35,1.63,2.91,1.77,7.32,1.49,1.56,2.07,2.02,3.1,1.66,20.96,2.27,2.21,2.13,2.37,3.3,2.89,4.02,2.87,2.07,1.84,3.49,6.01,5.85,6.18,6.38,3.23,2.97,6.88,5.03,7.55,5.14,2.53,3.71,10.8,8.81,4.34,14.73,5.77,5.27,2.72,3.93,5.21,9.58,7.56,4.01,7.02,3.08,11.62,12.14,6.8,3.65,2.26,2.61,3.04,2.29,7.59,3.1,3.93,4.61,14.14,3.34,3.01,11.41,2.21,5.64,5.49,122.14,65.23,4.72,9,7.44,3.48,3.3,3.73,4.31,2.76,5.18,3.83,9.9,12.83,10.23,23.92,6.86,8.66,12.78,19.4,7.1,8.44,10.23,15.11,1.69,2.12,2.46,2.34,1.98,14.04,2.33,2.33,2.9,1.81,4.92,1.8,2.12,2.13,13.2,14.41,45.89,2.4,2.25,6.24,6.61,4.97,3.53,3.67,2.5,6.71,3.61,4.3,6.21,4.12,12.71,16.26,2.95,10.06,9.66,8.15,17.06,2.98,3.71,3.91,2.33,24.06,4.85,5.22,5.96,4.74,3.51,6.64,3.01,4.41,9.699999999999999,18.56,5.16,3.47,4.42,38.17,6.67,4.07,11.22,7.03,7.07,7.07,6.54,8.33,5.25,3.14,45.22,4.24,6.88,6.48,25.24,6.08,8.890000000000001,6.88,9.6,11.73,11.73,20.46,9.17,12.39,3.98,6.17,3.45,29.54,98.72,3.45,5.19,5.19,5.52,10.73,98.72,4.44,2.23,2.12,3.69,5.15,3.66,5.56,2.64,2.14,2.13,3,4.58,2.77,2.15,2.33,4.52,3.42,6.37,4.27,5.88,143,51.24,5.11,43.58,3.76,7.37,7.62,11.03,5.47,4.27,7.9,12.69,5.28,8.32,10.37],[3.34,8.31,5.07,1.74,3.76,3.22,3.49,2.79,3.96,3.96,3.17,3.63,1.88,3.43,2.37,5.1,1.77,2.05,1.29,1.32,3.31,1.15,1.41,3.43,1.76,1.7,1.27,1.27,1.21,3.74,2.85,5.08,2.57,1.41,2.14,3.49,2.46,3.75,5.83,1.45,1.31,1.56,1.16,2.01,1.14,1.57,1.06,1.09,1.13,1.43,1.8,1.16,1.17,1.3,1.33,1.24,1.46,1.93,1.75,2.04,1.53,1.23,1.12,1.79,1.96,2.11,2.15,2.22,1.75,1.66,3.4,2.42,3.28,2.64,1.33,1.64,4.8,3.99,1.85,6.51,2.66,2.2,1.27,1.83,2.2,3.25,3.2,1.66,2.9,1.23,2.73,3.59,1.59,1.76,1.2,1.38,1.55,1.2,3.61,1.36,1.54,2.24,4.97,1.56,1.45,2.72,1.39,2.1,2.05,5.65,14.68,1.67,3.27,2.82,1.51,1.57,1.79,2.11,1.34,1.96,1.32,2.74,3.36,2.72,2.75,2.32,3.01,1.71,6,2.2,2.4,3.29,4.08,1.12,1.16,1.39,1.43,1.26,2.99,1.2,1.2,1.32,1.14,1.86,1.18,1.2,1.33,2.85,3.1,9.24,1.34,1.31,3.15,2.91,2.64,1.82,1.84,1.28,3.11,1.57,1.91,2.58,1.94,4.71,2.63,1.21,2.95,2.57,2.46,5.12,1.36,1.61,1.89,1.15,2.13,2.37,2.55,2.89,2.09,1.47,2.63,1.32,2.17,3.43,2.99,1.96,1.48,1.89,2.32,2.47,1.6,4.12,2.6,2.6,2.6,2.13,2.48,2.27,1.39,8.32,1.82,2.04,1.52,1.48,1.79,2.36,2.12,2.55,3.58,3.58,1.2,1.17,0.73,1.55,2.51,1.39,6.17,4.6,1.47,1.89,1.89,1.62,1.43,4.6,1.72,1.23,1.18,2.02,2.87,1.73,2.7,1.49,1.21,1.15,1.56,1.92,1.34,1.22,1.25,2.19,1.62,2.73,2.2,2.1,23.83,9.539999999999999,1.94,3.78,1.53,2.84,2.94,3.97,2.14,1.76,2.31,1.66,2.31,3.37,3.66],[52.29,215.48,68.31,15.86,34.42,27.65,54.89,210.62,126.63,126.63,16.24,17.86,10.39,17.36,15.03,37.09,8.4,11.86,6.02,6.25,18.57,7.31,10.15,19.37,12.62,8.699999999999999,6.51,6.51,13.74,1706.96,369.8,504.51,13.9,85.95999999999999,22.43,37.31,27.06,40.57,90.29000000000001,3.84,3.79,3.55,2.29,4.2,2.75,34.2,2.09,2.23,3.77,2.85,5.35,2.39,373.87,3.98,3.65,3.66,3.87,5.63,4.76,7.9,5.39,3.46,3.01,6.81,18.38,16.21,17.73,18.35,5.98,5.32,13.93,10.42,17.38,9.98,4.78,8.42,24.3,19.44,10.18,33.31,12.51,12.63,5.82,8.449999999999999,12.35,28.21,17.86,9.699999999999999,17,7.73,49.51,41.1,29.01,7.6,4.25,4.93,5.95,4.36,15.97,7.06,10.02,9.49,40.28,7.13,6.26,47.85,3.5,15.15,14.72,2641.1,289.94,13.35,24.78,19.63,7.99,6.96,7.77,8.82,5.69,13.64,11.1,35.69,48.93,38.52,207.74,20.31,24.91,95.27,62.76,22.89,29.68,31.83,56.02,2.54,3.89,4.37,3.84,3.1,65.89,4.53,4.53,6.35,2.85,12.98,2.74,3.75,3.43,61.11,66.90000000000001,228.02,4.3,3.87,12.32,14.98,9.33,6.85,7.3,4.88,14.46,8.279999999999999,9.66,14.97,8.75,34.33,100.4,7.2,34.32,36.37,27.06,56.81,6.51,8.550000000000001,8.09,4.71,272.37,9.91,10.68,12.31,10.75,8.369999999999999,16.77,6.87,8.960000000000001,27.42,115.15,13.57,8.140000000000001,10.36,626.92,17.99,10.4,30.54,18.97,19.22,19.22,20.07,28.02,12.15,7.11,245.72,9.859999999999999,23.13,27.68,429.03,20.59,33.44,22.3,36.15,38.4,38.4,347.89,71.7,210.77,10.22,15.16,8.56,141.43,2120.52,8.08,14.23,14.23,18.85,80.42,2120.52,11.48,4.05,3.81,6.76,9.23,7.73,11.45,4.67,3.77,3.93,5.75,10.96,5.73,3.78,4.33,9.31,7.19,14.86,8.31,16.48,857.9400000000001,275.23,13.45,502.04,9.27,19.08,19.78,30.67,13.94,10.39,27.07,96.93000000000001,12.06,20.54,29.39],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","*","","","","","","","*","","*","","","","","*","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bsdb_sig<\/th>\n      <th>body_site<\/th>\n      <th>rank<\/th>\n      <th>direction<\/th>\n      <th>condition<\/th>\n      <th>sig_name<\/th>\n      <th>inSet_annotated<\/th>\n      <th>inSet_noAnnotated<\/th>\n      <th>notInSet_annotated<\/th>\n      <th>notInSet_noAnnotated<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>HA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":259,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14]},{"name":"bsdb_sig","targets":0},{"name":"body_site","targets":1},{"name":"rank","targets":2},{"name":"direction","targets":3},{"name":"condition","targets":4},{"name":"sig_name","targets":5},{"name":"inSet_annotated","targets":6},{"name":"inSet_noAnnotated","targets":7},{"name":"notInSet_annotated","targets":8},{"name":"notInSet_noAnnotated","targets":9},{"name":"p_value","targets":10},{"name":"fdr","targets":11},{"name":"odds_ratio","targets":12},{"name":"lower_ci","targets":13},{"name":"upper_ci","targets":14},{"name":"HA","targets":15}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,50,100,259]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">en_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">en_sp_df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_gn_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_sp_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">en_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">en_df</span>, <span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)\\|(genus|species)"</span>, <span class="st">"\\1"</span>, <span class="va">sig_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">en_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span></span>
<span><span class="va">en_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">en_tbl</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="heatmap-up">Heatmap UP<a class="anchor" aria-label="anchor" href="#heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>bsdb_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bsdb_sigs</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"bsdb_sig"</span>,</span>
<span>        into <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"body_site"</span>, <span class="st">"rank"</span>, <span class="st">"direction"</span>, <span class="st">"condition"</span><span class="op">)</span>,</span>
<span>        sep <span class="op">=</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"UP"</span><span class="op">)</span></span>
<span><span class="va">dat_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">direction</span> <span class="op">==</span> <span class="st">"DOWN"</span><span class="op">)</span></span></code></pre></div>
<p>Data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">dat_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_group) by genus</span></span>
<span><span class="va">summary_up_freq</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_up</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span>,<span class="va">summary_category_up</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_up</span> <span class="op">&lt;-</span> <span class="va">mat_condition_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">en_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_up</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span>,<span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_up</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_up</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_up_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span></span>
<span>            n <span class="op">=</span> <span class="va">x</span>, begin <span class="op">=</span> <span class="fl">0</span>, option <span class="op">=</span> <span class="st">"C"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_up</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_up</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_up</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rank_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">'gray50'</span>, species <span class="op">=</span> <span class="st">'gray80'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_anno_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_up_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_up</span> <span class="op">&lt;-</span> <span class="va">ht1_up</span> <span class="op">+</span> <span class="va">ht2_up</span> <span class="op">+</span> <span class="va">row_anno_up</span></span>
<span><span class="va">lgd_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rank_col</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Rank"</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_up</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-17-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="heatmap-down">Heatmap Down<a class="anchor" aria-label="anchor" href="#heatmap-down"></a>
</h2>
<p>Data:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Summary for top column barplot annotations -- condition category</span></span>
<span><span class="va">summary_category_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, name <span class="op">=</span> <span class="st">'category_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">Category</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summary for top column barplot annotations -- body site</span></span>
<span><span class="va">summary_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">dat_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">body_site</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'bodysite_total'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">body_site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">en_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Frequency for row annotations -- frequency of enriched physiologies (attrbute_grodown) by genus</span></span>
<span><span class="va">summary_down_freq</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">rank</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'rank'</span>, values_from <span class="op">=</span> <span class="st">'n'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">sig_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create first matrix with condition categories</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">Category</span>, name <span class="op">=</span> <span class="st">"n_enrich"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_category_down</span>, by <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">category_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">category_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'Category'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span>,<span class="va">summary_category_down</span><span class="op">$</span><span class="va">Category</span><span class="op">]</span></span>
<span><span class="va">mat_condition_down</span> <span class="op">&lt;-</span> <span class="va">mat_condition_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span>
<span>    </span>
<span><span class="co">## Create second matrix with body sites</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">en_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, <span class="va">bsdb_sig</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">sig_name</span>, <span class="va">body_site</span>, name <span class="op">=</span> <span class="st">'n_enrich'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">summary_bodysite_down</span>, by <span class="op">=</span> <span class="st">'body_site'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>per <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">n_enrich</span> <span class="op">/</span> <span class="va">bodysite_total</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_enrich</span>, <span class="op">-</span><span class="va">bodysite_total</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">'body_site'</span>, values_from <span class="op">=</span> <span class="st">'per'</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">'sig_name'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span>,<span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">body_site</span><span class="op">]</span></span>
<span><span class="va">mat_bodysite_down</span> <span class="op">&lt;-</span> <span class="va">mat_bodysite_down</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">summary_down_freq</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>Heatmap:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lgd &lt;- Legend(col_fun = color_fun, title = "% (col)")</span></span>
<span><span class="va">anno_width</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span><span class="va">col_anno_category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_category_down</span><span class="op">$</span><span class="va">category_total</span>,</span>
<span>        bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">col_anno_bodysite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">columnAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"bs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_bodysite_down</span><span class="op">$</span><span class="va">bodysite_total</span>, bar_width <span class="op">=</span> <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>        height <span class="op">=</span> <span class="va">anno_width</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht1_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_condition_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Condition category"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_category</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ht2_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat_bodysite_down</span>,</span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">'left'</span>,</span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'%'</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mat_condition_down</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_title <span class="op">=</span> <span class="st">"Body site"</span>,</span>
<span>    row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat_bodysite_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    top_annotation <span class="op">=</span> <span class="va">col_anno_bodysite</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">row_anno_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span></span>
<span>    <span class="st">"# bsdb sigs"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_barplot.html" class="external-link">anno_barplot</a></span><span class="op">(</span></span>
<span>        <span class="va">summary_down_freq</span>, bar_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rank_col</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">ht_list_down</span> <span class="op">&lt;-</span> <span class="va">ht1_down</span> <span class="op">+</span> <span class="va">ht2_down</span> <span class="op">+</span> <span class="va">row_anno_down</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht_list_down</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    heatmap_legend_side <span class="op">=</span> <span class="st">'right'</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="va">lgd_list</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-19-1.png" width="864"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">520</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">480</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">x</span>, ncol <span class="op">=</span> <span class="fl">100</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lay</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">52</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, layout_matrix <span class="op">=</span> <span class="va">lay</span><span class="op">)</span></span></code></pre></div>
<p><img src="bsdb2_files/figure-html/unnamed-chunk-20-1.png" width="1920"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-01-31</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@47ba4db)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.1    <span style="color: #555555;">2023-10-29</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.15   <span style="color: #555555;">2022-05-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.1    <span style="color: #555555;">2024-01-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.31     <span style="color: #555555;">2023-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  forcats            1.0.0    <span style="color: #555555;">2023-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.4.4    <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra        * 2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ontologyIndex      2.11     <span style="color: #555555;">2023-05-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6    <span style="color: #555555;">2021-05-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.2    <span style="color: #555555;">2022-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.41     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
