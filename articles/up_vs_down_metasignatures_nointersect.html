<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Odds Ratio - Up vs Down • bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Odds Ratio - Up vs Down">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures.html">High-throughput ORA with BSDB meta-signatures</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures_nointersect.html">High-throughput ORA with BSDB meta-signatures (no intersect)</a>
    </li>
    <li>
      <a href="../articles/bsdb_signatures.html">High-throughput ORA with BSDB signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_signatures.html">Odds Ratio - Up vs Down - signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_metasignatures_nointersect.html">Odds Ratio - Up vs Down - metasignatures</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
    <li>
      <a href="../articles/TypicalMicrobiomeSignatures.html">Threhold for TypicalMicrobiomeSignatures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="up_vs_down_metasignatures_nointersect_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="up_vs_down_metasignatures_nointersect_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/datatables-binding-0.31/datatables.js"></script><link href="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/selectize-0.12.0/selectize.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Odds Ratio - Up vs Down</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/up_vs_down_metasignatures_nointersect.Rmd" class="external-link"><code>vignettes/articles/up_vs_down_metasignatures_nointersect.Rmd</code></a></small>
      <div class="hidden name"><code>up_vs_down_metasignatures_nointersect.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: grid</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; ComplexHeatmap version 2.18.0</span></span>
<span><span class="co">#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span></span>
<span><span class="co">#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap</span></span>
<span><span class="co">#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; If you use it in published research, please cite either one:</span></span>
<span><span class="co">#&gt; - Gu, Z. Complex Heatmap Visualization. iMeta 2022.</span></span>
<span><span class="co">#&gt; - Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span></span>
<span><span class="co">#&gt;     genomic data. Bioinformatics 2016.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The new InteractiveComplexHeatmap package can directly export static </span></span>
<span><span class="co">#&gt; complex heatmaps into an interactive Shiny app with zero effort. Have a try!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This message can be suppressed by:</span></span>
<span><span class="co">#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))</span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<div class="section level2">
<h2 id="import-bugphyzz">Import BugPhyzz<a class="anchor" aria-label="anchor" href="#import-bugphyzz"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>Use “case-control” study design only:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 10.5281/zenodo.10407666 v1.2.0</span></span>
<span><span class="co">## "10.5281/zenodo.6468009" v1.1.0</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"10.5281/zenodo.10407666"</span> , cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># bsdb &lt;- importBugSigDB(version = "devel" , cache = FALSE)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Study design`</span> <span class="op">==</span> <span class="st">"case-control"</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `BSDB ID` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"bsdb:"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Study "</span>, <span class="st">""</span>, <span class="va">Study</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Experiment "</span>, <span class="st">""</span>, <span class="va">Experiment</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Signature "</span>, <span class="st">""</span>, <span class="va">`Signature page name`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        custom_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"bsdb:"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Study "</span>, <span class="st">""</span>, <span class="va">Study</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Experiment "</span>, <span class="st">""</span>, <span class="va">Experiment</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">custom_id</span>, <span class="va">`BSDB ID`</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1416   51</span></span></code></pre></div>
<p>Create a list with signature ids (BSDB ID) that have both UP and DOWN
outcomes per study.</p>
<p>Genus signatures:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"genus"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span>  <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"DOWN"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"genus"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">common_names_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_gn</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="va">up_gn</span><span class="op">[</span><span class="va">common_names_gn</span><span class="op">]</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="va">down_gn</span><span class="op">[</span><span class="va">common_names_gn</span><span class="op">]</span></span>
<span><span class="va">remove_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="va">down_gn</span>, <span class="op">~</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="va">remove_gn</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">down_gn</span>, <span class="va">remove_gn</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">down_gn</span>,<span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_gn</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="va">up_gn</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="va">down_gn</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="co"># names(up_gn) &lt;- paste0("genus_UP_", names(up_gn))</span></span>
<span><span class="co"># names(down_gn) &lt;- paste0("genus_DOWN_", names(down_gn))</span></span></code></pre></div>
<p>Species signatures:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"species"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span>  <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"DOWN"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"species"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">common_names_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_sp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="va">up_sp</span><span class="op">[</span><span class="va">common_names_sp</span><span class="op">]</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="va">down_sp</span><span class="op">[</span><span class="va">common_names_sp</span><span class="op">]</span></span>
<span><span class="va">remove_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="va">down_sp</span>, <span class="op">~</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="va">remove_sp</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">down_sp</span>, <span class="va">remove_sp</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">down_sp</span>,<span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_sp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="va">up_sp</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="va">down_sp</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="co"># names(up_sp) &lt;- paste0("species_UP_", names(up_sp))</span></span>
<span><span class="co"># names(down_sp) &lt;- paste0("species_DOWN_", names(down_sp))</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Columns that make BSDB ID: Study, Experiment, Signature page name</span></span>
<span><span class="co"># l &lt;- bsdb |&gt; </span></span>
<span><span class="co">#     select(</span></span>
<span><span class="co">#         Study, Experiment, `Signature page name`, `Abundance in Group 1`</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         xcol = paste0(`Abundance in Group 1`, " (", `Signature page name`, ")")</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     group_by(Study, Experiment) |&gt; </span></span>
<span><span class="co">#     mutate(ycol = sort(paste0(xcol, collapse = "; "))) |&gt; </span></span>
<span><span class="co">#     mutate(n_sig = n()) |&gt; </span></span>
<span><span class="co">#     ungroup() |&gt; </span></span>
<span><span class="co">#     select(-xcol) |&gt; </span></span>
<span><span class="co">#     filter(n_sig == 2) |&gt; </span></span>
<span><span class="co">#     filter(grepl("decreased", ycol), grepl("increased", ycol)) |&gt; </span></span>
<span><span class="co">#     filter(grepl("Signature 1", ycol), grepl("Signature 2", ycol)) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         `BSDB ID` = paste0(</span></span>
<span><span class="co">#             "bsdb:",</span></span>
<span><span class="co">#             sub("Study ", "", Study), "/",</span></span>
<span><span class="co">#             sub("Experiment ", "", Experiment), "/",</span></span>
<span><span class="co">#             sub("Signature ", "", `Signature page name`)</span></span>
<span><span class="co">#         )</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         custom_id = paste0(</span></span>
<span><span class="co">#             "bsdb:",</span></span>
<span><span class="co">#             sub("Study ", "", Study), "/",</span></span>
<span><span class="co">#             sub("Experiment ", "", Experiment)</span></span>
<span><span class="co">#         )</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     relocate(custom_id, `BSDB ID`) |&gt; </span></span>
<span><span class="co">#     {\(y) split(y, y$`Abundance in Group 1`)}() |&gt; </span></span>
<span><span class="co">#     map(~ pull(arrange(.x, custom_id), `BSDB ID`))</span></span>
<span><span class="co"># map(l, length)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="genus">Genus<a class="anchor" aria-label="anchor" href="#genus"></a>
</h2>
<p>Create signatures for both decrease and increase at the
<strong>genus</strong> level. Only keep the signature names (stored in a
data.frame) that have enough taxa in both increased and decreased
sets.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lg &lt;- map(l, ~ {</span></span>
<span><span class="co">#     bsdb |&gt; </span></span>
<span><span class="co">#         filter(`BSDB ID` %in% .x) |&gt; </span></span>
<span><span class="co">#         getSignatures(</span></span>
<span><span class="co">#             tax.id.type = "ncbi", tax.level = "genus", exact.tax.level = FALSE,</span></span>
<span><span class="co">#             min.size = 5</span></span>
<span><span class="co">#         ) |&gt; </span></span>
<span><span class="co">#         keep(~ length(.x) &gt;= 5)</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># df_gn_1 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(lg$decreased)), "---", names(lg$decreased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_down"), sep = "---")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_gn_2 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(lg$increased)), "---", names(lg$increased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_up"), sep = "---")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_gn &lt;- full_join(df_gn_1, df_gn_2, by = "custom_id") |&gt; </span></span>
<span><span class="co">#     drop_na() |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         check = sub("bsdb:\\d+/\\d+/\\d+_(.*)_UP", "\\1", sig_up) ==</span></span>
<span><span class="co">#            sub("bsdb:\\d+/\\d+/\\d+_(.*)_DOWN", "\\1", sig_down)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># dim(df_gn)    </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="species">Species<a class="anchor" aria-label="anchor" href="#species"></a>
</h2>
<p>Create signatures for both decrease and increase at the
<strong>species</strong> level. Only keep the signature names (stored in
a data.frame) that have enough taxa in both increased and decreased
sets.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ls &lt;- map(l, ~ {</span></span>
<span><span class="co">#     bsdb |&gt; </span></span>
<span><span class="co">#         filter(`BSDB ID` %in% .x) |&gt; </span></span>
<span><span class="co">#         getSignatures(</span></span>
<span><span class="co">#             tax.id.type = "ncbi", tax.level = "species",</span></span>
<span><span class="co">#             exact.tax.level = FALSE, min.size = 5</span></span>
<span><span class="co">#         ) |&gt; </span></span>
<span><span class="co">#         keep(~ length(.x) &gt;= 5)</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># df_sp_1 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(ls$decreased)), "---", names(ls$decreased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_down"), sep = "---")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_sp_2 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(ls$increased)), "---", names(ls$increased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_up"), sep = "---")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_sp &lt;- full_join(df_sp_1, df_sp_2, by = "custom_id") |&gt; </span></span>
<span><span class="co">#     drop_na() |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         check = sub("bsdb:\\d+/\\d+/\\d+_(.*)_UP", "\\1", sig_up) ==</span></span>
<span><span class="co">#             sub("bsdb:\\d+/\\d+/\\d+_(.*)_DOWN", "\\1", sig_down)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># dim(df_sp)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-lists-of-bsdb-signatures">Get lists of BSDB signatures<a class="anchor" aria-label="anchor" href="#get-lists-of-bsdb-signatures"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigs_list_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sigs_list_gn</span><span class="op">[[</span><span class="st">"up"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">up_gn</span></span>
<span><span class="va">sigs_list_gn</span><span class="op">[[</span><span class="st">"down"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">down_gn</span> </span>
<span><span class="co"># sigs_list_gn[["up"]] &lt;- lg$increased[df_gn$sig_up]</span></span>
<span><span class="co"># sigs_list_gn[["down"]] &lt;- lg$decreased[df_gn$sig_down]</span></span>
<span></span>
<span><span class="va">sigs_list_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sigs_list_sp</span><span class="op">[[</span><span class="st">"up"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">up_sp</span></span>
<span><span class="va">sigs_list_sp</span><span class="op">[[</span><span class="st">"down"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">down_sp</span> </span>
<span><span class="co"># sigs_list_sp[["up"]] &lt;- ls$increased[df_sp$sig_up]</span></span>
<span><span class="co"># sigs_list_sp[["down"]] &lt;- ls$decreased[df_sp$sig_down]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="odds-ratio---function">Odds ratio - function<a class="anchor" aria-label="anchor" href="#odds-ratio---function"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">or</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span>, event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># suppressWarnings({</span></span>
<span>    <span class="co">#     res &lt;- epitools::oddsratio.wald(ct)</span></span>
<span>    <span class="co"># })</span></span>
<span>    <span class="va">p_value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">ct</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">HA</span> <span class="op">&lt;-</span> <span class="st">"*"</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="co"># res &lt;- epitools::oddsratio.small(ct)</span></span>
<span>            <span class="co"># p_value = fisher.test(x = ct + 0.5, alternative = "two.sided")$p.value</span></span>
<span>            <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">epitools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/epitools/man/oddsratio.html" class="external-link">oddsratio.wald</a></span><span class="op">(</span><span class="va">ct</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># I get a lot of caution messages about not using this funcion</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">HA</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="co"># p_value = fisher.test(x = ct, alternative = "two.sided")$p.value</span></span>
<span>            <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">epitools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/epitools/man/oddsratio.html" class="external-link">oddsratio.wald</a></span><span class="op">(</span><span class="va">ct</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>       odds_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"estimate"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       lower_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"lower"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       upper_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"upper"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       <span class="co"># p_value = res$p.value[2, "fisher.exact"],</span></span>
<span>       p_value <span class="op">=</span> <span class="va">p_value</span>,</span>
<span>       <span class="co"># method = method,</span></span>
<span>       HA <span class="op">=</span> <span class="va">HA</span>,</span>
<span>       up_annotated <span class="op">=</span> <span class="va">a</span>,</span>
<span>       up_noAnnotated <span class="op">=</span> <span class="va">b</span>,</span>
<span>       down_annotated <span class="op">=</span> <span class="va">c</span>,</span>
<span>       down_noAnnotated <span class="op">=</span> <span class="va">d</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-odds-ratio-and-p-values">Calculate odds ratio and p values<a class="anchor" aria-label="anchor" href="#calculate-odds-ratio-and-p-values"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu">or</span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            y <span class="op">=</span> <span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">down</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            s <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gn</span><span class="op">)</span><span class="op">[</span><span class="va">counter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"---"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"---genus"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">gn</span><span class="op">[[</span><span class="va">counter</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">odds_ratio</span></span>
<span>        <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">gn_df</span> <span class="op">&lt;-</span> <span class="va">gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"name"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span>, <span class="st">"bp_sig"</span>, <span class="st">"rank"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"---"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        bp_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)$"</span>, <span class="st">"\\1"</span>, <span class="va">bp_sig</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gn_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3417   13</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu">or</span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            y <span class="op">=</span> <span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">down</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            s <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[</span><span class="va">counter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"---"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"---genus"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">sp</span><span class="op">[[</span><span class="va">counter</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">odds_ratio</span></span>
<span>        <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sp_df</span> <span class="op">&lt;-</span> <span class="va">sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"name"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span>, <span class="st">"bp_sig"</span>, <span class="st">"rank"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"---"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        bp_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)$"</span>, <span class="st">"\\1"</span>, <span class="va">bp_sig</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sp_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2958   13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merge-gn-and-sp">Merge gn and sp<a class="anchor" aria-label="anchor" href="#merge-gn-and-sp"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mainDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">gn_df</span>, <span class="va">sp_df</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        fdr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p_value</span>, method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>        p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_value</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">fdr</span>, .after <span class="op">=</span> <span class="va">p_value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mainDF</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6375   14</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---table-up">odds ratio - genus - table up<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---table-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genus_table_up</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"genus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">genus_table_up</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-f4aca8c58a79bc19810a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f4aca8c58a79bc19810a">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.08\" data-max=\"53.32\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.65\" data-max=\"3.46\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3.86\" data-max=\"1190.84\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.048\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.032\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"60\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"116\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"61\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4\" data-max=\"77\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["multiple myeloma","alzheimer's disease","atopic eczema","atopic eczema","colorectal adenoma","age","chronic kidney disease","acute lymphoblastic leukemia","hiv infection","hiv infection","type i diabetes mellitus","multiple myeloma","alzheimer's disease","covid-19","squamous cell carcinoma","hiv infection","atopic eczema","chronic kidney disease","rheumatoid arthritis","age","multiple myeloma","anorexia nervosa","chronic fatigue syndrome","periodontitis","chronic kidney disease","chronic kidney disease","atopic eczema","multiple myeloma","esophageal cancer","irritable bowel syndrome","arthritis","multiple myeloma","type ii diabetes mellitus","age","atopic eczema","multiple myeloma","covid-19","alzheimer's disease","chronic kidney disease","covid-19","multiple myeloma","multiple myeloma","hashimoto's thyroiditis","covid-19","covid-19","multiple myeloma","obesity","alzheimer's disease","arthritis","hiv infection","hiv infection","esophageal cancer","intestinal polyp","gastric cancer","colorectal cancer","breast cancer","rheumatoid arthritis","gastric cancer","chronic hepatitis b virus infection","chronic kidney disease","multiple myeloma","obesity","covid-19","obesity","food allergy","arthritis","chronic hepatitis b virus infection","gastric cancer","crohn's disease","chronic fatigue syndrome","hiv infection","breast cancer","psoriasis","colorectal cancer","irritable bowel syndrome","breast cancer","pancreatic carcinoma","periodontitis","breast cancer","alzheimer's disease","covid-19","obesity","parkinson's disease","obesity","obesity","covid-19","parkinson's disease","colorectal cancer","colorectal cancer","parkinson's disease","colorectal cancer","parkinson's disease","obesity","covid-19","parkinson's disease","covid-19","parkinson's disease","parkinson's disease"],["aerophilicity|aerobic","antimicrobial sensitivity|FALSE","aerophilicity|facultatively anaerobic","arrangement|paired cells","biosafety level|biosafety level 1","shape|bacillus","arrangement|cell chain","animal pathogen|FALSE","biosafety level|biosafety level 2","habitat|colonization of host","habitat|waste and sludge water","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","arrangement|cell chain","motility|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","host-associated|TRUE","gram stain|gram stain positive","shape|coccus","antimicrobial sensitivity|TRUE","width|small| &gt; -0.01 &amp; &lt;= 0.9","gram stain|gram stain positive","health associated|FALSE","aerophilicity|anaerobic","aerophilicity|aerobic","hemolysis|beta","arrangement|cell chain","habitat|oral","shape|bacillus","aerophilicity|aerobic","host-associated|TRUE","gram stain|gram stain negative","spore formation|FALSE","aerophilicity|anaerobic","extreme environment|TRUE","hemolysis|beta","shape|coccus","sphingolipid producing|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","antimicrobial sensitivity|FALSE","arrangement|cell chain","biofilm formation|TRUE","gram stain|gram stain positive","habitat|oral","hemolysis|beta","length|small| &gt; 0.19 &amp; &lt;= 3.8","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","shape|bacillus","hemolysis|gamma","aerophilicity|facultatively anaerobic","biosafety level|biosafety level 2","antimicrobial sensitivity|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","gram stain|gram stain negative","hemolysis|beta","biosafety level|biosafety level 2","motility|FALSE","animal pathogen|TRUE","host-associated|FALSE","host-associated|TRUE","host-associated|TRUE","aerophilicity|anaerobic","host-associated|FALSE","animal pathogen|TRUE","gram stain|gram stain positive","animal pathogen|TRUE","motility|TRUE","cogem pathogenicity rating|cogem pathogenicity rating 2","aerophilicity|facultatively anaerobic","shape|bacillus","animal pathogen|TRUE","spore formation|FALSE","motility|FALSE","biosafety level|biosafety level 2","motility|TRUE","hemolysis|gamma","animal pathogen|TRUE","aerophilicity|anaerobic","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","aerophilicity|aerobic","biosafety level|biosafety level 2","habitat|feces","antimicrobial sensitivity|TRUE","cogem pathogenicity rating|cogem pathogenicity rating 2","aerophilicity|facultatively anaerobic","shape|bacillus","host-associated|TRUE","cogem pathogenicity rating|cogem pathogenicity rating 2","arrangement|cell chain","animal pathogen|TRUE","animal pathogen|FALSE","host-associated|TRUE","host-associated|TRUE","motility|FALSE","animal pathogen|TRUE","habitat|colonization of host","shape|bacillus"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],[53.32,49,46.14,46.14,45,44.33,42.27,39,33,33,30,28.93,23.8,23.62,23,20.94,20,20,18.6,18,18,17.5,17.31,16.67,16.41,16.41,16.08,15.77,15.52,15.4,15.19,15.17,15.09,14.4,14.3,14.21,13.97,13.36,13.1,12.61,12.15,12.15,12,11.55,11.29,11.2,10.59,10.5,10.5,10,10,9.5,9.449999999999999,9.380000000000001,9.09,8.470000000000001,7.8,7.78,7.5,7.5,7.5,7.43,7.06,6.97,6.91,6.88,6.5,6.5,6.32,6,5.87,5.78,5.71,5.67,5.46,5.25,4.64,4.5,4.4,3.89,3.88,3.61,3.43,3.39,3.19,2.99,2.9,2.86,2.82,2.78,2.73,2.62,2.59,2.55,2.41,2.35,2.13,2.08],[2.97,2.62,2.07,2.07,3.41,2.1,2.06,1.28,1.06,1.06,2.22,3.46,2.34,1.41,1.16,1.09,1.68,2.77,0.88,1.63,1.93,1.22,0.8,1.36,0.79,0.79,0.75,0.84,0.79,0.74,0.75,2.84,0.79,1.37,0.68,1.68,1.84,0.67,0.65,1.66,1.42,1.42,1.76,0.67,1.48,1.19,1.36,1.89,1.07,1.16,1.16,1.27,0.95,1.64,1.05,1.71,1.16,1.37,1.17,1.2,1.47,2.88,0.91,2.46,1.7,1.35,1.26,1.16,1.12,1.08,1.59,1.43,1.07,1.98,1.6,1.06,1.31,1.22,1.28,1.1,1.43,1.22,1.64,1.27,1.33,0.98,1.28,1.07,1.22,1.11,1.16,1.19,1.13,1.23,1.09,1.2,1.11,1.12],[955.86,915.54,1028.71,1028.71,594.12,936.77,869.24,1190.84,1023.56,1023.56,405.98,242.14,242.29,397.03,455.9,403.86,238.63,144.31,392.37,198.51,167.99,250.36,373.45,204.03,342.8,342.8,343.62,294.62,303.25,321.19,305.73,81.09999999999999,287.77,150.81,300.83,120.51,105.83,265.13,265.42,95.79000000000001,103.82,103.82,81.73999999999999,199.42,86.13,105.13,82.61,58.36,103.51,86,86,70.95999999999999,94.48,53.62,78.75,42.03,52.35,44.04,48.15,47.05,38.32,19.15,55.05,19.8,28.03,35.06,33.58,36.58,35.79,33.32,21.65,23.34,30.63,16.22,18.68,26.07,16.42,16.62,15.15,13.76,10.51,10.68,7.15,9.09,7.67,9.07,6.58,7.64,6.54,6.96,6.41,5.75,5.93,5.3,5.32,4.61,4.09,3.86],[0,0,0.001,0.001,0.001,0.002,0.001,0.015,0.048,0.048,0.006,0,0.003,0,0.008,0.008,0.017,0.002,0.022,0.019,0.007,0.041,0.029,0.041,0.028,0.028,0.038,0.023,0.027,0.04,0.042,0.002,0.019,0.029,0.047,0.005,0,0.036,0.047,0.002,0.012,0.012,0.014,0.018,0.003,0.039,0.006,0.008,0.035,0.017,0.017,0.033,0.047,0.012,0.04,0.006,0.038,0.03,0.038,0.047,0.01,0,0.04,0,0.011,0.027,0.029,0.034,0.034,0.039,0.012,0.017,0.042,0.001,0.008,0.035,0.02,0.027,0.02,0.04,0.006,0.021,0.001,0.018,0.008999999999999999,0.046,0.015,0.04,0.021,0.035,0.032,0.02,0.027,0.013,0.031,0.015,0.025,0.022],[0.032,0.059,0.511,0.511,0.511,0.511,0.454,1,1,1,1,0.059,0.699,0.199,1,1,1,0.5580000000000001,1,1,1,1,1,1,1,1,1,1,1,1,1,0.511,1,1,1,1,0.307,1,1,0.511,1,1,1,1,0.712,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.032,1,0.059,1,1,1,1,1,1,1,1,1,0.511,1,1,1,1,1,1,1,1,0.426,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],["*","*","*","*","","*","*","*","*","*","","","","*","*","*","","","*","","","","*","","*","*","*","*","*","*","*","","*","","*","","","*","*","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],[14,10,8,8,6,9,7,6,4,4,6,15,7,21,11,29,10,10,4,12,9,7,4,10,4,4,5,6,8,3,14,13,29,8,3,10,25,4,12,23,9,9,12,11,21,7,34,9,6,10,10,4,26,10,6,23,6,10,6,10,27,28,14,30,17,10,8,10,5,12,24,24,16,17,17,18,17,24,28,14,34,9,36,29,26,23,44,34,24,20,21,32,23,38,41,60,38,45],[15,10,3,3,1,4,5,0,1,1,2,14,5,106,8,0,1,2,7,1,8,1,6,1,8,8,6,23,0,12,0,4,0,5,11,19,102,16,0,104,20,20,4,116,106,10,1,3,8,19,19,4,1,2,35,19,5,2,6,2,2,7,113,5,8,4,4,2,17,2,5,18,2,24,21,24,5,8,14,6,93,26,63,6,9,104,14,7,17,79,20,26,12,17,17,67,61,54],[0,0,0,0,2,0,0,1,0,0,1,1,1,0,0,15,3,3,0,4,1,2,0,3,0,0,0,0,11,0,10,3,21,1,0,1,1,0,10,1,1,1,2,0,1,1,61,4,1,1,1,2,11,8,1,2,2,9,2,6,18,28,1,37,4,4,4,10,2,11,9,3,14,6,4,2,11,6,5,9,5,7,12,47,38,4,26,34,18,7,15,16,34,35,25,16,19,24],[28,24,9,9,15,10,15,4,5,5,10,27,17,58,8,5,6,12,15,6,16,5,12,5,15,15,9,28,10,27,5,14,5,9,23,27,57,24,5,57,27,27,8,58,57,16,19,14,14,19,19,19,4,15,53,14,13,14,15,9,10,52,57,43,13,11,13,13,43,11,11,13,10,48,27,14,15,9,11,15,53,73,72,33,42,54,24,20,36,77,39,34,46,40,25,42,65,60],["cancer","mental disease","anatomical system disease","anatomical system disease","cancer","environment, sociodemographics, lifestyle","anatomical system disease","cancer","infectious disease","infectious disease","metabolic disease","cancer","mental disease","infectious disease","cancer","infectious disease","anatomical system disease","anatomical system disease","anatomical system disease","environment, sociodemographics, lifestyle","cancer","metabolic disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","anatomical system disease","anatomical system disease","cancer","metabolic disease","environment, sociodemographics, lifestyle","anatomical system disease","cancer","infectious disease","mental disease","anatomical system disease","infectious disease","cancer","cancer","anatomical system disease","infectious disease","infectious disease","cancer","metabolic disease","mental disease","anatomical system disease","infectious disease","infectious disease","cancer","cancer","cancer","cancer","cancer","anatomical system disease","cancer","infectious disease","anatomical system disease","cancer","metabolic disease","infectious disease","metabolic disease","anatomical system disease","anatomical system disease","infectious disease","cancer","anatomical system disease","anatomical system disease","infectious disease","cancer","anatomical system disease","cancer","anatomical system disease","cancer","cancer","anatomical system disease","cancer","mental disease","infectious disease","metabolic disease","mental disease","metabolic disease","metabolic disease","infectious disease","mental disease","cancer","cancer","mental disease","cancer","mental disease","metabolic disease","infectious disease","mental disease","infectious disease","mental disease","mental disease"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---heatmap-up">Odds ratio - genus - heatmap up<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_mat_up</span> <span class="op">&lt;-</span> <span class="va">genus_table_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "genus") |&gt; </span></span>
<span>    <span class="co"># filter(p_value &lt; 0.05, odds_ratio &gt; 1) |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">gn_hp_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">gn_mat_up</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">gn_mat_up</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gn_mat_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">gn_hp_up</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---table-down">odds ratio - genus - table down<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---table-down"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genus_table_down</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"genus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">genus_table_down</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3d818f77fd16757c5261" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3d818f77fd16757c5261">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.03\" data-max=\"0.44\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.2\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.23\" data-max=\"1.47\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.049\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.032\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"28\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"127\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"51\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"79\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["covid-19","colorectal cancer","obesity","parkinson's disease","colorectal cancer","colorectal cancer","covid-19","covid-19","obesity","chronic kidney disease","parkinson's disease","parkinson's disease","obesity","ulcerative colitis","covid-19","obesity","obesity","endometriosis","parkinson's disease","pancreatic carcinoma","eczema","food allergy","squamous cell carcinoma","chronic fatigue syndrome","irritable bowel syndrome","lung cancer","schizophrenia","food allergy","colorectal cancer","multiple myeloma","obesity","obesity","obesity","esophageal cancer","food allergy","chronic kidney disease","hashimoto's thyroiditis","psoriasis","periodontitis","atopic eczema","autism","oral squamous cell carcinoma","type ii diabetes mellitus","breast cancer","multiple myeloma","multiple myeloma","parkinson's disease","age","eczema","hashimoto's thyroiditis","hashimoto's thyroiditis","multiple sclerosis","obesity","parkinson's disease","smoking behavior","covid-19","multiple myeloma","obesity","age","multiple myeloma","multiple myeloma","alzheimer's disease","breast carcinoma","head and neck carcinoma","multiple myeloma","squamous cell carcinoma","atopic eczema","acute lymphoblastic leukemia","breast carcinoma","breast carcinoma","hiv infection"],["aerophilicity|aerobic","hemolysis|gamma","host-associated|FALSE","gram stain|gram stain negative","width|small| &gt; -0.01 &amp; &lt;= 0.9","length|small| &gt; 0.19 &amp; &lt;= 3.8","host-associated|FALSE","spore shape|endospore","habitat|digestive system","aerophilicity|anaerobic","shape|coccus","habitat|oral","antimicrobial sensitivity|FALSE","width|small| &gt; -0.01 &amp; &lt;= 0.9","habitat|waste and sludge water","cogem pathogenicity rating|cogem pathogenicity rating 1","habitat|feces","length|small| &gt; 0.19 &amp; &lt;= 3.8","host-associated|FALSE","animal pathogen|FALSE","gram stain|gram stain positive","habitat|waste and sludge water","gram stain|gram stain positive","gram stain|gram stain negative","motility|FALSE","shape|bacillus","shape|bacillus","gram stain|gram stain negative","arrangement|single","gram stain|gram stain positive","animal pathogen|FALSE","aerophilicity|aerobic","habitat|human microbiome","antimicrobial sensitivity|TRUE","cogem pathogenicity rating|cogem pathogenicity rating 1","gram stain|gram stain negative","gram stain|gram stain negative","motility|TRUE","aerophilicity|aerobic","extreme environment|FALSE","shape|coccus","cogem pathogenicity rating|cogem pathogenicity rating 1","spore formation|TRUE","habitat|human gut microbiome","habitat|free-living","habitat|human gut microbiome","shape|spirillum","antimicrobial sensitivity|FALSE","shape|coccus","shape|bacillus","sphingolipid producing|TRUE","spore formation|TRUE","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","shape|spirillum","arrangement|paired cells","biofilm formation|FALSE","spore shape|endospore","arrangement|cell chain","arrangement|paired cells","aerophilicity|anaerobic","host-associated|FALSE","antimicrobial sensitivity|TRUE","habitat|waste and sludge water","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","motility|FALSE","aerophilicity|anaerobic","animal pathogen|TRUE","animal pathogen|FALSE","spore formation|FALSE","biosafety level|biosafety level 1"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],[0.44,0.4,0.39,0.39,0.38,0.37,0.37,0.33,0.33,0.3,0.3,0.29,0.28,0.27,0.27,0.25,0.25,0.23,0.23,0.22,0.2,0.2,0.2,0.19,0.19,0.18,0.18,0.14,0.13,0.13,0.13,0.12,0.12,0.11,0.1,0.1,0.08,0.08,0.08,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.05,0.04,0.04,0.04,0.04,0.04,0.04,0.03,0.03,0.03,0.03],[0.2,0.18,0.17,0.19,0.18,0.17,0.17,0.13,0.12,0.09,0.12,0.1,0.1,0.08,0.09,0.09,0.1,0.06,0.07000000000000001,0.06,0.05,0.05,0.05,0.04,0.06,0.05,0.03,0.04,0.02,0.03,0.04,0.04,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0,0,0.01,0,0.01,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0],[0.95,0.85,0.91,0.78,0.82,0.8,0.79,0.84,0.88,0.9399999999999999,0.76,0.85,0.79,0.93,0.8,0.68,0.63,0.93,0.74,0.76,0.85,0.75,0.84,0.88,0.61,0.67,0.9399999999999999,0.59,1.05,0.59,0.4,0.36,1,0.79,0.95,1.02,0.57,0.72,0.44,1.47,1.42,0.8100000000000001,1.26,0.72,1.38,1.38,1.33,0.61,1.14,1.2,1.42,1.35,1.11,1.07,1.27,1.22,1.1,0.98,1.15,0.23,0.9,0.39,0.62,0.92,0.77,0.86,0.78,0.78,0.55,0.55,0.9399999999999999],[0.04,0.022,0.042,0.008999999999999999,0.016,0.015,0.011,0.022,0.036,0.046,0.014,0.024,0.015,0.042,0.019,0.006,0.003,0.049,0.01,0.02,0.03,0.027,0.039,0.041,0.005,0.015,0.04,0.011,0.042,0.015,0,0,0.033,0.033,0.032,0.043,0.014,0.012,0.002,0.047,0.029,0.027,0.019,0.018,0.023,0.023,0.019,0.019,0.017,0.023,0.046,0.04,0.005,0.008,0.024,0.03,0.01,0.006,0.024,0,0.004,0.001,0.035,0.035,0.007,0.008,0.008,0.015,0.029,0.029,0.048],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.742,1,1,1,1,1,1,1,1,1,1,1,1,1,0.059,0.04,1,1,1,1,1,1,0.699,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.032,1,0.454,1,1,1,1,1,1,1,1,1],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","*","","*","*","*","","*","*","*","*","*","*","*","*","*","*","*","","*","","","*","*","*","*","*","","","*"],[13,28,11,16,15,14,14,9,7,13,7,5,5,6,6,6,9,4,4,5,3,8,4,3,19,13,15,8,1,4,4,4,1,4,1,1,4,1,2,11,0,1,0,1,0,0,0,1,0,9,0,0,0,0,0,0,0,0,0,9,0,10,2,5,10,8,0,0,1,1,0],[42,25,24,83,38,39,41,118,39,11,92,94,30,16,121,29,37,21,95,17,14,17,18,11,19,12,19,17,52,13,31,31,45,4,24,11,12,17,30,3,11,20,29,41,29,29,99,12,17,7,16,21,35,58,33,127,29,46,13,20,29,10,5,2,7,11,11,6,6,6,5],[31,51,43,28,35,34,36,11,18,28,17,13,30,14,9,36,25,9,13,15,15,12,9,13,26,24,9,13,9,12,40,42,8,19,5,7,8,10,7,23,7,4,5,4,5,5,5,6,9,10,3,3,14,6,4,3,6,8,4,25,7,23,9,28,17,8,5,4,6,6,4],[44,18,37,56,34,35,39,47,33,7,67,71,50,10,49,44,26,11,71,11,14,5,8,9,5,4,2,4,60,5,40,38,43,2,12,8,2,14,8,0,12,6,21,12,23,23,79,4,20,0,7,9,66,44,19,55,22,43,6,3,21,1,1,0,0,0,4,1,1,1,1],["infectious disease","cancer","metabolic disease","mental disease","cancer","cancer","infectious disease","infectious disease","metabolic disease","anatomical system disease","mental disease","mental disease","metabolic disease","anatomical system disease","infectious disease","metabolic disease","metabolic disease","anatomical system disease","mental disease","cancer","anatomical system disease","anatomical system disease","cancer","anatomical system disease","anatomical system disease","cancer","mental disease","anatomical system disease","cancer","cancer","metabolic disease","metabolic disease","metabolic disease","cancer","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","mental disease","cancer","metabolic disease","cancer","cancer","cancer","mental disease","environment, sociodemographics, lifestyle","anatomical system disease","anatomical system disease","anatomical system disease","mental disease","metabolic disease","mental disease","environment, sociodemographics, lifestyle","infectious disease","cancer","metabolic disease","environment, sociodemographics, lifestyle","cancer","cancer","mental disease","cancer","cancer","cancer","cancer","anatomical system disease","cancer","cancer","cancer","infectious disease"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---heatmap-down">odds ratio - genus - heatmap down<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---heatmap-down"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_mat_down</span> <span class="op">&lt;-</span> <span class="va">genus_table_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "genus") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gn_hp_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">gn_mat_down</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">gn_mat_down</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gn_mat_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">gn_hp_down</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---table-up">odds ratio - species - table up<a class="anchor" aria-label="anchor" href="#odds-ratio---species---table-up"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_table_up</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">species_table_up</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cf2c85aca180fce527ec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cf2c85aca180fce527ec">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---heatmap-up">Odds ratio - species - heatmap up<a class="anchor" aria-label="anchor" href="#odds-ratio---species---heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_mat_up</span> <span class="op">&lt;-</span> <span class="va">species_table_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "species") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp_hp_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">sp_mat_up</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">sp_mat_up</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sp_mat_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">sp_hp_up</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---table-down">Odds ratio - species - table down<a class="anchor" aria-label="anchor" href="#odds-ratio---species---table-down"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_table_down</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">species_table_down</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-b0b7529bcd5419f558e5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b0b7529bcd5419f558e5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---heatmap-down">Odds ratio - species - heatmap down<a class="anchor" aria-label="anchor" href="#odds-ratio---species---heatmap-down"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_mat_down</span> <span class="op">&lt;-</span> <span class="va">species_table_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "species") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp_hp_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">sp_mat_down</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">sp_mat_down</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sp_mat_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">sp_hp_down</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-20</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@1339325)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.2    <span style="color: #555555;">2024-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.15   <span style="color: #555555;">2022-05-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.2    <span style="color: #555555;">2024-02-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.31     <span style="color: #555555;">2023-12-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.4.4    <span style="color: #555555;">2023-10-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra          2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6    <span style="color: #555555;">2021-05-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.2    <span style="color: #555555;">2022-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.42     <span style="color: #555555;">2024-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
