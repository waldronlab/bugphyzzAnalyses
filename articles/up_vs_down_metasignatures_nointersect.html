<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Odds Ratio - Up vs Down • bugphyzzAnalyses</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Odds Ratio - Up vs Down">
<meta property="og:description" content="bugphyzzAnalyses">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bugphyzzAnalyses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_integration_and_stats.html">Data integration and stats</a>
    </li>
    <li>
      <a href="../articles/validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="../articles/subgingival_plaque.html">Known ground truth - Subgingival vs supragingival plaque</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures.html">High-throughput ORA with BSDB meta-signatures</a>
    </li>
    <li>
      <a href="../articles/bsdb_metasignatures_nointersect.html">High-throughput ORA with BSDB meta-signatures (no intersect)</a>
    </li>
    <li>
      <a href="../articles/bsdb_signatures.html">High-throughput ORA with BSDB signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_signatures.html">Odds Ratio - Up vs Down - signatures</a>
    </li>
    <li>
      <a href="../articles/up_vs_down_metasignatures_nointersect.html">Odds Ratio - Up vs Down - metasignatures</a>
    </li>
    <li>
      <a href="../articles/nychanes.html">Reproducibility of previous study - NYCHANES study - bugphyzz</a>
    </li>
    <li>
      <a href="../articles/nychanes2.html">Reproducibility of previous study - NYCHANES study - original annotations</a>
    </li>
    <li>
      <a href="../articles/ibd_enrichment.html">Enrichment in IBD samples</a>
    </li>
    <li>
      <a href="../articles/TypicalMicrobiomeSignatures.html">Threhold for TypicalMicrobiomeSignatures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/waldronlab/bugphyzzAnalyses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="up_vs_down_metasignatures_nointersect_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="up_vs_down_metasignatures_nointersect_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/datatables-binding-0.32/datatables.js"></script><link href="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="up_vs_down_metasignatures_nointersect_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/selectize-0.12.0/selectize.min.js"></script><link href="up_vs_down_metasignatures_nointersect_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="up_vs_down_metasignatures_nointersect_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Odds Ratio - Up vs Down</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/waldronlab/bugphyzzAnalyses/blob/HEAD/vignettes/articles/up_vs_down_metasignatures_nointersect.Rmd" class="external-link"><code>vignettes/articles/up_vs_down_metasignatures_nointersect.Rmd</code></a></small>
      <div class="hidden name"><code>up_vs_down_metasignatures_nointersect.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzzAnalyses" class="external-link">bugphyzzAnalyses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugphyzz" class="external-link">bugphyzz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/waldronlab/bugsigdbr" class="external-link">bugsigdbr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: grid</span></span>
<span><span class="co">#&gt; ========================================</span></span>
<span><span class="co">#&gt; ComplexHeatmap version 2.18.0</span></span>
<span><span class="co">#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span></span>
<span><span class="co">#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap</span></span>
<span><span class="co">#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; If you use it in published research, please cite either one:</span></span>
<span><span class="co">#&gt; - Gu, Z. Complex Heatmap Visualization. iMeta 2022.</span></span>
<span><span class="co">#&gt; - Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span></span>
<span><span class="co">#&gt;     genomic data. Bioinformatics 2016.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The new InteractiveComplexHeatmap package can directly export static </span></span>
<span><span class="co">#&gt; complex heatmaps into an interactive Shiny app with zero effort. Have a try!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This message can be suppressed by:</span></span>
<span><span class="co">#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))</span></span>
<span><span class="co">#&gt; ========================================</span></span></code></pre></div>
<div class="section level2">
<h2 id="import-bugphyzz">Import BugPhyzz<a class="anchor" aria-label="anchor" href="#import-bugphyzz"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/importBugphyzz.html" class="external-link">importBugphyzz</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bp_sigs_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"genus"</span>, min_size <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bp_sigs_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bp</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/bugphyzz/man/makeSignatures.html" class="external-link">makeSignatures</a></span><span class="op">(</span></span>
<span>        dat <span class="op">=</span> <span class="va">.x</span>, tax_id_type <span class="op">=</span> <span class="st">"NCBI_ID"</span>, tax_level <span class="op">=</span> <span class="st">"species"</span>, min_size <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_flatten.html" class="external-link">list_flatten</a></span><span class="op">(</span>name_spec <span class="op">=</span> <span class="st">"{inner}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">as.character</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>Use “case-control” study design only:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 10.5281/zenodo.10407666 v1.2.0</span></span>
<span><span class="co">## "10.5281/zenodo.6468009" v1.1.0</span></span>
<span><span class="co"># bsdb &lt;- importBugSigDB(version = "10.5281/zenodo.10407666" , cache = FALSE)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/importBugSigDB.html" class="external-link">importBugSigDB</a></span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># bsdb &lt;- importBugSigDB(version = "devel" , cache = FALSE)</span></span>
<span><span class="va">bsdb</span> <span class="op">&lt;-</span> <span class="va">bsdb</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Host species`</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Abundance in Group 1`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Body site`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Study design`</span> <span class="op">==</span> <span class="st">"case-control"</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        `BSDB ID` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"bsdb:"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Study "</span>, <span class="st">""</span>, <span class="va">Study</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Experiment "</span>, <span class="st">""</span>, <span class="va">Experiment</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Signature "</span>, <span class="st">""</span>, <span class="va">`Signature page name`</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        custom_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="st">"bsdb:"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Study "</span>, <span class="st">""</span>, <span class="va">Study</span><span class="op">)</span>, <span class="st">"/"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"Experiment "</span>, <span class="st">""</span>, <span class="va">Experiment</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">custom_id</span>, <span class="va">`BSDB ID`</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">bsdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1467   51</span></span></code></pre></div>
<p>Create a list with signature ids (BSDB ID) that have both UP and DOWN
outcomes per study.</p>
<p>Genus signatures:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"genus"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span>  <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"DOWN"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"genus"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">common_names_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_gn</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="va">up_gn</span><span class="op">[</span><span class="va">common_names_gn</span><span class="op">]</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="va">down_gn</span><span class="op">[</span><span class="va">common_names_gn</span><span class="op">]</span></span>
<span><span class="va">remove_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="va">down_gn</span>, <span class="op">~</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="va">remove_gn</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">down_gn</span>, <span class="va">remove_gn</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">up_gn</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">down_gn</span>,<span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_gn</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_gn</span> <span class="op">&lt;-</span> <span class="va">up_gn</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="va">down_gn</span> <span class="op">&lt;-</span> <span class="va">down_gn</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="co"># names(up_gn) &lt;- paste0("genus_UP_", names(up_gn))</span></span>
<span><span class="co"># names(down_gn) &lt;- paste0("genus_DOWN_", names(down_gn))</span></span></code></pre></div>
<p>Species signatures:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span> <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"species"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bugsigdbr/man/getMetaSignatures.html" class="external-link">getMetaSignatures</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">bsdb</span>, column <span class="op">=</span>  <span class="st">"Condition"</span>, direction <span class="op">=</span> <span class="st">"DOWN"</span>,</span>
<span>    min.studies <span class="op">=</span> <span class="fl">2</span>, min.taxa <span class="op">=</span> <span class="fl">5</span>, tax.id.type <span class="op">=</span> <span class="st">"ncbi"</span>,</span>
<span>    tax.level <span class="op">=</span> <span class="st">"species"</span>, exact.tax.level <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">common_names_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_sp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="va">up_sp</span><span class="op">[</span><span class="va">common_names_sp</span><span class="op">]</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="va">down_sp</span><span class="op">[</span><span class="va">common_names_sp</span><span class="op">]</span></span>
<span><span class="va">remove_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="va">down_sp</span>, <span class="op">~</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="va">remove_sp</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">down_sp</span>, <span class="va">remove_sp</span>, <span class="op">~</span> <span class="va">.x</span><span class="op">[</span><span class="op">!</span><span class="va">.x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">.y</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">up_sp</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html" class="external-link">discard</a></span><span class="op">(</span><span class="va">down_sp</span>,<span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">up_sp</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">down_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up_sp</span> <span class="op">&lt;-</span> <span class="va">up_sp</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="va">down_sp</span> <span class="op">&lt;-</span> <span class="va">down_sp</span><span class="op">[</span><span class="va">keep_names</span><span class="op">]</span></span>
<span><span class="co"># names(up_sp) &lt;- paste0("species_UP_", names(up_sp))</span></span>
<span><span class="co"># names(down_sp) &lt;- paste0("species_DOWN_", names(down_sp))</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Columns that make BSDB ID: Study, Experiment, Signature page name</span></span>
<span><span class="co"># l &lt;- bsdb |&gt; </span></span>
<span><span class="co">#     select(</span></span>
<span><span class="co">#         Study, Experiment, `Signature page name`, `Abundance in Group 1`</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         xcol = paste0(`Abundance in Group 1`, " (", `Signature page name`, ")")</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     group_by(Study, Experiment) |&gt; </span></span>
<span><span class="co">#     mutate(ycol = sort(paste0(xcol, collapse = "; "))) |&gt; </span></span>
<span><span class="co">#     mutate(n_sig = n()) |&gt; </span></span>
<span><span class="co">#     ungroup() |&gt; </span></span>
<span><span class="co">#     select(-xcol) |&gt; </span></span>
<span><span class="co">#     filter(n_sig == 2) |&gt; </span></span>
<span><span class="co">#     filter(grepl("decreased", ycol), grepl("increased", ycol)) |&gt; </span></span>
<span><span class="co">#     filter(grepl("Signature 1", ycol), grepl("Signature 2", ycol)) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         `BSDB ID` = paste0(</span></span>
<span><span class="co">#             "bsdb:",</span></span>
<span><span class="co">#             sub("Study ", "", Study), "/",</span></span>
<span><span class="co">#             sub("Experiment ", "", Experiment), "/",</span></span>
<span><span class="co">#             sub("Signature ", "", `Signature page name`)</span></span>
<span><span class="co">#         )</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         custom_id = paste0(</span></span>
<span><span class="co">#             "bsdb:",</span></span>
<span><span class="co">#             sub("Study ", "", Study), "/",</span></span>
<span><span class="co">#             sub("Experiment ", "", Experiment)</span></span>
<span><span class="co">#         )</span></span>
<span><span class="co">#     ) |&gt; </span></span>
<span><span class="co">#     relocate(custom_id, `BSDB ID`) |&gt; </span></span>
<span><span class="co">#     {\(y) split(y, y$`Abundance in Group 1`)}() |&gt; </span></span>
<span><span class="co">#     map(~ pull(arrange(.x, custom_id), `BSDB ID`))</span></span>
<span><span class="co"># map(l, length)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="genus">Genus<a class="anchor" aria-label="anchor" href="#genus"></a>
</h2>
<p>Create signatures for both decrease and increase at the
<strong>genus</strong> level. Only keep the signature names (stored in a
data.frame) that have enough taxa in both increased and decreased
sets.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lg &lt;- map(l, ~ {</span></span>
<span><span class="co">#     bsdb |&gt; </span></span>
<span><span class="co">#         filter(`BSDB ID` %in% .x) |&gt; </span></span>
<span><span class="co">#         getSignatures(</span></span>
<span><span class="co">#             tax.id.type = "ncbi", tax.level = "genus", exact.tax.level = FALSE,</span></span>
<span><span class="co">#             min.size = 5</span></span>
<span><span class="co">#         ) |&gt; </span></span>
<span><span class="co">#         keep(~ length(.x) &gt;= 5)</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># df_gn_1 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(lg$decreased)), "-%-%-", names(lg$decreased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_down"), sep = "-%-%-")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_gn_2 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(lg$increased)), "-%-%-", names(lg$increased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_up"), sep = "-%-%-")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_gn &lt;- full_join(df_gn_1, df_gn_2, by = "custom_id") |&gt; </span></span>
<span><span class="co">#     drop_na() |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         check = sub("bsdb:\\d+/\\d+/\\d+_(.*)_UP", "\\1", sig_up) ==</span></span>
<span><span class="co">#            sub("bsdb:\\d+/\\d+/\\d+_(.*)_DOWN", "\\1", sig_down)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># dim(df_gn)    </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="species">Species<a class="anchor" aria-label="anchor" href="#species"></a>
</h2>
<p>Create signatures for both decrease and increase at the
<strong>species</strong> level. Only keep the signature names (stored in
a data.frame) that have enough taxa in both increased and decreased
sets.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ls &lt;- map(l, ~ {</span></span>
<span><span class="co">#     bsdb |&gt; </span></span>
<span><span class="co">#         filter(`BSDB ID` %in% .x) |&gt; </span></span>
<span><span class="co">#         getSignatures(</span></span>
<span><span class="co">#             tax.id.type = "ncbi", tax.level = "species",</span></span>
<span><span class="co">#             exact.tax.level = FALSE, min.size = 5</span></span>
<span><span class="co">#         ) |&gt; </span></span>
<span><span class="co">#         keep(~ length(.x) &gt;= 5)</span></span>
<span><span class="co"># })</span></span>
<span><span class="co"># df_sp_1 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(ls$decreased)), "-%-%-", names(ls$decreased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_down"), sep = "-%-%-")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_sp_2 &lt;- data.frame(</span></span>
<span><span class="co">#     x = paste0(</span></span>
<span><span class="co">#         sub("/\\d_.*", "", names(ls$increased)), "-%-%-", names(ls$increased)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># ) |&gt; </span></span>
<span><span class="co">#     separate(col = "x", into = c("custom_id", "sig_up"), sep = "-%-%-")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># df_sp &lt;- full_join(df_sp_1, df_sp_2, by = "custom_id") |&gt; </span></span>
<span><span class="co">#     drop_na() |&gt; </span></span>
<span><span class="co">#     mutate(</span></span>
<span><span class="co">#         check = sub("bsdb:\\d+/\\d+/\\d+_(.*)_UP", "\\1", sig_up) ==</span></span>
<span><span class="co">#             sub("bsdb:\\d+/\\d+/\\d+_(.*)_DOWN", "\\1", sig_down)</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># dim(df_sp)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-lists-of-bsdb-signatures">Get lists of BSDB signatures<a class="anchor" aria-label="anchor" href="#get-lists-of-bsdb-signatures"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigs_list_gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sigs_list_gn</span><span class="op">[[</span><span class="st">"up"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">up_gn</span></span>
<span><span class="va">sigs_list_gn</span><span class="op">[[</span><span class="st">"down"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">down_gn</span> </span>
<span><span class="co"># sigs_list_gn[["up"]] &lt;- lg$increased[df_gn$sig_up]</span></span>
<span><span class="co"># sigs_list_gn[["down"]] &lt;- lg$decreased[df_gn$sig_down]</span></span>
<span></span>
<span><span class="va">sigs_list_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sigs_list_sp</span><span class="op">[[</span><span class="st">"up"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">up_sp</span></span>
<span><span class="va">sigs_list_sp</span><span class="op">[[</span><span class="st">"down"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">down_sp</span> </span>
<span><span class="co"># sigs_list_sp[["up"]] &lt;- ls$increased[df_sp$sig_up]</span></span>
<span><span class="co"># sigs_list_sp[["down"]] &lt;- ls$decreased[df_sp$sig_down]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="odds-ratio---function">Odds ratio - function<a class="anchor" aria-label="anchor" href="#odds-ratio---function"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">or</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">s</span><span class="op">)</span></span>
<span>    <span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span>, event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># suppressWarnings({</span></span>
<span>    <span class="co">#     res &lt;- epitools::oddsratio.wald(ct)</span></span>
<span>    <span class="co"># })</span></span>
<span>    <span class="va">p_value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ct</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">ct</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">HA</span> <span class="op">&lt;-</span> <span class="st">"*"</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="co"># res &lt;- epitools::oddsratio.small(ct)</span></span>
<span>            <span class="co"># p_value = fisher.test(x = ct + 0.5, alternative = "two.sided")$p.value</span></span>
<span>            <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">epitools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/epitools/man/oddsratio.html" class="external-link">oddsratio.wald</a></span><span class="op">(</span><span class="va">ct</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># I get a lot of caution messages about not using this funcion</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">HA</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="co"># p_value = fisher.test(x = ct, alternative = "two.sided")$p.value</span></span>
<span>            <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">epitools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/epitools/man/oddsratio.html" class="external-link">oddsratio.wald</a></span><span class="op">(</span><span class="va">ct</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>       odds_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"estimate"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       lower_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"lower"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       upper_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"upper"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       <span class="co"># p_value = res$p.value[2, "fisher.exact"],</span></span>
<span>       p_value <span class="op">=</span> <span class="va">p_value</span>,</span>
<span>       <span class="co"># method = method,</span></span>
<span>       HA <span class="op">=</span> <span class="va">HA</span>,</span>
<span>       up_annotated <span class="op">=</span> <span class="va">a</span>,</span>
<span>       up_noAnnotated <span class="op">=</span> <span class="va">b</span>,</span>
<span>       down_annotated <span class="op">=</span> <span class="va">c</span>,</span>
<span>       down_noAnnotated <span class="op">=</span> <span class="va">d</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-odds-ratio-and-p-values">Calculate odds ratio and p values<a class="anchor" aria-label="anchor" href="#calculate-odds-ratio-and-p-values"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">'extdata'</span>, <span class="st">'condition2category.tsv'</span>, package <span class="op">=</span> <span class="st">'bugphyzzAnalyses'</span>,</span>
<span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cond2cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">fname</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">'\t'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu">or</span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            y <span class="op">=</span> <span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">down</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            s <span class="op">=</span> <span class="va">bp_sigs_gn</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gn</span><span class="op">)</span><span class="op">[</span><span class="va">counter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs_list_gn</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"-%-%-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_gn</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"-%-%-genus"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">gn</span><span class="op">[[</span><span class="va">counter</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">odds_ratio</span></span>
<span>        <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">gn_df</span> <span class="op">&lt;-</span> <span class="va">gn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"name"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span>, <span class="st">"bp_sig"</span>, <span class="st">"rank"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"-%-%-"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        bp_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)$"</span>, <span class="st">"\\1"</span>, <span class="va">bp_sig</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gn_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3350   13</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu">or</span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            y <span class="op">=</span> <span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">down</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            s <span class="op">=</span> <span class="va">bp_sigs_sp</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[</span><span class="va">counter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sigs_list_sp</span><span class="op">$</span><span class="va">up</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"-%-%-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bp_sigs_sp</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"-%-%-genus"</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">sp</span><span class="op">[[</span><span class="va">counter</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">odds_ratio</span></span>
<span>        <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sp_df</span> <span class="op">&lt;-</span> <span class="va">sp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span></span>
<span>        col <span class="op">=</span> <span class="st">"name"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span>, <span class="st">"bp_sig"</span>, <span class="st">"rank"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"-%-%-"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        bp_sig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^bugphyzz:(.*)$"</span>, <span class="st">"\\1"</span>, <span class="va">bp_sig</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">cond2cat</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span> <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sp_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2958   13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merge-gn-and-sp">Merge gn and sp<a class="anchor" aria-label="anchor" href="#merge-gn-and-sp"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mainDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">gn_df</span>, <span class="va">sp_df</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        fdr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p_value</span>, method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>        p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_value</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">fdr</span>, .after <span class="op">=</span> <span class="va">p_value</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mainDF</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6308   14</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---table-up">odds ratio - genus - table up<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---table-up"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genus_table_up</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"genus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">genus_table_up</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-76389f362f5f943ac60c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-76389f362f5f943ac60c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2.2\" data-max=\"53.32\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.63\" data-max=\"3.64\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4.51\" data-max=\"1190.84\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.049\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.048\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"60\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"111\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"36\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4\" data-max=\"72\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["multiple myeloma","hiv infection","atopic eczema","atopic eczema","chronic kidney disease","acute lymphoblastic leukemia","gastric cancer","hiv infection","schizophrenia","type i diabetes mellitus","asthma","irritable bowel syndrome","multiple myeloma","asthma","crohn's disease","gastric cancer","squamous cell carcinoma","type ii diabetes mellitus","atopic eczema","chronic kidney disease","intestinal polyp","anorexia nervosa","chronic fatigue syndrome","gastric cancer","chronic kidney disease","chronic kidney disease","atopic eczema","multiple myeloma","multiple myeloma","atopic eczema","esophageal cancer","asthma","periodontitis","hiv infection","schizophrenia","age","age","multiple myeloma","endometriosis","gastric cancer","irritable bowel syndrome","chronic kidney disease","endometriosis","multiple myeloma","multiple myeloma","multiple myeloma","hashimoto's thyroiditis","breast cancer","covid-19","breast cancer","intestinal polyp","multiple myeloma","hiv infection","esophageal cancer","food allergy","oral squamous cell carcinoma","covid-19","psoriasis","ulcerative colitis","irritable bowel syndrome","obesity","breast cancer","chronic hepatitis b virus infection","chronic kidney disease","multiple myeloma","gastric cancer","gastric cancer","psoriasis","chronic hepatitis b virus infection","chronic fatigue syndrome","crohn's disease","obesity","type ii diabetes mellitus","colorectal cancer","colorectal cancer","covid-19","irritable bowel syndrome","periodontitis","pancreatic carcinoma","parkinson's disease","irritable bowel syndrome","type ii diabetes mellitus","endometriosis","colorectal cancer","irritable bowel syndrome","parkinson's disease","type ii diabetes mellitus","parkinson's disease","covid-19","colorectal cancer","colorectal cancer","colorectal cancer","parkinson's disease","parkinson's disease","covid-19","parkinson's disease"],["aerophilicity|aerobic","biosafety level|biosafety level 2","aerophilicity|facultatively anaerobic","arrangement|paired cells","arrangement|cell chain","animal pathogen|FALSE","gram stain|gram stain negative","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain negative","habitat|waste and sludge water","shape|bacillus","health associated|FALSE","aerophilicity|facultatively anaerobic","gram stain|gram stain negative","aerophilicity|facultatively anaerobic","animal pathogen|TRUE","motility|TRUE","growth temperature|psychrophile| &gt; 5.3 &amp; &lt;= 25","host-associated|TRUE","gram stain|gram stain positive","antimicrobial sensitivity|FALSE","gram stain|gram stain positive","health associated|FALSE","cogem pathogenicity rating|cogem pathogenicity rating 2","aerophilicity|aerobic","hemolysis|beta","arrangement|cell chain","width|small| &gt; -0.01 &amp; &lt;= 0.9","habitat|oral","extreme environment|TRUE","shape|bacillus","antimicrobial sensitivity|FALSE","aerophilicity|anaerobic","habitat|colonization of host","host-associated|FALSE","shape|bacillus","animal pathogen|FALSE","hemolysis|beta","shape|elliptic","host-associated|TRUE","optimal ph|neutral| &gt; 6 &amp; &lt;= 8","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","habitat|human urine","arrangement|cell chain","biofilm formation|TRUE","gram stain|gram stain negative","gram stain|gram stain positive","biosafety level|biosafety level 2","gram stain|gram stain variable","cogem pathogenicity rating|cogem pathogenicity rating 2","cogem pathogenicity rating|cogem pathogenicity rating 2","length|small| &gt; 0.19 &amp; &lt;= 3.8","biosafety level|biosafety level 2","antimicrobial sensitivity|FALSE","animal pathogen|FALSE","cogem pathogenicity rating|cogem pathogenicity rating 2","arrangement|cell chain","habitat|human microbiome","cogem pathogenicity rating|cogem pathogenicity rating 2","habitat|colonization of host","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","gram stain|gram stain negative","host-associated|FALSE","host-associated|TRUE","host-associated|TRUE","antimicrobial sensitivity|TRUE","spore formation|FALSE","motility|FALSE","motility|TRUE","shape|bacillus","gram stain|gram stain positive","shape|coccus","aerophilicity|aerobic","motility|TRUE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","antimicrobial sensitivity|FALSE","habitat|feces","aerophilicity|anaerobic","animal pathogen|TRUE","arrangement|cell chain","habitat|digestive system","cogem pathogenicity rating|cogem pathogenicity rating 1","habitat|waste and sludge water","biosafety level|biosafety level 2","extreme environment|FALSE","shape|bacillus","host-associated|FALSE","habitat|feces","host-associated|TRUE","host-associated|TRUE","coding genes|average| &gt; 600 &amp; &lt;= 6000","genome size|large| &gt; 998123 &amp; &lt;= 6997434","habitat|colonization of host","host-associated|TRUE","cogem pathogenicity rating|cogem pathogenicity rating 2","shape|bacillus"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],[53.32,52,46.14,46.14,42.27,39,37.5,36.14,31.15,30,30,29.23,28.93,28.6,28,28,23,21.2,20,20,19.19,17.5,17.31,17.14,16.41,16.41,16.08,16,15.77,15.67,15.52,15.06,15,14.67,14.47,14.4,14.4,14.21,14,13.75,13.24,13.1,12.95,12.15,12.15,12.13,12,12,11.97,11,11,10.18,10,9.5,9.33,9.199999999999999,8.699999999999999,8.67,8.27,8,7.76,7.67,7.5,7.5,7.5,6.56,6.56,6.54,6.5,6,5.63,5.57,5.09,5.08,5.06,4.75,4.75,4.71,4.18,4.03,3.86,3.71,3.67,3.42,3.4,3.32,3.31,3.16,3.01,2.85,2.63,2.63,2.63,2.27,2.22,2.2],[2.97,2.62,2.07,2.07,2.06,1.28,3.64,1.58,1.53,2.22,1.47,1.53,3.46,1.12,3.08,2.82,1.16,1.19,1.68,2.77,1.02,1.22,0.8,1.79,0.79,0.79,0.75,1.74,0.84,0.74,0.79,0.8,1.34,1.16,0.82,1.37,1.37,1.68,1.6,1.45,1.44,0.65,0.66,1.42,1.42,2.41,1.76,1.25,0.63,1.64,1.82,1.09,1.13,1.27,1.91,1.3,1.14,0.9,1.48,2.41,0.89,1.22,1.17,1.2,1.47,1.26,1.26,1.22,1.26,1.08,1.74,1.47,1.77,1.02,1.33,1.07,1.53,1.36,1.21,1.13,1.2,1.42,1.16,1.3,1.07,1.43,1.32,1.33,1.45,1.16,1.14,1.14,1.18,1.14,1.08,1.06],[955.86,1033.83,1028.71,1028.71,869.24,1190.84,386.51,828.85,633.14,405.98,611.8,556.64,242.14,731.54,254.45,277.96,455.9,377.98,238.63,144.31,360.51,250.36,373.45,163.81,342.8,342.8,343.62,147.54,294.62,331.2,303.25,282.82,167.64,185.23,255.85,150.81,150.81,120.51,122.33,130.24,121.66,265.42,253.86,103.82,103.82,61.2,81.73999999999999,115.36,227.1,73.97,66.37,94.83,88.48999999999999,70.95999999999999,45.58,64.89,66.62,83.17,46.31,26.57,67.58,48.05,48.15,47.05,38.32,34.2,34.2,35.12,33.58,33.32,18.2,21.17,14.65,25.38,19.15,20.98,14.72,16.29,14.42,14.34,12.43,9.66,11.6,8.960000000000001,10.76,7.69,8.289999999999999,7.46,6.27,7.02,6.06,6.06,5.88,4.52,4.58,4.58],[0,0.006,0.001,0.001,0.001,0.015,0,0.005,0.005,0.006,0.029,0.003,0,0.021,0.001,0.002,0.008,0.003,0.017,0.002,0.013,0.041,0.029,0.007,0.028,0.028,0.038,0.007,0.023,0.04,0.027,0.016,0.024,0.038,0.015,0.029,0.029,0.005,0.007,0.018,0.012,0.047,0.036,0.012,0.012,0.002,0.014,0.028,0.037,0.014,0.008999999999999999,0.041,0.025,0.033,0.006,0.031,0.01,0.049,0.018,0.001,0.048,0.037,0.038,0.047,0.01,0.047,0.047,0.037,0.029,0.039,0.005,0.007,0.002,0.044,0.013,0.027,0.008999999999999999,0.016,0.025,0.028,0.031,0.007,0.029,0.012,0.039,0.007,0.014,0.008,0.004,0.029,0.025,0.025,0.017,0.024,0.033,0.036],[0.048,1,0.728,0.728,0.703,1,0.479,1,1,1,1,0.797,0.122,1,0.577,0.728,1,0.829,1,0.728,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.728,1,1,1,1,1,1,1,1,1,1,1,1,1,0.68,1,1,1,1,1,1,1,1,1,1,1,1,0.728,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],["*","","*","*","*","*","","*","*","","","*","","*","","","*","*","","","*","","*","","*","*","*","","*","*","*","*","","","*","","","","","","","*","*","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],[14,4,8,8,7,6,10,5,13,6,6,5,15,5,6,10,11,9,10,10,8,7,4,10,4,4,5,9,6,3,8,8,10,4,15,9,9,10,8,10,5,12,4,9,9,13,12,18,4,22,11,7,8,4,14,23,21,4,26,12,44,23,6,10,27,7,7,17,8,12,13,14,21,8,42,23,11,24,17,19,9,23,14,18,17,45,26,35,41,35,29,29,37,60,40,43],[15,1,3,3,5,0,1,0,6,2,1,17,14,2,12,1,8,34,1,2,15,1,6,1,8,8,6,9,23,10,0,17,1,1,37,5,5,19,16,1,17,0,20,20,20,5,4,9,54,5,2,11,16,4,6,2,111,18,2,10,1,4,6,2,2,4,4,2,4,2,5,31,22,37,3,109,11,8,5,77,13,20,10,27,5,13,17,61,17,10,16,16,59,36,18,53],[0,1,0,0,0,1,4,3,0,1,1,0,1,0,1,5,0,0,3,3,0,2,0,7,0,0,0,1,0,0,11,0,4,3,0,1,1,1,1,8,1,10,0,1,1,3,2,1,0,2,6,1,1,2,3,5,1,1,11,6,34,3,2,6,18,4,4,13,4,11,18,3,6,2,36,2,8,7,13,3,7,9,8,8,23,24,12,8,32,27,20,20,10,22,36,14],[28,13,9,9,15,4,15,11,7,10,5,46,27,6,56,14,8,38,6,12,17,5,12,12,15,15,9,16,28,23,10,15,6,11,17,8,8,27,28,11,45,5,29,27,27,14,8,6,72,5,12,16,20,19,12,4,46,39,7,40,6,4,15,9,10,15,15,10,13,11,39,37,32,47,13,45,38,11,16,49,39,29,21,41,23,23,26,44,40,22,29,29,42,30,36,38],["cancer","infectious disease","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","infectious disease","mental disease","metabolic disease","anatomical system disease","anatomical system disease","cancer","anatomical system disease","anatomical system disease","cancer","cancer","metabolic disease","anatomical system disease","anatomical system disease","cancer","metabolic disease","anatomical system disease","cancer","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","anatomical system disease","cancer","anatomical system disease","anatomical system disease","infectious disease","mental disease","environment, sociodemographics, lifestyle","environment, sociodemographics, lifestyle","cancer","anatomical system disease","cancer","anatomical system disease","anatomical system disease","anatomical system disease","cancer","cancer","cancer","anatomical system disease","cancer","infectious disease","cancer","cancer","cancer","infectious disease","cancer","anatomical system disease","cancer","infectious disease","anatomical system disease","anatomical system disease","anatomical system disease","metabolic disease","cancer","infectious disease","anatomical system disease","cancer","cancer","cancer","anatomical system disease","infectious disease","anatomical system disease","anatomical system disease","metabolic disease","metabolic disease","cancer","cancer","infectious disease","anatomical system disease","anatomical system disease","cancer","mental disease","anatomical system disease","metabolic disease","anatomical system disease","cancer","anatomical system disease","mental disease","metabolic disease","mental disease","infectious disease","cancer","cancer","cancer","mental disease","mental disease","infectious disease","mental disease"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---heatmap-up">Odds ratio - genus - heatmap up<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_mat_up</span> <span class="op">&lt;-</span> <span class="va">genus_table_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "genus") |&gt; </span></span>
<span>    <span class="co"># filter(p_value &lt; 0.05, odds_ratio &gt; 1) |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">gn_hp_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">gn_mat_up</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">gn_mat_up</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gn_mat_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">gn_hp_up</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---table-down">odds ratio - genus - table down<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---table-down"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genus_table_down</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"genus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">genus_table_down</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ee91ac655be674ba7776" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ee91ac655be674ba7776">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.03\" data-max=\"0.41\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.18\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.23\" data-max=\"1.43\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.048\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.048\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"35\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"130\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"38\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"53\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["colorectal cancer","obesity","covid-19","covid-19","colorectal cancer","obesity","colorectal cancer","chronic kidney disease","covid-19","endometriosis","pancreatic carcinoma","type ii diabetes mellitus","endometriosis","lung cancer","crohn's disease","type ii diabetes mellitus","parkinson's disease","eczema","psoriasis","type ii diabetes mellitus","squamous cell carcinoma","chronic fatigue syndrome","oral squamous cell carcinoma","ulcerative colitis","psoriasis","parkinson's disease","type ii diabetes mellitus","type ii diabetes mellitus","type ii diabetes mellitus","colorectal cancer","schizophrenia","covid-19","multiple myeloma","type ii diabetes mellitus","esophageal cancer","multiple myeloma","type ii diabetes mellitus","hiv infection","chronic kidney disease","irritable bowel syndrome","ulcerative colitis","food allergy","hashimoto's thyroiditis","periodontitis","autism","irritable bowel syndrome","parkinson's disease","psoriasis","colorectal cancer","gastric cancer","multiple myeloma","multiple myeloma","age","age","atopic eczema","eczema","hashimoto's thyroiditis","hashimoto's thyroiditis","multiple sclerosis","periodontitis","multiple myeloma","obesity","type ii diabetes mellitus","ulcerative colitis","oral squamous cell carcinoma","multiple myeloma","multiple myeloma","type ii diabetes mellitus","breast carcinoma","head and neck carcinoma","multiple myeloma","squamous cell carcinoma","type ii diabetes mellitus","atopic eczema","breast cancer","breast cancer","acute lymphoblastic leukemia","breast carcinoma","breast carcinoma"],["aerophilicity|aerobic","habitat|feces","cogem pathogenicity rating|cogem pathogenicity rating 1","aerophilicity|aerobic","length|small| &gt; 0.19 &amp; &lt;= 3.8","shape|bacillus","width|small| &gt; -0.01 &amp; &lt;= 0.9","aerophilicity|anaerobic","host-associated|FALSE","gram stain|gram stain negative","animal pathogen|FALSE","host-associated|TRUE","length|small| &gt; 0.19 &amp; &lt;= 3.8","shape|bacillus","gram stain|gram stain negative","hemolysis|gamma","habitat|waste and sludge water","gram stain|gram stain positive","host-associated|FALSE","cogem pathogenicity rating|cogem pathogenicity rating 2","gram stain|gram stain positive","gram stain|gram stain negative","animal pathogen|FALSE","biosafety level|biosafety level 1","animal pathogen|FALSE","host-associated|FALSE","aerophilicity|anaerobic","coding genes|average| &gt; 600 &amp; &lt;= 6000","genome size|large| &gt; 998123 &amp; &lt;= 6997434","arrangement|single","aerophilicity|anaerobic","biofilm formation|FALSE","gram stain|gram stain positive","plant pathogenicity|FALSE","antimicrobial sensitivity|TRUE","spore formation|TRUE","hemolysis|gamma","biosafety level|biosafety level 1","gram stain|gram stain negative","hemolysis|gamma","habitat|human microbiome","animal pathogen|TRUE","gram stain|gram stain negative","aerophilicity|aerobic","shape|coccus","arrangement|cell chain","shape|spirillum","motility|TRUE","biofilm formation|FALSE","gram stain|gram stain positive","habitat|free-living","habitat|human gut microbiome","arrangement|paired cells","width|average| &gt; 0.9 &amp; &lt;= 3.5","extreme environment|FALSE","shape|coccus","shape|bacillus","sphingolipid producing|TRUE","spore formation|TRUE","shape|coccus","spore shape|endospore","arrangement|cell chain","shape|bacillus","cogem pathogenicity rating|cogem pathogenicity rating 1","cogem pathogenicity rating|cogem pathogenicity rating 1","aerophilicity|anaerobic","host-associated|FALSE","aerophilicity|aerobic","habitat|waste and sludge water","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","motility|FALSE","growth temperature|mesophile| &gt; 25 &amp; &lt;= 45","aerophilicity|anaerobic","habitat|human gut microbiome","spore shape|endospore","animal pathogen|TRUE","animal pathogen|FALSE","spore formation|FALSE"],["genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus","genus"],[0.41,0.38,0.37,0.35,0.34,0.34,0.32,0.3,0.29,0.27,0.27,0.27,0.25,0.25,0.24,0.24,0.24,0.2,0.2,0.2,0.2,0.19,0.19,0.17,0.15,0.15,0.14,0.14,0.14,0.13,0.13,0.13,0.12,0.12,0.11,0.11,0.11,0.1,0.1,0.1,0.1,0.08,0.08,0.08,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.07000000000000001,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.06,0.05,0.05,0.05,0.05,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.04,0.03,0.03,0.03],[0.18,0.17,0.16,0.16,0.16,0.13,0.15,0.09,0.13,0.09,0.08,0.11,0.07000000000000001,0.07000000000000001,0.08,0.07000000000000001,0.07000000000000001,0.05,0.05,0.08,0.05,0.04,0.04,0.04,0.03,0.04,0.05,0.03,0.03,0.02,0.02,0.02,0.03,0.02,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.02,0.01,0.02,0,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0,0.01,0,0,0,0,0,0,0,0,0,0,0,0,0],[0.96,0.84,0.83,0.76,0.75,0.91,0.71,0.9399999999999999,0.62,0.85,0.9399999999999999,0.6899999999999999,0.9,0.88,0.77,0.82,0.84,0.85,0.9,0.53,0.84,0.88,0.91,0.79,0.82,0.6,0.39,0.72,0.72,1.08,1.05,0.6899999999999999,0.55,0.77,0.79,1.02,1.03,0.88,1.02,0.8,1,0.42,0.57,0.46,1.42,1.29,1.23,0.64,1.35,1.42,1.38,1.38,1.43,1.43,1.35,1.14,1.2,1.42,1.35,1.36,1.1,1.07,0.63,1.29,0.57,0.23,0.9,0.92,0.62,0.92,0.68,0.86,0.73,0.78,0.95,0.95,0.78,0.55,0.55],[0.043,0.021,0.02,0.008999999999999999,0.008,0.036,0.005,0.046,0.002,0.029,0.046,0.007,0.04,0.036,0.016,0.03,0.026,0.03,0.048,0.001,0.039,0.041,0.04,0.028,0.037,0.004,0,0.025,0.025,0.037,0.03,0.014,0.007,0.041,0.033,0.041,0.044,0.025,0.043,0.013,0.042,0.002,0.014,0.002,0.029,0.027,0.016,0.006,0.027,0.029,0.023,0.023,0.047,0.047,0.04,0.017,0.023,0.046,0.04,0.035,0.01,0.013,0.008,0.037,0.012,0,0.004,0.008,0.035,0.035,0.003,0.008,0.001,0.008,0.037,0.037,0.015,0.029,0.029],[1,1,1,1,1,1,1,1,0.728,1,1,1,1,1,1,1,1,1,1,0.728,1,1,1,1,1,1,0.175,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.728,1,0.753,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.048,1,1,1,1,0.829,1,0.728,1,1,1,1,1,1],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","*","","*","*","*","*","*","*","*","*","*","*","*","*","*","*","","*","","","*","*","","*","*","*","*","*","*","*","*","",""],[11,15,11,12,15,26,15,13,13,9,5,16,4,12,5,29,4,3,3,17,4,3,3,4,2,3,15,3,3,1,35,2,4,6,4,1,1,16,1,1,1,5,4,2,0,0,0,1,0,0,0,0,0,0,10,0,9,0,0,0,0,0,1,0,1,9,0,0,2,5,10,8,33,0,0,0,0,1,1],[41,42,47,46,37,19,37,11,45,15,17,27,20,11,13,14,92,14,16,26,18,11,38,20,17,93,28,10,10,51,17,130,14,7,4,17,12,8,11,21,23,15,12,30,11,46,58,18,45,11,29,29,14,14,3,17,7,16,21,11,29,57,12,24,24,20,29,13,5,2,8,11,10,11,27,27,6,6,6],[24,28,28,31,33,32,34,28,36,20,15,26,13,22,35,34,8,15,11,29,9,13,5,7,10,9,30,11,11,8,16,5,12,14,19,6,7,20,7,15,4,12,8,8,7,6,5,10,6,7,5,5,3,3,23,9,10,3,3,4,6,7,9,3,4,25,7,7,9,28,17,8,38,5,2,2,4,6,6],[37,30,44,41,28,8,27,7,36,9,14,12,16,5,22,4,44,14,12,9,8,9,12,6,13,43,8,5,5,53,1,42,5,2,2,11,9,1,8,31,9,3,2,10,12,42,42,13,43,12,23,23,6,6,0,20,0,7,9,6,22,51,7,10,5,3,21,9,1,0,0,0,0,4,5,5,1,1,1],["cancer","metabolic disease","infectious disease","infectious disease","cancer","metabolic disease","cancer","anatomical system disease","infectious disease","anatomical system disease","cancer","metabolic disease","anatomical system disease","cancer","anatomical system disease","metabolic disease","mental disease","anatomical system disease","anatomical system disease","metabolic disease","cancer","anatomical system disease","cancer","anatomical system disease","anatomical system disease","mental disease","metabolic disease","metabolic disease","metabolic disease","cancer","mental disease","infectious disease","cancer","metabolic disease","cancer","cancer","metabolic disease","infectious disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","mental disease","anatomical system disease","mental disease","anatomical system disease","cancer","cancer","cancer","cancer","environment, sociodemographics, lifestyle","environment, sociodemographics, lifestyle","anatomical system disease","anatomical system disease","anatomical system disease","anatomical system disease","mental disease","anatomical system disease","cancer","metabolic disease","metabolic disease","anatomical system disease","cancer","cancer","cancer","metabolic disease","cancer","cancer","cancer","cancer","metabolic disease","anatomical system disease","cancer","cancer","cancer","cancer","cancer"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---genus---heatmap-down">odds ratio - genus - heatmap down<a class="anchor" aria-label="anchor" href="#odds-ratio---genus---heatmap-down"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gn_mat_down</span> <span class="op">&lt;-</span> <span class="va">genus_table_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "genus") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gn_hp_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">gn_mat_down</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">gn_mat_down</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gn_mat_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">gn_hp_down</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---table-up">odds ratio - species - table up<a class="anchor" aria-label="anchor" href="#odds-ratio---species---table-up"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_table_up</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">species_table_up</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3fb6ab1aa4efda5d9ee7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3fb6ab1aa4efda5d9ee7">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---heatmap-up">Odds ratio - species - heatmap up<a class="anchor" aria-label="anchor" href="#odds-ratio---species---heatmap-up"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_mat_up</span> <span class="op">&lt;-</span> <span class="va">species_table_up</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "species") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp_hp_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">sp_mat_up</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">sp_mat_up</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sp_mat_up</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">sp_hp_up</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---table-down">Odds ratio - species - table down<a class="anchor" aria-label="anchor" href="#odds-ratio---species---table-down"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_table_down</span> <span class="op">&lt;-</span> <span class="va">mainDF</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rank</span> <span class="op">==</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">odds_ratio</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/myDataTable.html">myDataTable</a></span><span class="op">(</span><span class="va">species_table_down</span>, <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-8273f5732d15569ed6b1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8273f5732d15569ed6b1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[[],[],[],[],[],[],[],[],[],[],[],[],[],[]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>condition<\/th>\n      <th>bp_sig<\/th>\n      <th>rank<\/th>\n      <th>odds_ratio<\/th>\n      <th>lower_ci<\/th>\n      <th>upper_ci<\/th>\n      <th>p_value<\/th>\n      <th>fdr<\/th>\n      <th>HA<\/th>\n      <th>up_annotated<\/th>\n      <th>up_noAnnotated<\/th>\n      <th>down_annotated<\/th>\n      <th>down_noAnnotated<\/th>\n      <th>Category<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"lBfrtip","paging":true,"pageLength":30,"buttons":[{"extend":"copy","title":null},{"extend":"print","title":null},{"extend":"csv","title":null}],"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,9,10,11,12]},{"name":"condition","targets":0},{"name":"bp_sig","targets":1},{"name":"rank","targets":2},{"name":"odds_ratio","targets":3},{"name":"lower_ci","targets":4},{"name":"upper_ci","targets":5},{"name":"p_value","targets":6},{"name":"fdr","targets":7},{"name":"HA","targets":8},{"name":"up_annotated","targets":9},{"name":"up_noAnnotated","targets":10},{"name":"down_annotated","targets":11},{"name":"down_noAnnotated","targets":12},{"name":"Category","targets":13}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,30,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="odds-ratio---species---heatmap-down">Odds ratio - species - heatmap down<a class="anchor" aria-label="anchor" href="#odds-ratio---species---heatmap-down"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_mat_down</span> <span class="op">&lt;-</span> <span class="va">species_table_down</span> <span class="op">|&gt;</span> </span>
<span>    <span class="co"># filter(rank == "species") |&gt; </span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="va">odds_ratio</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Category</span>, <span class="va">bp_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        names_from <span class="op">=</span> <span class="st">"Category"</span>, values_from <span class="op">=</span> <span class="st">"n"</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"bp_sig"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp_hp_down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">sp_mat_down</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">color_fun</span><span class="op">(</span><span class="va">sp_mat_down</span><span class="op">)</span>, </span>
<span>    border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>, show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"# sigs"</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray50"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>        row_names_max_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/max_text_width.html" class="external-link">max_text_width</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sp_mat_down</span><span class="op">)</span>,</span>
<span>        gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">sp_hp_down</span></span></code></pre></div>
<p><img src="up_vs_down_metasignatures_nointersect_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       Etc/UTC</span></span>
<span><span class="co">#&gt;  date     2024-02-27</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package         </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version </span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  BiocFileCache      2.10.1   <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocGenerics       0.48.1   <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit                4.0.5    <span style="color: #555555;">2022-11-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bit64              4.0.5    <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  blob               1.2.4    <span style="color: #555555;">2023-03-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bold               1.3.0    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bslib              0.6.1    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  bugphyzz         * 0.0.1.4  <span style="color: #555555;">2024-02-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (waldronlab/bugphyzz@1339325)</span></span></span>
<span><span class="co">#&gt;  bugphyzzAnalyses * 0.1.0    <span style="color: #555555;">2024-02-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  bugsigdbr        * 1.8.4    <span style="color: #555555;">2024-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  cachem             1.0.8    <span style="color: #555555;">2023-05-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  Cairo              1.6-2    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  circlize           0.4.16   <span style="color: #555555;">2024-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cli                3.6.2    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  clue               0.3-65   <span style="color: #555555;">2023-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  cluster            2.1.4    <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  codetools          0.2-19   <span style="color: #555555;">2023-02-01</span> <span style="color: #555555;">[2]</span> <span style="color: #555555;">CRAN (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  colorspace         2.1-0    <span style="color: #555555;">2023-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ComplexHeatmap   * 2.18.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  conditionz         0.1.0    <span style="color: #555555;">2019-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crayon             1.5.2    <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crosstalk          1.2.1    <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  crul               1.4.0    <span style="color: #555555;">2023-05-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  curl               5.2.0    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  data.table         1.15.0   <span style="color: #555555;">2024-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DBI                1.2.2    <span style="color: #555555;">2024-02-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dbplyr             2.4.0    <span style="color: #555555;">2023-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  desc               1.4.3    <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  digest             0.6.34   <span style="color: #555555;">2024-01-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  doParallel         1.0.17   <span style="color: #555555;">2022-02-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  dplyr            * 1.1.4    <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  DT                 0.32     <span style="color: #555555;">2024-02-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ellipsis           0.3.2    <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  epitools           0.5-10.1 <span style="color: #555555;">2020-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  evaluate           0.23     <span style="color: #555555;">2023-11-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fansi              1.0.6    <span style="color: #555555;">2023-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fastmap            1.1.1    <span style="color: #555555;">2023-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  filelock           1.0.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  foreach            1.5.2    <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  fs                 1.6.3    <span style="color: #555555;">2023-07-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  generics           0.1.3    <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GetoptLong         1.0.5    <span style="color: #555555;">2020-12-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ggplot2            3.5.0    <span style="color: #555555;">2024-02-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  GlobalOptions      0.1.2    <span style="color: #555555;">2020-06-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  glue               1.7.0    <span style="color: #555555;">2024-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gridExtra          2.3      <span style="color: #555555;">2017-09-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  gtable             0.3.4    <span style="color: #555555;">2023-08-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  highr              0.10     <span style="color: #555555;">2022-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  hoardr             0.5.4    <span style="color: #555555;">2024-01-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmltools          0.5.7    <span style="color: #555555;">2023-11-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  htmlwidgets        1.6.4    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httpcode           0.3.0    <span style="color: #555555;">2020-04-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  httr               1.4.7    <span style="color: #555555;">2023-08-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  IRanges            2.36.0   <span style="color: #555555;">2023-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators          1.0.14   <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jquerylib          0.1.4    <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  jsonlite           1.8.8    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  knitr              1.45     <span style="color: #555555;">2023-10-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  lifecycle          1.0.4    <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  magrittr           2.0.3    <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  matrixStats        1.2.0    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  memoise            2.0.1    <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  munsell            0.5.0    <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pillar             1.9.0    <span style="color: #555555;">2023-03-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgconfig          2.0.3    <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  pkgdown            2.0.7    <span style="color: #555555;">2022-12-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  png                0.1-8    <span style="color: #555555;">2022-11-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  purrr            * 1.0.2    <span style="color: #555555;">2023-08-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  R6                 2.5.1    <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  ragg               1.2.7    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rappdirs           0.3.3    <span style="color: #555555;">2021-01-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RColorBrewer       1.1-3    <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rjson              0.2.21   <span style="color: #555555;">2022-01-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rlang              1.1.3    <span style="color: #555555;">2024-01-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  rmarkdown          2.25     <span style="color: #555555;">2023-09-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  RSQLite            2.3.5    <span style="color: #555555;">2024-01-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  S4Vectors          0.40.2   <span style="color: #555555;">2023-11-23</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor 3.18 (R 4.3.2)</span></span></span>
<span><span class="co">#&gt;  sass               0.4.8    <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  scales             1.3.0    <span style="color: #555555;">2023-11-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  sessioninfo        1.2.2    <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  shape              1.4.6.1  <span style="color: #555555;">2024-02-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringi            1.8.3    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  stringr            1.5.1    <span style="color: #555555;">2023-11-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  systemfonts        1.0.5    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxa               0.4.3    <span style="color: #555555;">2024-02-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  taxize             1.0      <span style="color: #555555;">2024-02-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">Github (ropensci/taxize@bcff2a6)</span></span></span>
<span><span class="co">#&gt;  taxizedb           0.3.1    <span style="color: #555555;">2023-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  textshaping        0.3.7    <span style="color: #555555;">2023-10-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tibble             3.2.1    <span style="color: #555555;">2023-03-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyr            * 1.3.1    <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  tidyselect         1.2.0    <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  utf8               1.2.4    <span style="color: #555555;">2023-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  uuid               1.2-0    <span style="color: #555555;">2024-01-14</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  vctrs              0.6.5    <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridis            0.6.5    <span style="color: #555555;">2024-01-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  viridisLite        0.4.2    <span style="color: #555555;">2023-05-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  withr              3.0.0    <span style="color: #555555;">2024-01-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xfun               0.42     <span style="color: #555555;">2024-02-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  xml2               1.3.6    <span style="color: #555555;">2023-12-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt;  yaml               2.3.8    <span style="color: #555555;">2023-12-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM (R 4.3.0)</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /usr/local/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /usr/local/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Gamboa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
